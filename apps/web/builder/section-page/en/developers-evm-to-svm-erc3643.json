{
  "createdBy": "sYmy3Nz6iXT6gbZQB5Ti1iGBXml2",
  "createdDate": 1747052755073,
  "data": {
    "inputs": [],
    "seo": {
      "seoDescription": "Explore how to implement ERC3643 on Solana, and discover key differences from Ethereum.",
      "seoImage": "https://cdn.builder.io/api/v1/image/assets%2Fce0c7323a97a4d91bd0baa7490ec9139%2Fc5e5cc5ab3864937a21fcce2eca83194",
      "seoTitle": "What is ERC3643 on Solana?"
    },
    "slug": "developers/evm-to-svm/erc3643",
    "blocks": [
      {
        "@type": "@builder.io/sdk:Element",
        "@version": 2,
        "id": "builder-19403d3ab67c436bb4b0ff203428bea3",
        "meta": {
          "previousId": "builder-d7950c7aab79402c9fb0a043ff7909c0"
        },
        "component": {
          "name": "Section Molecule",
          "options": {
            "noPadding": "none"
          },
          "isRSC": null
        },
        "children": [
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-17fb7bce6db24cadacd0fb3e25507a00",
            "meta": {
              "previousId": "builder-6dfd01f5f7a24f1d86033fc0109a45b5",
              "localizedTextInputs": [
                "eyebrow",
                "headline",
                "body",
                "image.alt"
              ]
            },
            "component": {
              "name": "Hero",
              "options": {
                "headingAs": "h1",
                "centered": false,
                "newsLetter": false,
                "eyebrow": "",
                "image": {
                  "alt": ""
                },
                "headline": "What is ERC3643 on Solana?",
                "body": "<p><br></p>"
              },
              "isRSC": null
            },
            "responsiveStyles": {
              "large": {
                "display": "flex",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box"
              }
            }
          },
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-ed056d1736284b4cb6a8974b460908b0",
            "meta": {
              "localizedTextInputs": [
                "tocHeadline",
                "callToAction.eyebrow",
                "callToAction.headline",
                "callToAction.description",
                "callToAction.button.label"
              ],
              "previousId": "builder-6adbc3fd12274249a0fab0b282d301af"
            },
            "component": {
              "name": "Content Editor",
              "options": {
                "callToAction": {
                  "button": {
                    "label": "Explore"
                  },
                  "eyebrow": "Keep Learning",
                  "headline": "Learn about ERC20 on Solana",
                  "description": "See how token minting differs between Ethereum and Solana"
                },
                "tocHeadline": "Table of Content"
              },
              "isRSC": null
            },
            "children": [
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-d4e7e4b7b6ee4c4fba94735ba0e7592c",
                "meta": {
                  "localizedTextInputs": ["rawHtml"],
                  "previousId": "builder-c5f6117962af4217a00dcf1d5748859a"
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<p>ERC-3643 is an Ethereum token standard designed specifically for regulatory compliance (KYC, AML, etc.) and permissioned token issuance. Like ERC-20, it outlines the core functionality of fungible tokens but ensures that essential compliance requirements can be enforced on-chain.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px",
                    "marginTop": "auto",
                    "marginBottom": "auto"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-48601d7228dd4d63834545c75482e48c",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-43cccf2379c84221af9d72367bb8a659",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>Key Characteristics</strong></h3><ul><li><strong>Eligibility Verification</strong>: The token contract verifies whether both the holder and the recipient have completed KYC (or AML) checks before allowing a transfer.</li><li><strong>Regulatory Compliance</strong>: Implementing features such as whitelists/blacklists, investor-count or jurisdictional limits, and other rules at the smart contract level.</li><li><strong>Enforcement &amp; Control</strong>: If an unauthorized transfer is attempted, the contract blocks it, and issuers can forcibly transfer or burn tokens to fulfill real-world regulatory obligations.</li></ul>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-48f2d31531f84147a61bf7526d200fcc",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-7fca77a530454abe84f82722bef18ae4",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>Token Extensions</strong></h3><p>Solana’s Token Extensions (also referred to as Token-2022) are a set of enhancements to Solana’s native SPL Token program, introducing built-in support for advanced token features without requiring new standalone contracts. The motivation for Token Extensions was to provide a more flexible, extensible token standard that caters to complex and regulated use cases, all while avoiding the fragmentation seen in ecosystems with many bespoke token contracts.</p><p><strong>Key Features (You can check other features </strong><a href=\"https://solana.com/solutions/token-extensions\" rel=\"noopener noreferrer\" target=\"_blank\"><strong>here</strong></a><strong>)</strong></p><ul><li>Transfer Hooks: Allows custom on-chain logic (royalty enforcement, real-time compliance checks) to run whenever a token is transferred.</li><li>Confidential Transfers: Hides the transfer amount from the public, preserving user privacy while allowing authorized parties (e.g., auditors) to access the data if needed.</li><li>Transfer Fees: Automatically deducts a specified fee (or tax) during each transfer and routes it to a designated recipient address.</li><li>Permanent Delegates: Grants a special authority unlimited privileges to override or reclaim tokens, enabling administrative actions like forced transfers and burns.</li></ul>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-7b54fdfdfd28447586cd1df1b70b7dc0",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-220342e3a9934735aea6253d93b7def9",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>What Does a Token Extension Program for ERC3643 Look Like?</strong></h3><p>Below is a Solidity-style pseudocode that illustrates how key features of Solana’s Token Extensions, such as KYC enforcement, account freezing, transfer hooks, and permanent delegate functionality could be conceptually represented in an Ethereum-like contract.&nbsp;</p><p>Additionally, this code builds on SPL‑20(the standard Solana token program, SPL‑Token) and layers the Token Extension functionality on top of it using Solidity syntax. If you’d like to review the baseline Solana token program (SPL‑Token), please refer to this link.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px",
                    "paddingBottom": "0px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-673a8d927392491badd587f7b1bc50e1",
                "component": {
                  "name": "Code Block",
                  "options": {
                    "code": "pragma solidity ^0.8.28;\n\ninterface ISpl20 {\n    function transfer(address to, address mintAddress, uint256 amount) external;\n    function getTokenAccount(address owner, address token) external view returns (uint256 balance, bool isFrozen);\n    function mintTokens(address to, address mintAddress, uint256 amount) external;\n}\n\ncontract SPL3643 {\n    ISpl20 public immutable spl20;\n    address public immutable mintAddress;\n\n    mapping(address => bool) public isKYCApproved;\n    mapping(address => bool) public frozen;\n\n    address public complianceAuthority;\n    address public transferHookProgram;\n\n    event KYCApproved(address indexed user, bool status);\n    event AccountFrozen(address indexed user, bool status);\n    event TransferHookSet(address indexed hookProgram);\n    event ForcedTransfer(address indexed from, address indexed to, uint256 value);\n    event Transfer(address indexed from, address indexed to, uint256 value);\n\n    constructor(address _spl20, address _mint, address authority) {\n        spl20 = ISpl20(_spl20);\n        mintAddress = _mint;\n        complianceAuthority = authority;\n    }\n\n    modifier onlyComplianceAuth() {\n        require(msg.sender == complianceAuthority, \"not compliance auth\");\n        _;\n    }\n\n    function approveKYC(address user, bool approved) external onlyComplianceAuth {\n        isKYCApproved[user] = approved;\n        emit KYCApproved(user, approved);\n    }\n\n    function freezeAccount(address user, bool freeze) external onlyComplianceAuth {\n        frozen[user] = freeze;\n        emit AccountFrozen(user, freeze);\n    }\n\n    function setTransferHook(address hookProgram) external onlyComplianceAuth {\n        transferHookProgram = hookProgram;\n        emit TransferHookSet(hookProgram);\n    }\n\n    function setComplianceAuthority(address newAuthority) external onlyComplianceAuth {\n        complianceAuthority = newAuthority;\n    }\n\n    function transfer(address to, uint256 amount) external {\n        require(!frozen[msg.sender] && !frozen[to], \"account frozen\");\n        require(isKYCApproved[msg.sender] && isKYCApproved[to], \"KYC required\");\n        if (transferHookProgram != address(0)) {\n            bool ok = ITransferHook(transferHookProgram).onTransfer(msg.sender, to, amount);\n            require(ok, \"blocked by hook\");\n        }\n        spl20.transfer(to, mintAddress, amount);\n        emit Transfer(msg.sender, to, amount);\n    }\n\n    function forceTransfer(address from, address to, uint256 amount) external onlyComplianceAuth {\n        // temporarily unfreeze to bypass Spl20.transfer require(msg.sender == owner)\n        frozen[from] = false;\n        spl20.transfer(to, mintAddress, amount);\n        frozen[from] = true;\n        emit ForcedTransfer(from, to, amount);\n    }\n}\n\ninterface ITransferHook {\n    function onTransfer(address from, address to, uint256 amount) external returns (bool);\n}\n",
                    "language": "javascript"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-85b124afee4940a7aa31fc8a6142853d",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-313097e2b4d942eda1ff0412b61ed31f",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>KYC Whitelisting </strong></h3><p>The isKYCApproved mapping ensures that only KYC-verified users can send or receive tokens. Before a transfer proceeds, both the sender and recipient must be flagged as approved. This mimics Solana’s capability to restrict transfers to verified identities via identity-gated token accounts or transfer hooks configured at the mint level.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-d4b94fe6870e4cd89fdd115aa5085616",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-85b124afee4940a7aa31fc8a6142853d",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>Freeze Enforcement</strong></h3><p>The frozen mapping lets the compliance authority lock any account from sending or receiving tokens. In Solana, token accounts can be frozen either by a freeze authority, a native feature that provides immediate enforcement without contract logic.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-e0b16acce673460399580fbf6b6fab5f",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-85b124afee4940a7aa31fc8a6142853d",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3>Transfer Hook</h3><p>The transferHookProgram variable represents an external contract that implements custom logic. It is called during each token transfer, allowing dynamic enforcement like:&nbsp;</p><ul><li>Rejecting transfers over a certain size&nbsp;</li><li>Charging royalties&nbsp;</li><li>Checking external allowlists or oracles&nbsp;</li></ul><p>Solana’s Transfer Hook extension performs this function at the protocol level, giving developers powerful on-chain control over transfers without requiring custom contract deployment.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-5a63311857c744dcad1738621517c93f",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-85b124afee4940a7aa31fc8a6142853d",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>Permanent Delegate (Override Authority) </strong></h3><p>The complianceAuthority has the power to forcibly transfer tokens between any two addresses. This is comparable to Solana’s Permanent Delegate feature, which allows authorized entities to bypass user permissions in regulated contexts as required, for example, to comply with legal orders or reclaim tokens during fraud mitigation.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-1f51d0865af247a19a8eca5e762e06b5",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-2df674ab214a4b9591090a6e7b8121a4",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h2><strong>How to do ERC3643 on Solana</strong></h2>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-1c8a0184b3794ab88ae25ffb8a4d1ec4",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-25a9815c30584915b140520ef25276d8",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>1.&nbsp;Conceptual Map</strong></h3>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-20da52c8d7494826a28aa623cc52370d",
                "meta": {
                  "previousId": "builder-e8bd8757b5564479bee806f36b063032"
                },
                "component": {
                  "name": "Custom Code",
                  "options": {
                    "code": "<style>\n  table.custom-table {\n    width: 100%;\n    border-collapse: collapse;\n  }\n  table.custom-table thead th {\n    text-align: center;\n    font-weight: 600;\n    padding: 8px;\n  }\n  table.custom-table tbody td {\n    padding: 8px;\n    vertical-align: top;\n  }\n  table.custom-table th,\n  table.custom-table td {\n    border: 1px solid #999;\n  }\n</style>\n\n<table class=\"custom-table\">\n  <thead>\n    <tr>\n      <th>ERC-3643 Feature</th>\n      <th>Token-2022 Counterpart / Actor</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td><strong>KYC whitelist</strong></td>\n      <td>Custom transfer-hook program</td>\n    </tr>\n    <tr>\n      <td><strong>Account freeze</strong></td>\n      <td><code>freeze_authority</code></td>\n    </tr>\n    <tr>\n      <td><strong>Force / claw-back transfer</strong></td>\n      <td><code>permanent_delegate::transfer</code></td>\n    </tr>\n    <tr>\n      <td><strong>On-transfer custom logic</strong></td>\n      <td>Transfer-hook callback (<code>execute</code>)</td>\n    </tr>\n    <tr>\n      <td><strong>Compliance admin</strong></td>\n      <td>PDA signer or multisig that owns the mint</td>\n    </tr>\n  </tbody>\n</table>\n",
                    "scriptsClientOnly": true
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingRight": "50px",
                    "paddingLeft": "50px",
                    "paddingTop": "20px",
                    "marginBottom": "40px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-5e71beed0b6a45f1913d000ae2eccba2",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-5a63311857c744dcad1738621517c93f",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>2. End‑to‑End Call Flow (simplified)</strong></h3>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-b76024a70d374b07aba7d4084fe1c5bf",
                "component": {
                  "name": "Code Block",
                  "options": {
                    "code": "User → Token‑2022 (transfer) ↘\n                               Transfer Hook (KYC check) → OK / ERR\n                               ↘\n                        Token‑2022 (actual balance change)\n",
                    "language": "latex"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-5da698d42d354ed88b8dc4c3f93fee24",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-5e71beed0b6a45f1913d000ae2eccba2",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<p>A single Solana transaction contains both the token instruction and the hook call. If the hook returns an error, the whole transaction is rolled back - mirroring ERC‑3643’s on‑chain enforcement.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-5ae4134008a54eaaaac32db6ba796bd6",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-5a63311857c744dcad1738621517c93f",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>3. Minimal Transfer‑Hook Program</strong></h3><p>This program adds a KYC gate to any Token 2022 mint. During setup the one‑time init_meta instruction creates the extra_account_meta_list PDA whose fixed seeds bind it to the mint, stores the whitelist PDA inside that list, and immediately inserts the initializer (payer) into whitelist.allowed. That means the mint authority can move the first tokens without an extra whitelist update call. Later, whenever someone calls transfer_checked, the Token 2022 program CPI‑invokes the hook’s execute function, passing the five fixed accounts (source token, mint, destination token, owner, meta list) plus the forwarded whitelist PDA. The hook checks that the owners of both token accounts appear in whitelist.allowed; if either is missing it raises SrcNotAllowed or DstNotAllowed, rolling back the whole transaction, otherwise it returns Ok(()) and the transfer finalizes. All other administrative powers such as freezing, claw back, and supply changes remain with the mint’s native authorities, so roughly ninety lines of code deliver ERC 3643 style compliance without breaking standard SPL tooling or wallet UX.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-f33fc1acb7ee43c3bb2d18f10cb43f8b",
                "component": {
                  "name": "Code Block",
                  "options": {
                    "code": "// programs/kyc_hook/src/lib.rs\nuse anchor_lang::prelude::*;\nuse anchor_spl::token_interface::{Mint, TokenAccount, TokenInterface};\nuse spl_tlv_account_resolution::{seeds::Seed, state::*};\nuse spl_transfer_hook_interface::instruction::TransferHookInstruction;\n\ndeclare_id!(\"KycHook1111111111111111111111111111111111111\");\n\n#[program]\npub mod kyc_hook {\n    use super::*;\n\n    /// One‑time initializer: create extra_account_meta_list PDA,\n    /// register the whitelist PDA, and automatically whitelist the payer.\n    #[interface(spl_transfer_hook_interface::initialize_extra_account_meta_list)]\n    pub fn init_meta(ctx: Context<InitMeta>) -> Result<()> {\n        /* ── 1. Seed the whitelist with the payer / mint authority ── */\n        let wl = &mut ctx.accounts.whitelist;\n        let payer_key = ctx.accounts.payer.key();\n        if !wl.allowed.contains(&payer_key) {\n            wl.allowed.push(payer_key);\n        }\n\n        /* ── 2. Build ExtraAccountMeta so Token‑2022 forwards whitelist ── */\n        let metas = vec![ExtraAccountMeta::new_with_pubkey(\n            &ctx.accounts.whitelist.key(),\n            /* is_signer  */ false,\n            /* is_writable*/ true,\n        )?];\n\n        /* ── 3. Create extra_account_meta_list PDA ── */\n        let size     = ExtraAccountMetaList::size_of(metas.len())? as u64;\n        let lamports = Rent::get()?.minimum_balance(size as usize);\n        let seeds = &[\n            b\"extra-account-metas\",\n            ctx.accounts.mint.key().as_ref(),\n            &[ctx.bumps.extra_metas],\n        ];\n        anchor_lang::system_program::create_account(\n            CpiContext::new_with_signer(\n                ctx.accounts.system_program.to_account_info(),\n                anchor_lang::system_program::CreateAccount {\n                    from: ctx.accounts.payer.to_account_info(),\n                    to:   ctx.accounts.extra_metas.to_account_info(),\n                },\n                &[seeds],\n            ),\n            lamports,\n            size,\n            ctx.program_id,\n        )?;\n\n        /* ── 4. Initialise TLV data inside the PDA ── */\n        ExtraAccountMetaList::init::<TransferHookInstruction>(\n            &mut ctx.accounts.extra_metas.try_borrow_mut_data()?,\n            &metas,\n        )?;\n        Ok(())\n    }\n\n    /// Called automatically on every Token‑2022 transfer.\n    #[interface(spl_transfer_hook_interface::execute)]\n    pub fn execute(ctx: Context<Hook>, _amount: u64) -> Result<()> {\n        let wl  = &ctx.accounts.whitelist;\n        let src = ctx.accounts.source_token.owner;\n        let dst = ctx.accounts.dest_token.owner;\n\n        require!(wl.allowed.contains(&src), ComplianceError::SrcNotAllowed);\n        require!(wl.allowed.contains(&dst), ComplianceError::DstNotAllowed);\n        Ok(())\n    }\n}\n\n/* ---------------- Data & account structs ---------------- */\n\n#[account]                 // simple demo whitelist\npub struct Whitelist {\n    pub allowed: Vec<Pubkey>,\n}\n\n/* init_meta accounts */\n#[derive(Accounts)]\npub struct InitMeta<'info> {\n    #[account(mut)]\n    payer: Signer<'info>,\n\n    /// CHECK: PDA = [\"extra-account-metas\", mint]\n    #[account(mut, seeds = [b\"extra-account-metas\", mint.key().as_ref()], bump)]\n    extra_metas: AccountInfo<'info>,\n\n    /// CHECK: verified by interface macro\n    #[account(mut)]\n    mint: InterfaceAccount<'info, Mint>,\n\n    #[account(mut)]\n    whitelist: Account<'info, Whitelist>,\n\n    system_program: Program<'info, System>,\n}\n\n/* execute accounts (fixed order!) */\n#[derive(Accounts)]\npub struct Hook<'info> {\n    // 0 source token\n    #[account(token::mint = mint, token::authority = owner)]\n    source_token: InterfaceAccount<'info, TokenAccount>,\n    // 1 mint\n    mint: InterfaceAccount<'info, Mint>,\n    // 2 destination token\n    #[account(token::mint = mint)]\n    dest_token: InterfaceAccount<'info, TokenAccount>,\n    // 3 owner (source wallet)\n    /// CHECK:\n    owner: UncheckedAccount<'info>,\n    // 4 extra_account_meta_list\n    /// CHECK:\n    #[account(seeds = [b\"extra-account-metas\", mint.key().as_ref()], bump)]\n    extra_account_meta_list: UncheckedAccount<'info>,\n    // 5 whitelist (forwarded via meta list)\n    whitelist: Account<'info, Whitelist>,\n}\n\n#[error_code]\npub enum ComplianceError {\n    #[msg(\"source wallet not allowed\")]\n    SrcNotAllowed,\n    #[msg(\"destination wallet not allowed\")]\n    DstNotAllowed,\n}\n",
                    "language": "rust"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-f1e11b928a224037af3ed883efa8c60d",
                "properties": {
                  "id": "number"
                },
                "meta": {
                  "previousId": "builder-5ae4134008a54eaaaac32db6ba796bd6",
                  "localizedTextInputs": ["rawHtml"]
                },
                "component": {
                  "name": "Copy",
                  "options": {
                    "rawHtml": "<h3><strong>4. CLI Quickstart (Solana v1.18+, spl‑token‑cli v3.0.0+, Anchor v0.30+)</strong></h3><p>First you pick a wallet that will act as the compliance admin and save its pubkey in COMP_AUTH, then pre‑compute the whitelist PDA you’ll store in the hook and call that WL_PDA. With the keys ready you compile the kyc_hook using anchor build and deploy it, writing down the freshly printed program‑id as HOOK_ID. Next you create a brand‑new Token‑2022 mint that points to this hook by passing --transfer-hook $HOOK_ID, while also naming the admin wallet as freeze‑ and claw‑back authority; Solana prints the resulting MINT_ADDRESS. Because Token‑2022 needs to know which extra accounts to pass into the hook, you immediately run anchor run init‑meta, which calls the hook’s initializer and stores WL_PDA in the mint’s extra‑account‑meta list. This step is done only once. Now the mint is wired for KYC, so you can freely mint initial supply to yourself; the hook is not invoked on mint operations. Finally you transfer tokens to another wallet: at that moment Token‑2022 invokes the hook, which checks both sender and receiver against the on‑chain whitelist. If both are listed the transfer lands; if either is missing the hook throws an error and the whole transaction is rolled back, giving you ERC‑3643‑style compliance in a single Solana transaction.</p>"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box",
                    "paddingTop": "20px"
                  }
                }
              },
              {
                "@type": "@builder.io/sdk:Element",
                "@version": 2,
                "id": "builder-643d091e49e54defb3a4b0db75e3aeb1",
                "meta": {
                  "previousId": "builder-f33fc1acb7ee43c3bb2d18f10cb43f8b"
                },
                "component": {
                  "name": "Code Block",
                  "options": {
                    "code": "# 0. Keys & PDAs\nCOMP_AUTH=$(solana address)          # compliance admin key\nWL_PDA=<derived whitelist PDA>       # used in step 2\n\n# 1. Build & deploy the hook\nanchor build\nsolana program deploy target/deploy/kyc_hook.so   # save as HOOK_ID\n\n# 2. Create a KYC‑enabled mint (Token‑2022 CLI)\nspl-token --program-id TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb create-token \\\n  --transfer-hook $HOOK_ID \\\n  --enable-permanent-delegate \\\n  --freeze-authority $COMP_AUTH                  # returns MINT_ADDRESS\n\n# 3. Initialize extra_account_meta_list (one‑time)\nanchor run init-meta -- --mint $MINT_ADDRESS --whitelist $WL_PDA\n\n# 4. Mint & transfer\nspl-token mint     $MINT_ADDRESS 100 $(solana address)   # minting bypasses hook\nspl-token transfer $MINT_ADDRESS 10 <RECIPIENT>          # hook executes, KYC enforced\n",
                    "language": "bash"
                  },
                  "isRSC": null
                },
                "responsiveStyles": {
                  "large": {
                    "display": "flex",
                    "flexDirection": "column",
                    "position": "relative",
                    "flexShrink": "0",
                    "boxSizing": "border-box"
                  }
                }
              }
            ],
            "responsiveStyles": {
              "large": {
                "display": "flex",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box"
              }
            }
          },
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-d8f929fe17f948f7bf5ed7888d324ea8",
            "meta": {
              "previousId": "builder-fe9949287119459d95bba8acc90a45cc",
              "localizedTextInputs": [
                "eyebrow",
                "headline",
                "body",
                "buttons.0.label"
              ]
            },
            "component": {
              "name": "Heading",
              "options": {
                "eyebrow": "EVM TO SVM",
                "headline": "",
                "body": "",
                "variant": "centered",
                "buttons": [
                  {
                    "hierarchy": "outline",
                    "size": "md",
                    "iconSize": "md",
                    "startIcon": "none",
                    "endIcon": "none",
                    "url": "https://solana.com/developers/evm-to-svm",
                    "label": "Home"
                  }
                ]
              },
              "isRSC": null
            },
            "responsiveStyles": {
              "large": {
                "display": "flex",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box"
              }
            }
          },
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-dde22fa45f9745ce9cf7f445a0fdf5ca",
            "meta": {
              "previousId": "builder-b3dad184e699473a9e332f12ff27a8f8",
              "localizedTextInputs": ["eyebrow", "headline", "body"]
            },
            "component": {
              "name": "Heading",
              "options": {
                "variant": "standard",
                "headline": "Start building on Solana"
              },
              "isRSC": null
            },
            "responsiveStyles": {
              "large": {
                "display": "flex",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box"
              }
            }
          },
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-333794c1ee6d41c5a81706ef018ccf33",
            "meta": {
              "previousId": "builder-2e69bbccc2d24fd6b50336482e6f59c8"
            },
            "component": {
              "name": "Card Deck",
              "options": {
                "cards": [
                  {
                    "type": "image",
                    "heading": "Intro to Solana Development",
                    "backgroundImage": {
                      "src": "https://cdn.builder.io/api/v1/image/assets%2Fce0c7323a97a4d91bd0baa7490ec9139%2Fdfb1773873354d118d134beca2334288"
                    },
                    "callToAction": {
                      "url": "/developers/guides/getstarted/hello-world-in-your-browser",
                      "endIcon": "arrow-right",
                      "hierarchy": "outline"
                    },
                    "headingAs": "h3"
                  },
                  {
                    "type": "image",
                    "heading": "Solana Development Course",
                    "backgroundImage": {
                      "src": "https://cdn.builder.io/api/v1/image/assets%2Fce0c7323a97a4d91bd0baa7490ec9139%2Fdfb1773873354d118d134beca2334288"
                    },
                    "callToAction": {
                      "url": "https://www.soldev.app/course",
                      "endIcon": "arrow-right",
                      "hierarchy": "outline"
                    },
                    "headingAs": "h3"
                  },
                  {
                    "type": "image",
                    "heading": "Solana Bootcamp",
                    "backgroundImage": {
                      "src": "https://cdn.builder.io/api/v1/image/assets%2Fce0c7323a97a4d91bd0baa7490ec9139%2Fdfb1773873354d118d134beca2334288"
                    },
                    "callToAction": {
                      "url": "https://youtu.be/0P8JeL3TURU?feature=shared",
                      "endIcon": "arrow-right",
                      "hierarchy": "outline"
                    },
                    "headingAs": "h3"
                  },
                  {
                    "type": "image",
                    "heading": "More Solana Developer Tools",
                    "backgroundImage": {
                      "src": "https://cdn.builder.io/api/v1/image/assets%2Fce0c7323a97a4d91bd0baa7490ec9139%2Fdfb1773873354d118d134beca2334288"
                    },
                    "callToAction": {
                      "url": "/developers",
                      "endIcon": "arrow-right",
                      "hierarchy": "outline"
                    },
                    "headingAs": "h3"
                  }
                ],
                "featured": true,
                "numCols": 3
              },
              "isRSC": null
            },
            "responsiveStyles": {
              "large": {
                "display": "flex",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box",
                "paddingTop": "0px",
                "marginTop": "-3px"
              }
            }
          },
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-4520eee621964fcda36af09e673b8424",
            "meta": {
              "previousId": "builder-6f37b71c8b0849b1a116b608af624fcf",
              "localizedTextInputs": ["rawHtml"]
            },
            "component": {
              "name": "Copy",
              "options": {
                "rawHtml": "<p><strong>Node storing all data and participating in consensus</strong></p><ul><li><strong>Ethereum:</strong> Archive Node</li><li><strong>Solana:</strong> [n/a]</li></ul><p><strong>Node storing some data and participating in consensus</strong></p><ul><li><strong>Ethereum:</strong> Full Node</li><li><strong>Solana:</strong> Consensus Node</li></ul><p><strong>Node storing some data and not participating in consensus</strong></p><ul><li><strong>Ethereum:</strong> Light Node</li><li><strong>Solana:</strong> RPC Node</li></ul>"
              },
              "isRSC": null
            },
            "responsiveStyles": {
              "large": {
                "display": "none",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box"
              },
              "medium": {
                "display": "none"
              },
              "small": {
                "display": "flex"
              }
            }
          }
        ],
        "responsiveStyles": {
          "large": {
            "display": "flex",
            "flexDirection": "column",
            "position": "relative",
            "flexShrink": "0",
            "boxSizing": "border-box"
          }
        }
      },
      {
        "@type": "@builder.io/sdk:Element",
        "@version": 2,
        "id": "builder-dd2b9a232544430b99e9ceb5fd902ff9",
        "meta": {
          "previousId": "builder-79f23070ef8b440ebd54e4249ff6d7a9"
        },
        "component": {
          "name": "Section Molecule",
          "options": {
            "noPadding": "none"
          },
          "isRSC": null
        },
        "children": [
          {
            "@type": "@builder.io/sdk:Element",
            "@version": 2,
            "id": "builder-be2384ca595747138733a369f19ff056",
            "meta": {
              "previousId": "builder-e4998f147c9146a9921fe0a236283a91",
              "localizedTextInputs": ["rawHtml"]
            },
            "component": {
              "name": "Copy",
              "options": {
                "rawHtml": "<p><strong>Node storing all data and participating in consensus</strong></p><ul><li><strong>Ethereum:</strong> Archive Node</li><li><strong>Solana:</strong> [n/a]</li></ul><p><strong>Node storing some data and participating in consensus</strong></p><ul><li><strong>Ethereum:</strong> Full Node</li><li><strong>Solana:</strong> Consensus Node</li></ul><p><strong>Node storing some data and not participating in consensus</strong></p><ul><li><strong>Ethereum:</strong> Light Node</li><li><strong>Solana:</strong> RPC Node</li></ul>"
              },
              "isRSC": null
            },
            "responsiveStyles": {
              "large": {
                "display": "none",
                "flexDirection": "column",
                "position": "relative",
                "flexShrink": "0",
                "boxSizing": "border-box"
              },
              "medium": {
                "display": "none"
              },
              "small": {
                "display": "flex"
              }
            }
          }
        ],
        "responsiveStyles": {
          "large": {
            "display": "flex",
            "flexDirection": "column",
            "position": "relative",
            "flexShrink": "0",
            "boxSizing": "border-box"
          }
        }
      },
      {
        "id": "builder-pixel-zdb651b2dmk",
        "@type": "@builder.io/sdk:Element",
        "tagName": "img",
        "properties": {
          "src": "https://cdn.builder.io/api/v1/pixel?apiKey=983ae1dad0ba4ca4ac6dd4ac310edee1",
          "aria-hidden": "true",
          "alt": "",
          "role": "presentation",
          "width": "0",
          "height": "0"
        },
        "responsiveStyles": {
          "large": {
            "height": "0",
            "width": "0",
            "display": "block",
            "opacity": "0",
            "overflow": "hidden",
            "pointerEvents": "none"
          }
        }
      }
    ],
    "state": {
      "deviceSize": "large",
      "location": {
        "pathname": "/developers/evm-to-svm/erc3643",
        "path": ["developers", "evm-to-svm", "erc3643"],
        "query": {}
      }
    }
  },
  "firstPublished": 1748522536943,
  "folders": [],
  "id": "983ae1dad0ba4ca4ac6dd4ac310edee1_564ef1ac5d1a45daa49fa0e770a4cc64",
  "lastUpdated": 1761766919916,
  "lastUpdatedBy": "TccMYcQtnFaazdlcnoYGtEcNnmg1",
  "meta": {
    "hasLinks": false,
    "kind": "component",
    "lastPreviewUrl": "https://solana.com/developers/evm-to-svm/erc3643?builder.space=ce0c7323a97a4d91bd0baa7490ec9139&builder.user.permissions=read%2Ccreate%2Cpublish%2CeditCode%2CeditDesigns%2Cadmin%2CeditLayouts%2CeditLayers%2CeditContentPriority%2CeditFolders%2CcreateProjects&builder.user.role.name=Admin&builder.user.role.id=admin&builder.cachebust=true&builder.preview=section-page&builder.noCache=true&builder.allowTextEdit=true&__builder_editing__=true&builder.overrides.section-page=564ef1ac5d1a45daa49fa0e770a4cc64&builder.overrides.564ef1ac5d1a45daa49fa0e770a4cc64=564ef1ac5d1a45daa49fa0e770a4cc64&builder.options.includeRefs=true&builder.options.enrich=true&builder.options.locale=Default",
    "originalContentId": "f43655d05ad649bd9ee6e6242fa52465",
    "winningTest": null
  },
  "modelId": "983ae1dad0ba4ca4ac6dd4ac310edee1_c93163a557894c46af48f3ff83f2c5ca",
  "name": "developers/evm-to-svm/erc3643",
  "previewUrl": "https://solana.com/developers/evm-to-svm/erc3643",
  "published": "published",
  "query": [],
  "screenshot": "https://cdn.builder.io/api/v1/image/assets%2Fce0c7323a97a4d91bd0baa7490ec9139%2F432aa2b58dd245f5aba2a03bbaec765f",
  "testRatio": 1,
  "variations": {},
  "@originId": "564ef1ac5d1a45daa49fa0e770a4cc64",
  "@originOrgId": "ce0c7323a97a4d91bd0baa7490ec9139",
  "@originModelId": "c93163a557894c46af48f3ff83f2c5ca",
  "@liveSyncEnabled": true,
  "rev": "3tp6grmm0g6"
}
