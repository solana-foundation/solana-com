---
date: 2025-12-10T00:00:00Z
difficulty: beginner
title:
  "How to Authenticate Users with Privy (Social + Solana Wallets) in Next.js"
seoTitle:
  "Authenticate Solana dApps with Privy.io: Social Logins, Embedded & External
  Wallets"
description:
  "Step-by-step guide to build a Next.js app with Privy authentication. Use
  social logins, embedded Solana wallets, and external wallets, with protected
  routes and working balance/send examples."
tags:
  - auth
  - privy
  - privy.io
  - wallet
  - solana
  - nextjs
keywords:
  - authentication
  - privy
  - solana wallet
  - next.js
  - protected routes
---

# How to Authenticate Users with Privy.io (Social + Solana Wallets)

## 1. Introduction

This guide shows you how to build a Solana app with
**[Privy](https://www.privy.io) authentication**.

Users can log in with:

- Email
- Social providers (Google, Twitter, Discord)
- External Solana wallets ([Phantom](https://phantom.app),
  [Solflare](https://solflare.com))
- Or they get an **embedded Solana wallet automatically**, created by
  [Privy](https://www.privy.io)

Everything here is based directly on the
[Privy Auth template](https://github.com/solana-foundation/templates/tree/main/community/privy-auth)
(`community/privy-auth`). If you see a file path or snippet here, it exists in
the template.

[Privy](https://www.privy.io) handles:

- Authentication
- Sessions
- Embedded wallet creation
- External wallet connectors
- Token/session lifecycle

You focus on shipping your dApp features.

## 2. What You'll Build

A complete Next.js application that includes:

- Privy login modal
- Automatic embedded Solana wallets
- External wallet login (if enabled in Privy Dashboard)
- Profile page showing wallet type + address
- Ability to link/unlink additional wallets
- A protected route (`/protected`) that shows:
  - User object
  - Session
  - Decoded JWT

You also get two real Solana examples:

- Reading a wallet balance
- Sending a tiny self-transfer transaction

All examples are from the real template.

## 3. Why This Matters

Wallet-only onboarding turns users away. [Privy](https://www.privy.io) solves
this:

- Social login **+ auto-wallet** means users can start immediately.
- Developers avoid building:
  - OAuth
  - Session storage
  - Signature verification
  - Multi-wallet linking
  - Key management

But: If you skip [Privy Dashboard](https://dashboard.privy.io) setup (App ID,
Allowed Origins, External wallets toggle), you will get:

- 403 origin errors
- Phantom/Solflare failing to connect
- Or the app refusing to start

This guide prevents all of those problems.

## 4. Prerequisites

Before you begin, ensure you have:

- **Node.js 18+**
- A **[Privy](https://www.privy.io) account** + App ID (required)
- Optional:
  **[Phantom](https://phantom.app)/[Solflare](https://solflare.com)/[Backpack](https://www.backpack.app/)**
  browser wallet
- Git and pnpm/npm/yarn

## 5. Setting Up the Project

Follow _every_ step. Missing env or dashboard config will break login.

<Steps>
<Step>

### 1. Clone the template

```bash
git clone https://github.com/solana-foundation/templates.git
cd templates/community/privy-auth
```

The template repository is available at:
[solana-foundation/templates](https://github.com/solana-foundation/templates)

</Step>

<Step>

### 2. Install dependencies

```bash
pnpm install     # or npm install / yarn install
```

If you see missing-module errors, ensure clsx, tailwind-merge, and minidenticons
are in package.json.

</Step>

<Step>

### 3. Create a Privy App

1. Go to the [Privy Dashboard](https://dashboard.privy.io)
2. Click "New App" and then "Create App"
   ![Click On New App](https://res.cloudinary.com/resourcefulmind-inc/image/upload/v1765390970/Screenshot_2025-12-10_at_7.04.59_PM_rbeuv9.png)
3. Go to "Configuration" and "App Settings". Copy the App ID, you will need this
   for your .env.local
   ![Copy The App ID](https://res.cloudinary.com/resourcefulmind-inc/image/upload/v1765391378/Screenshot_2025-12-10_at_7.27.09_PM_unls0d.png)
   For more details, see the [Privy documentation](https://docs.privy.io).

</Step>

<Step>

### 4. Enable External Wallets + Allowed Origins

In [Privy Dashboard](https://dashboard.privy.io) → User Management →
Authentication → External wallets:

- Toggle External wallets "ON"
- Check Solana wallets
  ![Check Solana Wallets](https://res.cloudinary.com/resourcefulmind-inc/image/upload/v1765392200/Screenshot_2025-12-10_at_7.42.49_PM_cw05vi.png)

- Add Allowed Origins: Add the following URLs:

```text
http://localhost:3000
http://127.0.0.1:3000
```

If you don't do this, [Phantom](https://phantom.app) or
[Solflare](https://solflare.com) will throw 403 origin mismatch errors.

</Step>

<Step>

### 5. Configure environment variables

```bash
cp .env.example .env.local
```

Edit .env.local:

```bash
# Required
NEXT_PUBLIC_PRIVY_APP_ID=your_privy_app_id_here

# Optional: Custom RPC
# NEXT_PUBLIC_SOLANA_MAINNET_RPC_URL=https://your-rpc-provider-url
```

If NEXT_PUBLIC_PRIVY_APP_ID is missing, the app will fail at startup.

Restart the dev server after updating env vars.

</Step>

<Step>

### 6. Run the dev server

```bash
pnpm dev
```

Visit:

```text
http://localhost:3000
```

You should see the Privy login screen.

</Step>
</Steps>

## 6. Connecting Your Wallet (Privy Modal)

Files involved:

- `app/components/providers.tsx`
- `app/components/user-profile.tsx`

What happens:

- If you choose wallet login, [Privy](https://www.privy.io) shows connectors
  ([Phantom](https://phantom.app)/[Solflare](https://solflare.com))
- External wallets only work if:
  - Solana wallets are enabled in the
    [Privy Dashboard](https://dashboard.privy.io)
  - Allowed Origins are correctly set
- If the user has no wallet, Privy automatically creates an embedded Solana
  wallet via:

```typescript
embeddedWallets: {
  createOnLogin: "users-without-wallets",
}
```

If something fails, the Privy modal will show an error, or the console will show
a 403. See the [Privy documentation](https://docs.privy.io) for more
troubleshooting help.

## 7. Signing In with Privy

Flow:

1. Visit /
2. Click Login
3. [Privy](https://www.privy.io) modal appears
4. User chooses:
   - Email
   - Social provider
   - External wallet
5. If user has no wallet, Privy creates an embedded wallet
6. Page transitions to the authenticated view (UserProfile)
7. "Protected" link appears in the header
8. /protected displays:
   - User object
   - Session
   - Decoded JWT

Relevant files:

- `app/components/login-screen.tsx`
- `app/components/providers.tsx`
- `app/protected/page.tsx`

## 8. Exploring Protected Routes

File: `app/protected/page.tsx`

When authenticated, the page renders:

- The [Privy](https://www.privy.io) user object (JSON)
- The decoded JWT
- Session claims (issuer, audience, timestamps)

If not authenticated, Privy redirects back to /. See the
[Privy documentation](https://docs.privy.io) for more on protected routes.

This is your verification page during development.

## 9. Example Solana Actions (Balance + Send)

### Balance example

File: `app/components/examples/account-balance.tsx`

Shows:

- Reading SOL balance
- Refreshing balance

### Send example

File: `app/components/examples/send-transaction-example.tsx`

Shows:

- How to send a small self-transfer
- How to display the signature
- How to catch and display errors

### Helpers

File: `app/lib/solana.ts`

Contains:

- `getBalance`
- `sendLamports`

These are meant as starting points. Add proper validation for production.

## 10. Solana Configuration

Files:

- `app/components/providers.tsx`
- `app/lib/solana.ts`

Defaults:

- Public mainnet RPC

Override:

Use a custom RPC via:

```bash
NEXT_PUBLIC_SOLANA_MAINNET_RPC_URL=https://your-provider
```

Networks (mainnet + devnet):

Defined in providers.tsx. To add network switching, expose RPC choices in state
and pass them to your Solana helpers.

## 11. Troubleshooting

| Issue                             | Cause                                                      | Fix                                                                                                          |
| --------------------------------- | ---------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------ |
| Missing App ID                    | `NEXT_PUBLIC_PRIVY_APP_ID` is empty                        | Set it in `.env.local` and restart dev server                                                                |
| Phantom/Solflare 403 origin error | Allowed Origins not set                                    | Add `http://localhost:3000` and `http://127.0.0.1:3000` in the [Privy Dashboard](https://dashboard.privy.io) |
| External wallet login not working | "External wallets → Solana" not enabled                    | Toggle it on in the [Privy Dashboard](https://dashboard.privy.io)                                            |
| Social login not working          | OAuth redirect misconfig                                   | Re-check provider redirect URLs in the [Privy Dashboard](https://dashboard.privy.io)                         |
| RPC rate limits                   | Public RPC endpoint rate limiting                          | Provide a custom RPC via `NEXT_PUBLIC_SOLANA_MAINNET_RPC_URL` env var                                        |
| React 19 peer warning             | [Privy SDK](https://docs.privy.io) peer dependency warning | Safe to ignore                                                                                               |

## 12. What It Looks Like When It Works

You should see:

- Login modal works (email/social/wallet)
- Home page shows:
  - Wallet address
  - Embedded/External badge
  - Logout button
- "Protected" link appears
- /protected shows:
  - User object
  - Session
  - Decoded token
- Balance/send example components are active
  ![What Success Looks Like](https://res.cloudinary.com/resourcefulmind-inc/image/upload/v1765296807/Screenshot_2025-12-05_at_11.25.03_PM_opjbrs.png)

## 13. Conclusion

You now have:

- Social + email logins
- Embedded wallets
- External wallets
- Sessions
- Protected routes
- Working Solana examples

Next steps:

- Add your own transaction flows
- Fetch on-chain state
- Integrate program interactions
- Build production-grade error handling

## 14. Acknowledgments

- [Privy](https://www.privy.io) for authentication + wallet infrastructure
- [Solana Foundation Templates](https://github.com/solana-foundation/templates)
- Contributors across the Solana + Privy ecosystem
