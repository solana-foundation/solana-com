---
title: Programas
description:
  Aprende sobre los programas de Solana (contratos inteligentes) y cómo
  desarrollarlos usando Rust o el framework Anchor. Comprende el despliegue, las
  actualizaciones y la verificación de programas en la red Solana.
h1: Programas
---

En Solana, un contrato inteligente se llama programa. Un programa es una
[cuenta](/docs/core/accounts#program-account) sin estado que contiene código
ejecutable. Este código está organizado en funciones llamadas instrucciones. Los
usuarios interactúan con un programa enviando una
[transacción](/docs/core/transaction) que contiene una o más
[instrucciones](/docs/core/instructions). Una transacción puede incluir
instrucciones de múltiples programas.

Cuando se despliega un programa, Solana utiliza [LLVM](https://llvm.org/) para
compilarlo en formato ejecutable y enlazable
([ELF](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format)). El
archivo ELF contiene el binario del programa en Formato de Bytecode de Solana
(sBPF) y se guarda en la cadena en una cuenta ejecutable.

<Callout>
  sBPF es la versión personalizada de Solana del bytecode
  [eBPF](https://en.wikipedia.org/wiki/EBPF).
</Callout>

## Escribir programas

La mayoría de los programas están escritos en
[Rust](https://rust-book.cs.brown.edu/title-page.html), con dos enfoques comunes
de desarrollo:

- [Anchor](https://www.anchor-lang.com/docs): Anchor es un framework diseñado
  para el desarrollo rápido y fácil en Solana. Utiliza
  [macros de Rust](https://doc.rust-lang.org/book/ch20-05-macros.html) para
  reducir el código repetitivo, lo que lo hace ideal para principiantes.
- [Rust nativo](/docs/programs/rust): Escribir programas en Rust sin utilizar
  ningún framework. Este enfoque ofrece más flexibilidad pero conlleva mayor
  complejidad.

## Actualizar programas

Para
[modificar](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/bpf_loader/src/lib.rs#L704)
un programa existente, una cuenta debe ser designada como la
[autoridad de actualización](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/bpf_loader/src/lib.rs#L894).
(Típicamente la misma cuenta que originalmente
[desplegó el programa](/docs/programs/deploying).) Si la autoridad de
actualización es revocada y establecida como null, el programa ya no podrá ser
actualizado.

## Verificar programas

Solana admite [compilaciones verificables](/docs/programs/verified-builds), que
permiten a los usuarios comprobar si el código en cadena de un programa coincide
con su código fuente público. El framework Anchor proporciona
[soporte integrado](https://www.anchor-lang.com/docs/verifiable-builds) para
crear una compilación verificable.

Para comprobar si un programa existente está verificado, busca su ID de programa
en el
[Explorador de Solana](https://explorer.solana.com/address/PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY).
Alternativamente, puedes usar la
[CLI de Compilación Verificable de Solana](https://github.com/Ellipsis-Labs/solana-verifiable-build)
de Ellipsis Labs, para verificar de forma independiente los programas en cadena.

## Programas integrados

### Programas cargadores

Cada programa es propiedad de otro—su cargador. Los cargadores se utilizan para
desplegar, redesplegar, actualizar o cerrar programas. También se utilizan para
finalizar un programa y transferir la autoridad del programa.

Actualmente existen cinco programas cargadores, como se muestra en la tabla a
continuación.

| Cargador | ID del programa                               | Notas                                                                                                               | Enlace a instrucciones                                                                                                                           |
| -------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| native   | `NativeLoader1111111111111111111111111111111` | Es propietario de los otros cuatro cargadores                                                                       | —                                                                                                                                                |
| v1       | `BPFLoader1111111111111111111111111111111111` | Las instrucciones de gestión están deshabilitadas, pero los programas siguen ejecutándose                           | —                                                                                                                                                |
| v2       | `BPFLoader2111111111111111111111111111111111` | Las instrucciones de gestión están deshabilitadas, pero los programas siguen ejecutándose                           | [Instrucciones](https://docs.rs/solana-loader-v2-interface/latest/solana_loader_v2_interface/enum.LoaderInstruction.html)                        |
| v3       | `BPFLoaderUpgradeab1e11111111111111111111111` | Los programas pueden actualizarse después del despliegue. El ejecutable se almacena en una cuenta de datos separada | [Instrucciones](https://docs.rs/solana-loader-v3-interface/latest/solana_loader_v3_interface/instruction/enum.UpgradeableLoaderInstruction.html) |
| v4       | `LoaderV411111111111111111111111111111111111` | En desarrollo (no publicado)                                                                                        | [Instrucciones](https://docs.rs/solana-loader-v4-interface/latest/solana_loader_v4_interface/instruction/enum.LoaderV4Instruction.html)          |

Los programas desplegados con loader-v3 o loader-v4 pueden ser modificables
después del despliegue, según lo determine su autoridad de actualización.

### Programas precompilados

Además de los programas cargadores, Solana proporciona los siguientes programas
precompilados.

#### Verificar firma ed25519

El programa ed25519 se utiliza para verificar una o más firmas ed25519.

| Programa         | ID del programa                               | Descripción                                                           | Instrucciones                                                                                    |
| ---------------- | --------------------------------------------- | --------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| Programa Ed25519 | `Ed25519SigVerify111111111111111111111111111` | Verifica firmas ed25519. Si alguna firma falla, se devuelve un error. | [Instrucciones](https://docs.rs/solana-ed25519-program/latest/solana_ed25519_program/index.html) |

El programa ed25519 procesa una instrucción. El primer `u8` de la instrucción
contiene un contador del número de firmas a verificar, seguido de un byte de
relleno. Después, se serializa la siguiente estructura, una por cada firma a
verificar.

```rust
pub struct Ed25519SignatureOffsets {
    signature_offset: u16,             // offset to ed25519 signature of 64 bytes
    signature_instruction_index: u16,  // instruction index to find signature
    public_key_offset: u16,            // offset to public key of 32 bytes
    public_key_instruction_index: u16, // instruction index to find public key
    message_data_offset: u16,          // offset to start of message data
    message_data_size: u16,            // size of message data
    message_instruction_index: u16,    // index of instruction for message
}
```

Esto permite al usuario especificar cualquier dato de instrucción en la
transacción para los datos de firma y mensaje. Al especificar una sysvar de
instrucciones especial, también se pueden recibir datos de la transacción misma.

#### Verificar recuperación secp256k1

El programa secp256k1 se utiliza para verificar operaciones de recuperación de
clave pública secp256k1.

| Programa           | ID del programa                               | Descripción                                                                  | Instrucciones                                                                                        |
| ------------------ | --------------------------------------------- | ---------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------- |
| Programa Secp256k1 | `KeccakSecp256k11111111111111111111111111111` | Verifica operaciones de recuperación de clave pública secp256k1 (ecrecover). | [Instrucciones](https://docs.rs/solana-secp256k1-program/latest/solana_secp256k1_program/index.html) |

El programa secp256k1 procesa una instrucción. El primer byte de la instrucción
contiene un recuento del número de claves públicas a verificar. Después de eso,
se crea la siguiente estructura una vez para cada clave pública, luego se
serializa y se agrega a los datos de instrucción.

```rust
pub struct Secp256k1SignatureOffsets {
    signature_offset: u16,             // offset to secp256k1 signature data of 64 bytes
    signature_instruction_index: u16,  // instruction index to find signature
    eth_address_offset: u16,          // offset to eth_address of 20 bytes
    eth_address_instruction_index: u16, // instruction index to find eth_address
    message_data_offset: u16,          // offset to start of message data
    message_data_size: u16,            // size of message data
    message_instruction_index: u16,    // instruction index to find message data
}
```

El pseudocódigo de la verificación de recuperación:

Esto permite al usuario especificar cualquier dato de instrucción en la
transacción para los datos de firma y mensaje. Al especificar una sysvar de
instrucciones especial, también se pueden recibir datos de la transacción misma.

El costo de la transacción contará el número de firmas a verificar multiplicado
por el multiplicador de costo de verificación de firma.

El programa secp256r1 se utiliza para verificar hasta 8 firmas secp256r1.

| Programa           | ID del programa                               | Descripción                                                                                                 | Instrucciones                                                                                      |
| ------------------ | --------------------------------------------- | ----------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------- |
| Programa Secp256r1 | `Secp256r1SigVerify1111111111111111111111111` | Verifica hasta 8 firmas secp256r1. Toma una firma, clave pública y mensaje. Devuelve error si alguna falla. | [Instrucciones](https://docs.rs/solana-secp256r1-program/latest/solana_secp256r1_program/all.html) |

El programa secp256r1 procesa una instrucción. El primer instruction data del
programa contiene un recuento del número de firmas a verificar, seguido de un
byte de relleno. Después de eso, se crea la siguiente estructura para cada
firma, luego se serializa y se agrega a los datos de instrucción.

```rust
fn verify_signature(
    signature: &Signature,
    pubkey: &Pubkey,
    message: &[u8],
) -> Result<(), SignatureError> {
    let signature = signature.as_ref();
    if signature[63] & 0x80 != 0 {
        return Err(SignatureError::InvalidS);
    }

    let verify_result = ed25519_dalek::Verifier::verify(
        &pubkey.get_pubkey()?,
        message,
        &signature.try_into()?,
    );

    if verify_result.is_ok() {
        Ok(())
    } else {
        Err(SignatureError::InvalidSignature)
    }
}
```

<Callout>
  Se exigen valores S bajos para todas las firmas para evitar la maleabilidad
  accidental de la firma.
</Callout>

```rust
fn verify_signatures(
    batch: &[(&Signature, &Pubkey, &[u8])],
) -> Result<(), SignatureError> {
    let mut messages: Vec<&[u8]> = Vec::with_capacity(batch.len());
    let mut signatures: Vec<ed25519_dalek::Signature> = Vec::with_capacity(batch.len());
    let mut public_keys: Vec<ed25519_dalek::PublicKey> = Vec::with_capacity(batch.len());

    for (signature, pubkey, message) in batch.iter() {
        let signature = signature.as_ref();
        if signature[63] & 0x80 != 0 {
            return Err(SignatureError::InvalidS);
        }
        messages.push(message);
        signatures.push(signature.try_into()?);
        public_keys.push(pubkey.get_pubkey()?);
    }

    let verify_result = ed25519_dalek::verify_batch(&messages, &signatures, &public_keys);

    if verify_result.is_ok() {
        Ok(())
    } else {
        Err(SignatureError::InvalidSignature)
    }
}
```

### Programas principales

Los programas en la lista a continuación proporcionan la funcionalidad principal
de la red.

| Programa                 | ID del programa                               | Descripción                                                                                                                                                                                                                                                                                                                                                                 | Instrucciones                                                                                                                                         |
| ------------------------ | --------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **System**               | `11111111111111111111111111111111`            | Crear nuevas cuentas, asignar datos de cuenta, asignar cuentas a programas propietarios, transferir lamports desde cuentas propiedad del Programa System y pagar tarifas de transacción                                                                                                                                                                                     | [SystemInstruction](https://docs.rs/solana-program/latest/solana_program/system_instruction/enum.SystemInstruction.html)                              |
| **Vote**                 | `Vote111111111111111111111111111111111111111` | Crear y gestionar cuentas que rastrean el estado de votación del validator y las recompensas                                                                                                                                                                                                                                                                                | [VoteInstruction](https://docs.rs/solana-vote-program/latest/solana_vote_program/vote_instruction/enum.VoteInstruction.html)                          |
| **Stake**                | `Stake11111111111111111111111111111111111111` | Crear y gestionar cuentas que representan stake y recompensas para delegaciones a validators                                                                                                                                                                                                                                                                                | [StakeInstruction](https://docs.rs/solana-sdk/latest/solana_sdk/stake/instruction/enum.StakeInstruction.html)                                         |
| **Config**               | `Config1111111111111111111111111111111111111` | Añadir datos de configuración a la cadena, seguidos por la lista de claves públicas que pueden modificarla. A diferencia de otros programas, el programa Config no define instrucciones individuales. Tiene solo una instrucción implícita: "store". Sus datos de instrucción son un conjunto de claves que controlan el acceso a la cuenta y los datos almacenados en ella | [ConfigInstruction](https://docs.rs/solana-config-program/latest/solana_config_program/config_instruction/index.html)                                 |
| **Compute Budget**       | `ComputeBudget111111111111111111111111111111` | Establecer límites y precios de unidades de cómputo para transacciones, permitiendo a los usuarios controlar recursos de cómputo y tarifas de priorización                                                                                                                                                                                                                  | [ComputeBudgetInstruction](https://docs.rs/solana-compute-budget-interface/latest/solana_compute_budget_interface/enum.ComputeBudgetInstruction.html) |
| **Address Lookup Table** | `AddressLookupTab1e1111111111111111111111111` | Gestionar tablas de búsqueda de direcciones, que permiten a las transacciones hacer referencia a más cuentas de las que cabrían en la lista de cuentas de la transacción                                                                                                                                                                                                    | [ProgramInstruction](https://docs.rs/solana-sdk/latest/solana_sdk/address_lookup_table/instruction/enum.ProgramInstruction.html)                      |
| **ZK ElGamal Proof**     | `ZkTokenProof1111111111111111111111111111111` | Proporciona verificación de prueba de conocimiento cero para datos cifrados con ElGamal                                                                                                                                                                                                                                                                                     | —                                                                                                                                                     |
