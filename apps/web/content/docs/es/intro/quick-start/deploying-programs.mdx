---
title: Desplegar un programa
description:
  Aprende a construir, implementar y probar tu primer programa de Solana
  utilizando el framework Anchor y Solana Playground. Esta guía para
  principiantes te explica cómo crear un programa simple, implementarlo en
  devnet, ejecutar pruebas y cerrar el programa.
h1: Despliega tu primer programa de Solana
---

Construye, despliega y prueba tu primer [programa](/docs/core/programs) en la
blockchain de Solana usando el framework Anchor. Esta guía te ayudará a
familiarizarte más con Solana Playground y te preparará para usar Program
Derived Addresses (PDA) y Cross Program Invocation (CPI).

<Steps>
<Step>

### Crear proyecto Anchor

1. Abre [Solana Playground](https://beta.solpg.io) en tu navegador web
2. En el panel izquierdo, haz clic en **+ Crear un nuevo proyecto**
3. Ingresa un **Nombre de proyecto**
4. Selecciona **Anchor (Rust)** como framework
5. Haz clic en **Crear**

![Nuevo proyecto](/assets/docs/intro/quickstart/pg-new-project.gif)

El archivo fuente `src/lib.rs` se abrirá. Contiene una estructura llamada
`Initialize`, que hace lo siguiente:

- Recibe un parámetro requerido llamado _rs`data: u64`_
- Crea una nueva cuenta
- Guarda el valor de _rs`data: u64`_ en la nueva cuenta
- Añade un mensaje a los registros del programa de la transacción

<WithNotes>

```rust title="lib.rs"
use anchor_lang::prelude::*;

// This is your program's public key and it will update
// automatically when you build the project.
// !tooltip[/declare_id/] declare_id
declare_id!("11111111111111111111111111111111");

// !tooltip[/program/] program
#[program]
mod hello_anchor {
    use super::*;
    // !tooltip[/data: u64/] parameter
    pub fn initialize(ctx: Context<Initialize>, data: u64) -> Result<()> {
        // !tooltip[/ctx.accounts.new_account.data = data/] initialize
        ctx.accounts.new_account.data = data;
        // !tooltip[/msg!/] msg
        msg!("Changed data to: {}!", data); // Message will show up in the tx logs
        Ok(())
    }
}

// !tooltip[/Accounts/] accounts
#[derive(Accounts)]
pub struct Initialize<'info> {
    // We must specify the space in order to initialize an account.
    // First 8 bytes are default account discriminator,
    // next 8 bytes come from NewAccount.data being type u64.
    // (u64 = 64 bits unsigned integer = 8 bytes)
    // !tooltip[/account/] constraints
    #[account(
      // !tooltip[/init/] init
      init,
      // !tooltip[/payer/] payer
      payer = signer,
      // !tooltip[/space/] space
      space = 8 + 8
    )]
    pub new_account: Account<'info, NewAccount>,
    // !tooltip[/account/] constraints
    #[account(mut)]
    pub signer: Signer<'info>,
    pub system_program: Program<'info, System>,
}

// !tooltip[/account/] account
#[account]
pub struct NewAccount {
    data: u64
}
```

### !declare_id

La dirección de tu programa en la cadena. Se actualizará cuando construyas el
proyecto

### !program

El módulo que contiene las instrucciones del programa

### !accounts

Anota una estructura que contiene las cuentas del programa

### !account

Una estructura que representa los tipos de datos de cuenta que este programa
puede crear y poseer

### !constraints

Restricciones de cuenta. Por ejemplo, comprobaciones comunes o características
que mejoran la seguridad del programa

### !parameter

El valor pasado a la instrucción cuando es llamada

### !initialize

Accede al campo `data` de la cuenta `new_account` y lo establece al valor de
`data: u64`

### !msg

La macro _rs`msg!`_ registra un mensaje en los logs del programa de la
transacción

### !init

Invoca al System Program para crear una nueva cuenta y hace que este programa
sea el propietario. Como propietario del programa, este programa puede entonces
escribir en los datos de la cuenta

### !payer

La cuenta que paga por la nueva cuenta

### !space

El número de bytes a asignar para la cuenta

</WithNotes>

<Accordions>

<Accordion title="Explicación">

<WithMentions>

- La macro [`declare_id!`](mention:one) especifica la dirección en cadena de tu
  programa. Solana Playground actualizará automáticamente esta dirección cuando
  compiles el programa.

```rs
// !mention one
declare_id!("11111111111111111111111111111111");
```

</WithMentions>

<WithMentions>

- El atributo [`#[program]`](mention:one) anota un módulo que contiene funciones
  que representan las instrucciones del programa.

```rs
// !mention one
#[program]
mod hello_anchor {
    use super::*;
    // !mention two
    pub fn initialize(ctx: Context<Initialize>, data: u64) -> Result<()> {
        // !mention three
        ctx.accounts.new_account.data = data;
        msg!("Changed data to: {}!", data); // Message will show up in the tx logs
        Ok(())
    }
}
```

En este ejemplo, la instrucción [`initialize`](mention:two) toma dos parámetros:

- `ctx: Context<Initialize>`: Pasa las cuentas requeridas para esta instrucción
  a la función, según lo especificado en la estructura `Initialize`.
- `data: u64`: Un parámetro personalizado que debes proporcionar cuando llamas a
  la instrucción.

El cuerpo de la función
[establece el campo `data` de `new_account`](mention:three) al argumento `data`
proporcionado, luego imprime un mensaje en los logs del programa.

</WithMentions>

<WithMentions>

- El atributo [`#[derive(Accounts)]`](mention:one) define una estructura que
  especifica las cuentas requeridas para una instrucción particular. Cada campo
  representa una cuenta separada.

  Anchor maneja automáticamente las comprobaciones de seguridad comunes
  relacionadas con la validación de cuentas a través de tipos de campo (ej.
  `Signer<'info>`) y restricciones (ej. `#[account(mut)]`).

  ```rs
  // !mention one
  #[derive(Accounts)]
  pub struct Initialize<'info> {
      #[account(init, payer = signer, space = 8 + 8)]
      pub new_account: Account<'info, NewAccount>,
      #[account(mut)]
      pub signer: Signer<'info>,
      pub system_program: Program<'info, System>,
  }
  ```

</WithMentions>

<WithMentions>

- El atributo [`#[account]`](mention:one) define una estructura que representa
  el tipo de datos para las cuentas que este programa crea y posee.

```rs
// !mention one
#[account]
pub struct NewAccount {
  data: u64
}
```

</WithMentions>

</Accordion>
</Accordions>

</Step>
<Step>

### Compilar y desplegar el programa

1. Compila el código del programa

```terminal
$ build
Building...
Build successful. Completed in 1.46s.
```

<Callout>
  Tu [ID de programa](/docs/intro/quick-start/deploying-programs), definido en
  _rs`declare_id!()`_, ahora será actualizado.
</Callout>

2. Añade SOL a tu billetera _(Opcional)_

Desplegar un programa requiere SOL en la cuenta del programa en la cadena. Si es
necesario,
[añade SOL a tu billetera](/docs/intro/quick-start#add-sol-to-your-wallet) antes
de proceder al paso 3.

3. Despliega el programa en la red

```terminal
$ deploy
Deploying... This could take a while depending on the program size and network conditions.
Warning: 1 transaction not confirmed, retrying...
Deployment successful. Completed in 19s.
```

<Callout type="info">
  Cuando se despliega, el bytecode del programa se almacena en una cuenta de
  programa ejecutable.
</Callout>

**Nota:** Si lo prefieres, puedes usar los botones **Build** y **Deploy** en el
panel izquierdo, como se muestra en la captura de pantalla a continuación.

![Compilar y Desplegar](/assets/docs/intro/quickstart/pg-build-deploy.png)

</Step>
<Step>

### Probar el programa

<WithMentions>

1. Abre el archivo de prueba llamado `tests/anchor.test.ts`. Este archivo
   demuestra cómo invocar la estructura [`initialize`](mention:one) del programa
   desde el cliente.

```ts title="anchor.test.ts"
// No imports needed: web3, anchor, pg and more are globally available

describe("Test", () => {
  it("initialize", async () => {
    // Generate keypair for the new account
    const newAccountKp = new web3.Keypair();

    // Send transaction
    const data = new BN(42);
    const txHash = await pg.program.methods
      // !mention one
      .initialize(data)
      .accounts({
        newAccount: newAccountKp.publicKey,
        signer: pg.wallet.publicKey,
        systemProgram: web3.SystemProgram.programId
      })
      .signers([newAccountKp])
      .rpc();
    console.log(`Use 'solana confirm -v ${txHash}' to see the logs`);

    // Confirm transaction
    await pg.connection.confirmTransaction(txHash);

    // Fetch the created account
    const newAccount = await pg.program.account.newAccount.fetch(
      newAccountKp.publicKey
    );

    console.log("On-chain data is:", newAccount.data.toString());

    // Check whether the data on-chain is equal to local 'data'
    assert(data.eq(newAccount.data));
  });
});
```

</WithMentions>

2. Ejecuta el archivo de prueba

```terminal
$ test
Running tests...
  hello_anchor.test.ts:
  hello_anchor
    Use 'solana confirm -v 3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc' to see the logs
    On-chain data is: 42
    ✔ initialize (961ms)
  1 passing (963ms)
```

3. Guarda el hash de la transacción (`TxHash`) incluido en la salida

(En el ejemplo anterior, el hash de la transacción es
`3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc`.)

**Nota:** Si lo prefieres, puedes usar el botón `Test` en el panel izquierdo.

![Ejecutar prueba](/assets/docs/intro/quickstart/pg-test.png)

4. Ejecuta `solana confirm -v [TxHash]` para ver los registros de la transacción

```terminal
$ solana confirm -v 3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc
RPC URL: https://api.devnet.solana.com
Default Signer: Playground Wallet
Commitment: confirmed

Transaction executed in slot 308150984:
  Block Time: 2024-06-25T12:52:05-05:00
  Version: legacy
  Recent Blockhash: 7AnZvY37nMhCybTyVXJ1umcfHSZGbngnm4GZx6jNRTNH
  Signature 0: 3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc
  Signature 1: 3TrRbqeMYFCkjsxdPExxBkLAi9SB2pNUyg87ryBaTHzzYtGjbsAz9udfT9AkrjSo1ZjByJgJHBAdRVVTZv6B87PQ
  Account 0: srw- 3z9vL1zjN6qyAFHhHQdWYRTFAcy69pJydkZmSFBKHg1R (fee payer)
  Account 1: srw- c7yy8zdP8oeZ2ewbSb8WWY2yWjDpg3B43jk3478Nv7J
  Account 2: -r-- 11111111111111111111111111111111
  Account 3: -r-x 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r
  Instruction 0
    Program:   2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r (3)
    Account 0: c7yy8zdP8oeZ2ewbSb8WWY2yWjDpg3B43jk3478Nv7J (1)
    Account 1: 3z9vL1zjN6qyAFHhHQdWYRTFAcy69pJydkZmSFBKHg1R (0)
    Account 2: 11111111111111111111111111111111 (2)
    Data: [175, 175, 109, 31, 13, 152, 155, 237, 42, 0, 0, 0, 0, 0, 0, 0]
  Status: Ok
    Fee: ◎0.00001
    Account 0 balance: ◎5.47001376 -> ◎5.46900152
    Account 1 balance: ◎0 -> ◎0.00100224
    Account 2 balance: ◎0.000000001
    Account 3 balance: ◎0.00139896
  Log Messages:
    Program 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r invoke [1]
    Program log: Instruction: Initialize
    Program 11111111111111111111111111111111 invoke [2]
    Program 11111111111111111111111111111111 success
    Program log: Changed data to: 42!
    Program 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r consumed 5661 of 200000 compute units
    Program 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r success

Confirmed
```

4. Ver los detalles de la transacción

Abre [SolanaFM](https://solana.fm/) o
[Solana Explorer](https://explorer.solana.com/?cluster=devnet) y busca el hash
de la transacción.

<Callout type="warn">
  **Solana Explorer:** Configura el clúster de red a `devnet`, para que coincida
  con el de Solana Playground.
</Callout>

</Step>
<Step>

### Cerrar el programa

Cierra el programa para recuperar el SOL asignado al programa en la cadena. Para
hacerlo, ejecuta `solana program close [ProgramID]`, usando la dirección del
programa almacenada en el macro _rs`declare_id!()`_.

```terminal
$ solana program close 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r
Closed Program Id 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r, 2.79511512 SOL reclaimed
```

<Callout type="warn">
  Los programas **solo** pueden ser cerrados o actualizados por una cuenta con
  autoridad de actualización. Tu billetera de Playground automáticamente se
  convierte en la autoridad de actualización para cada programa cuando se
  despliega. Si se revoca la autoridad de actualización, el programa se vuelve
  inmutable.
</Callout>

¡Felicidades! Has construido y desplegado tu primer programa de Solana usando
Anchor.

</Step>
</Steps>

## Próximos pasos

Ahora que has desplegado tu primer programa, estás listo para explorar
[direcciones derivadas de programas](/docs/intro/quick-start/program-derived-address)
e
[invocación entre programas](/docs/intro/quick-start/cross-program-invocation).
