---
title: Implementación de programas
description:
  Guía completa para construir, implementar y gestionar programas de Solana
  utilizando la CLI de Solana.
---

Esta sección explica el proceso básico de implementación de un programa de
Solana utilizando la CLI de Solana.

## Referencia de comandos CLI

| Tarea                                | Comando                                                                                       |
| ------------------------------------ | --------------------------------------------------------------------------------------------- |
| Compilar programa                    | `cargo build-sbf`                                                                             |
| Desplegar nuevo programa             | `solana program deploy <path_to_program.so>`                                                  |
| Actualizar programa existente        | `solana program deploy <path_to_program.so>` (igual que desplegar)                            |
| Mostrar información del programa     | `solana program show <program-id>`                                                            |
| Transferir autoridad del programa    | `solana program set-upgrade-authority <program-id> --new-upgrade-authority <path_to_keypair>` |
| Hacer programa inmutable             | `solana program set-upgrade-authority <program-id> --final`                                   |
| Cerrar programa                      | `solana program close <program-id> --bypass-warning`                                          |
| Verificar saldo de billetera         | `solana balance`                                                                              |
| Solicitar airdrop (devnet/localhost) | `solana airdrop 2`                                                                            |

## Conceptos clave

Antes de profundizar, aclaremos algunos términos:

- **ID del programa**: La dirección en la cadena de tu programa. Los usuarios
  interactúan con tu programa haciendo referencia al ID del programa.
- **Program Account**: La cuenta en la cadena que almacena los metadatos de tu
  programa. La dirección de la program account es el ID del programa. La program
  account también almacena la dirección de la ProgramData Account.
- **ProgramData Account**: La cuenta en la cadena que almacena el código
  ejecutable implementado de tu programa.
- **Autoridad del programa**: La cuenta que tiene permiso para actualizar o
  cerrar el programa. Por defecto, esta es tu billetera CLI.

## Requisitos previos

<Steps>

<Step>

### Instalar la CLI de Solana

Primero, [instala la CLI de Solana](/docs/intro/installation).

</Step>

<Step>

### Configurar la billetera

Después de la instalación, crea una billetera local con par de claves. La
dirección de esta billetera se establece como la autoridad del programa
predeterminada al implementar programas:

```terminal
$ solana-keygen new
```

Esto crea un keypair en `~/.config/solana/id.json` de forma predeterminada.

</Step>

<Step>

### Configurar clúster

Elige a qué clúster de Solana desplegar. Usa el comando `solana config get` para
verificar tu configuración actual:

```terminal
$ solana config get
Config File: ~/.config/solana/cli/config.yml
RPC URL: http://localhost:8899
WebSocket URL: ws://localhost:8900/ (computed)
Keypair Path: ~/.config/solana/id.json
Commitment: confirmed
```

Cambia entre clústeres según sea necesario:

```terminal
$ solana config set --url mainnet-beta
$ solana config set --url devnet
$ solana config set --url localhost
$ solana config set --url testnet
$ solana config set --url "https://your-rpc-url.com"
```

</Step>

<Step>

### Fondear billetera

Necesitarás SOL para pagar los despliegues del programa. La cantidad depende del
tamaño de tu programa.

Para devnet o localhost, financia tu billetera usando el comando
`solana airdrop`:

```terminal
$ solana airdrop 2
Requesting airdrop of 2 SOL
Signature: 5zQKxvRdgJDA8fRGPdKfGxRLnLpwmNnMXGYxfBqFSUPqc5BTmFPrTG8vnC4HvKDVY8zQ8aQxZxcEE7WFpGhZGVAA
2 SOL
```

Verifica el saldo de tu billetera:

```terminal
$ solana balance
2 SOL
```

</Step>

</Steps>

## Operaciones básicas

### Compilar programa

Para compilar un programa, usa el comando `cargo build-sbf`:

```terminal
$ cargo build-sbf
```

<ScrollyCoding>

## !!steps Programa de ejemplo

Aquí hay un programa mínimo de Solana que imprime "Hello, Solana!" en los
registros del programa.

<CodePlaceholder title="src/lib.rs" />

```rs !! title="src/lib.rs"
use solana_program::{
    account_info::AccountInfo, entrypoint, entrypoint::ProgramResult, msg, pubkey::Pubkey,
};

entrypoint!(process_instruction);

pub fn process_instruction(
    _program_id: &Pubkey,
    _accounts: &[AccountInfo],
    _instruction_data: &[u8],
) -> ProgramResult {
    msg!("Hello, Solana!");
    Ok(())
}
```

```toml !! title="Cargo.toml"
[package]
name = "hello_world"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib", "lib"]

[dependencies]
solana-program = "2.2.0"
```

## !!steps Resultado de la compilación

Compila tu programa usando el comando `cargo build-sbf`:

```terminal
$ cargo build-sbf
```

Esto crea dos archivos importantes en `target/deploy/`:

1. `hello_world-keypair.json`: Un archivo de keypair cuya clave pública se usará
   como tu ID de programa
2. `hello_world.so`: El ejecutable del programa compilado

```json !! title="target/deploy/hello_world-keypair.json"
[
  203, 253, 43, 62, 165, 111, 94, 222, 105, 225, 218, 85, 143, 9, 114, 96, 243,
  181, 114, 89, 72, 230, 124, 85, 59, 165, 198, 23, 240, 212, 23, 154, 229, 241,
  153, 61, 153, 105, 79, 204, 193, 163, 33, 65, 82, 183, 49, 240, 224, 137, 248,
  24, 128, 25, 192, 197, 118, 235, 239, 67, 85, 156, 219, 231
]
```

```txt !! title="target/deploy/hello_world.so"
[binary executable file]
```

</ScrollyCoding>

### Verificar el tamaño y costo del programa

Implementar un programa requiere SOL que se asignará a la cuenta del programa
según el tamaño del programa. Los programas más grandes cuestan más SOL para
implementar.

Verifica el tamaño de tu programa:

```terminal
$ wc -c < ./target/deploy/hello_world.so
18504
```

Calcula el SOL requerido para este tamaño (bytes):

```terminal
$ solana rent 18504
Rent-exempt minimum: 0.12967872 SOL
```

<Callout type="info">
  Necesitarás un poco más de SOL que lo mostrado para cubrir las comisiones de
  transacción de implementación.
</Callout>

### Implementar programa

Usa el comando `solana program deploy` para desplegar tu programa:

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 2BYwsqRP7ZwBNQvJp3S8bphTJ4zKW5JBPVMqCTE5KyLkP8xHzAyUEeC4LdTgjJdGBKHWNCkRF8Mf1T1WkLFyEu8W
```

El **Id del programa** mostrado es la dirección permanente de tu programa en la
red.

<Callout>

Para implementar con un ID de programa específico (en lugar del generado
automáticamente), usa:

```terminal
$ solana program deploy ./target/deploy/hello_world.so --program-id ./custom-keypair.json
```

Puedes generar nuevos keypairs usando el comando `solana-keygen`:

```terminal
$ solana-keygen new -o ./custom-keypair.json
```

</Callout>

### Actualizar programa

Actualiza tu programa usando el mismo comando `solana program deploy`:

1. Realiza cambios en el código de tu programa
2. Recompila tu programa: `cargo build-sbf`
3. Implementa la actualización:

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 3zKnXDfEm1R8hVcEmTnNFYUaFjVVbLJrKdFj5hBMXoBRfz8xGyDhCYgKr9YY5KxKYPEUQQVfwEPNz9hQGvYhLNBJ
```

<Callout type="info">

Si tu programa actualizado requiere más espacio (bytes) del que está actualmente
asignado, el despliegue extenderá automáticamente la cuenta del programa. Esto
ocurre cuando tu nuevo programa es más grande que la versión anterior. La cuenta
del programa necesita bytes adicionales para almacenar el nuevo programa. La CLI
calculará el SOL requerido y lo deducirá de tu billetera automáticamente.

También puedes extender manualmente un programa para asignar más bytes:

```terminal
$ solana program extend 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE 1000
Extended Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE by 1000 bytes
```

</Callout>

## Gestión de programas

Una vez que tu programa está desplegado, hay varios comandos comunes para
gestionar la cuenta del programa.

### Ver metadatos del programa

Para verificar los metadatos de tu programa, usa el comando
`solana program show`:

```terminal
$ solana program show 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
```

<WithNotes>

Ejemplo de salida:

```txt
$ solana program show 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Program Id/] program-id
Program Id: 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Owner/] owner
Owner: BPFLoaderUpgradeab1e11111111111111111111111
# !tooltip[/ProgramData Address/] program-data-address
ProgramData Address: Gqn7YQVCP8NtYV1qkEqR4Udhj8EJ3fkikvS7HskCNQ7c
# !tooltip[/Authority/] authority
Authority: 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1
# !tooltip[/Last Deployed In Slot/] last-deployed-in-slot
Last Deployed In Slot: 6573
# !tooltip[/Data Length/] data-length
Data Length: 18504 (0x4848) bytes
# !tooltip[/Balance/] balance
Balance: 0.12999192 SOL
```

### !program-id

El ID del programa es la dirección en la cadena de tu cuenta de programa. Los
usuarios y otros programas invocan tu programa haciendo referencia a este ID en
sus transacciones.

### !owner

El propietario identifica qué cargador se utilizó para desplegar este programa.
Para la mayoría de los programas, este será el BPF Upgradeable Loader.

### !program-data-address

La dirección de ProgramData apunta a la cuenta separada que almacena el código
ejecutable de tu programa.

### !authority

La autoridad es la cuenta que tiene permiso para actualizar o cerrar este
programa. Solo la autoridad puede implementar actualizaciones o cerrar el
programa para recuperar el SOL asignado al programa.

### !last-deployed-in-slot

El último slot de implementación indica cuándo se actualizó este programa por
última vez.

### !data-length

La longitud de datos muestra el total de bytes asignados a este programa. Este
espacio puede acomodar futuras actualizaciones que pueden ser más grandes que el
tamaño actual del programa.

### !balance

El balance muestra el SOL asignado a la cuenta del programa para almacenar sus
datos.

</WithNotes>

### Transferir la autoridad del programa

Para transferir la autoridad del programa a una cuenta diferente, usa el comando
`solana program set-upgrade-authority`:

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --new-upgrade-authority ./new-authority-keypair.json
```

<Callout type="warn">
  Después de transferir la autoridad del programa, ya no podrás actualizar el
  programa a menos que tengas acceso al nuevo keypair de autoridad.
</Callout>

### Hacer tu programa inmutable

Para hacer tu programa inmutable, usa el comando
`solana program set-upgrade-authority` con la bandera `--final` para eliminar la
autoridad del programa:

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --final
Account Type: Program
Authority: none
```

<Callout type="warn">
  Una vez que un programa es inmutable, nunca podrá ser actualizado o cerrado.
</Callout>

### Cerrar tu programa

Para cerrar tu programa y recuperar el SOL asignado a la cuenta del programa,
usa el comando `solana program close`:

```terminal
$ solana program close 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --bypass-warning
Closed Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE, 0.12999192 SOL reclaimed
```

<Callout type="warn">
  Una vez cerrado, el ID del programa no puede ser reutilizado. No puedes
  implementar un nuevo programa en la misma dirección.
</Callout>

## Comandos de utilidad

### Listar todos los programas

Ver todos los programas donde tu billetera actual es la autoridad:

```terminal
$ solana program show --programs
```

Ejemplo de salida:

```txt
Program Id                                       | Slot       | Authority                                      | Balance
-------------------------------------------------|------------|------------------------------------------------|-------------
7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE     | 249885434  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.12999192
3KSGCk4m5hqJkTjPHBXUCPcqMwJnK3VmkqEsFUKKGJPK     | 249883212  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.28654328
```

### Descargar un programa implementado

Para descargar un programa implementado, usa el comando `solana program dump`:

```terminal
$ solana program dump 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE ./downloaded_program.so
Wrote program to ./downloaded_program.so
```

## Opciones avanzadas

### Indicadores de implementación

Cuando la red de Solana está congestionada, utiliza estos indicadores para
ayudar con la implementación del programa.

Ejemplo de uso:

```terminal
$ solana program deploy ./target/deploy/hello_world.so \
    --with-compute-unit-price 10000 \
    --max-sign-attempts 10 \
    --use-rpc
```

Explicación de las opciones:

- **`--with-compute-unit-price`**: Establece la tarifa de prioridad en
  micro-lamports (0.000001 SOL) por unidad de cómputo. Consulta la
  [API de tarifas de prioridad de Helius](https://docs.helius.dev/guides/priority-fee-api)
  para conocer las tarifas actuales. Una tarifa de prioridad es una tarifa
  adicional que se paga al líder actual para priorizar tu transacción.
- **`--max-sign-attempts`**: Número de veces que se reintentará con un nuevo
  blockhash si las transacciones expiran. (Predeterminado: 5)
- **`--use-rpc`**: Envía transacciones al RPC configurado. Esta bandera requiere
  una conexión RPC
  [ponderada por stake](/developers/guides/advanced/stake-weighted-qos) de
  proveedores como [Triton](https://triton.one/) o
  [Helius](https://www.helius.dev/).
