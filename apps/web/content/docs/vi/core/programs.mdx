---
title: Các chương trình
description:
  Tìm hiểu về các chương trình Solana (hợp đồng thông minh) và cách phát triển
  chúng bằng Rust hoặc framework Anchor. Hiểu về triển khai, nâng cấp và xác
  minh chương trình trên mạng Solana.
h1: Các chương trình
---

Trên Solana, một hợp đồng thông minh được gọi là chương trình. Một chương trình
là một [tài khoản](/docs/core/accounts#program-account) phi trạng thái chứa mã
thực thi. Mã này được tổ chức thành các hàm gọi là các chỉ thị. Người dùng tương
tác với một chương trình bằng cách gửi một [giao dịch](/docs/core/transaction)
chứa một hoặc nhiều [chỉ thị](/docs/core/instructions). Một giao dịch có thể bao
gồm chỉ thị từ nhiều chương trình.

Khi một chương trình được triển khai, Solana sử dụng [LLVM](https://llvm.org/)
để biên dịch nó thành định dạng thực thi và liên kết
([ELF](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format)). Tệp ELF
chứa mã nhị phân của chương trình ở Định dạng Bytecode Solana (sBPF) và được lưu
trên chuỗi trong một tài khoản thực thi.

<Callout>
  sBPF là phiên bản tùy chỉnh của Solana cho mã bytecode
  [eBPF](https://en.wikipedia.org/wiki/EBPF).
</Callout>

## Viết chương trình

Phần lớn các chương trình được viết bằng
[Rust](https://rust-book.cs.brown.edu/title-page.html), với hai phương pháp phát
triển phổ biến:

- [Anchor](https://www.anchor-lang.com/docs): Anchor là một framework được thiết
  kế để phát triển Solana nhanh chóng và dễ dàng. Nó sử dụng
  [Rust macros](https://doc.rust-lang.org/book/ch20-05-macros.html) để giảm mã
  soạn sẵn—làm cho nó trở nên tuyệt vời cho người mới bắt đầu.
- [Native Rust](/docs/programs/rust): Viết chương trình bằng Rust mà không sử
  dụng bất kỳ framework nào. Phương pháp này cung cấp nhiều linh hoạt hơn nhưng
  đi kèm với độ phức tạp cao hơn.

## Cập nhật chương trình

Để
[sửa đổi](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/bpf_loader/src/lib.rs#L704)
một chương trình hiện có, một tài khoản phải được chỉ định là
[quyền nâng cấp](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/bpf_loader/src/lib.rs#L894).
(Thường là cùng một tài khoản đã ban đầu
[triển khai chương trình](/docs/programs/deploying).) Nếu quyền nâng cấp bị rút
lại và đặt thành null, chương trình không thể được cập nhật nữa.

## Xác minh chương trình

Solana hỗ trợ [bản dựng có thể xác minh](/docs/programs/verified-builds), cho
phép người dùng kiểm tra xem mã trên chuỗi của một chương trình có khớp với mã
nguồn công khai của nó hay không. Framework Anchor cung cấp
[hỗ trợ tích hợp](https://www.anchor-lang.com/docs/verifiable-builds) để tạo một
bản dựng có thể xác minh.

Để kiểm tra xem một chương trình hiện có đã được xác minh hay chưa, tìm kiếm ID
chương trình của nó trên
[Solana Explorer](https://explorer.solana.com/address/PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY).
Ngoài ra, bạn có thể sử dụng
[Solana Verifiable Build CLI](https://github.com/Ellipsis-Labs/solana-verifiable-build)
của Ellipsis Labs, để độc lập xác minh các chương trình trên chuỗi.

## Các chương trình tích hợp sẵn

### Các chương trình tải

Mỗi chương trình đều thuộc sở hữu của một chương trình khác—trình tải của nó.
Các trình tải được sử dụng để triển khai, triển khai lại, nâng cấp hoặc đóng các
chương trình. Chúng cũng được sử dụng để hoàn thiện một chương trình và chuyển
giao quyền quản lý chương trình.

Hiện tại có năm chương trình tải, như được hiển thị trong bảng dưới đây.

| Trình tải | Program ID                                    | Ghi chú                                                                                                                                                  | Liên kết hướng dẫn                                                                                                                           |
| --------- | --------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| native    | `NativeLoader1111111111111111111111111111111` | Sở hữu bốn trình tải còn lại                                                                                                                             | —                                                                                                                                            |
| v1        | `BPFLoader1111111111111111111111111111111111` | Các hướng dẫn quản lý bị vô hiệu hóa, nhưng các chương trình vẫn thực thi                                                                                | —                                                                                                                                            |
| v2        | `BPFLoader2111111111111111111111111111111111` | Các hướng dẫn quản lý bị vô hiệu hóa, nhưng các chương trình vẫn thực thi                                                                                | [Hướng dẫn](https://docs.rs/solana-loader-v2-interface/latest/solana_loader_v2_interface/enum.LoaderInstruction.html)                        |
| v3        | `BPFLoaderUpgradeab1e11111111111111111111111` | Các chương trình có thể được cập nhật sau khi triển khai. Tệp thực thi của chương trình được lưu trữ trong một tài khoản dữ liệu chương trình riêng biệt | [Hướng dẫn](https://docs.rs/solana-loader-v3-interface/latest/solana_loader_v3_interface/instruction/enum.UpgradeableLoaderInstruction.html) |
| v4        | `LoaderV411111111111111111111111111111111111` | Đang phát triển (chưa phát hành)                                                                                                                         | [Hướng dẫn](https://docs.rs/solana-loader-v4-interface/latest/solana_loader_v4_interface/instruction/enum.LoaderV4Instruction.html)          |

Các chương trình được triển khai với loader-v3 hoặc loader-v4 có thể được sửa
đổi sau khi triển khai, tùy thuộc vào quyền nâng cấp của nó.

### Các chương trình biên dịch sẵn

Ngoài các chương trình tải, Solana cung cấp các chương trình biên dịch sẵn sau
đây.

#### Xác minh chữ ký ed25519

Chương trình ed25519 được sử dụng để xác minh một hoặc nhiều chữ ký ed25519.

| Chương trình         | Program ID                                    | Mô tả                                                                            | Hướng dẫn                                                                                    |
| -------------------- | --------------------------------------------- | -------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- |
| Chương trình Ed25519 | `Ed25519SigVerify111111111111111111111111111` | Xác minh chữ ký ed25519. Nếu bất kỳ chữ ký nào thất bại, một lỗi sẽ được trả về. | [Hướng dẫn](https://docs.rs/solana-ed25519-program/latest/solana_ed25519_program/index.html) |

Chương trình ed25519 xử lý một hướng dẫn. Byte đầu tiên của hướng dẫn `u8` chứa
số lượng chữ ký cần kiểm tra, theo sau là một byte đệm. Sau đó, cấu trúc sau đây
được tuần tự hóa, một cho mỗi chữ ký cần kiểm tra.

```rust
pub struct Ed25519SignatureOffsets {
    signature_offset: u16,             // offset to ed25519 signature of 64 bytes
    signature_instruction_index: u16,  // instruction index to find signature
    public_key_offset: u16,            // offset to public key of 32 bytes
    public_key_instruction_index: u16, // instruction index to find public key
    message_data_offset: u16,          // offset to start of message data
    message_data_size: u16,            // size of message data
    message_instruction_index: u16,    // index of instruction for message data
}
```

Điều này cho phép người dùng chỉ định bất kỳ instruction data nào trong giao
dịch cho dữ liệu chữ ký và tin nhắn. Bằng cách chỉ định một sysvar instructions
đặc biệt, người dùng cũng có thể nhận dữ liệu từ chính giao dịch.

#### Xác minh khôi phục secp256k1

Chương trình secp256k1 được sử dụng để xác minh các hoạt động khôi phục khóa
công khai secp256k1.

| Chương trình           | ID chương trình                               | Mô tả                                                                  | Hướng dẫn                                                                                        |
| ---------------------- | --------------------------------------------- | ---------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------ |
| Chương trình Secp256k1 | `KeccakSecp256k11111111111111111111111111111` | Xác minh các hoạt động khôi phục khóa công khai secp256k1 (ecrecover). | [Hướng dẫn](https://docs.rs/solana-secp256k1-program/latest/solana_secp256k1_program/index.html) |

Chương trình secp256k1 xử lý một hướng dẫn. Byte đầu tiên của hướng dẫn chứa số
lượng khóa công khai cần kiểm tra. Sau đó, cấu trúc sau đây được tạo một lần cho
mỗi khóa công khai, sau đó được tuần tự hóa và thêm vào instruction data.

```rust
pub struct Secp256k1SignatureOffsets {
    signature_offset: u16,             // offset to secp256k1 signature data of 64 bytes
    signature_instruction_index: u16,  // instruction index to find signature
    eth_address_offset: u16,           // offset to eth_address of 20 bytes
    eth_address_instruction_index: u16,// instruction index to find eth_address
    message_data_offset: u16,          // offset to start of message data
    message_data_size: u16,            // size of message data
    message_instruction_index: u16,    // instruction index to find message data
}
```

Mã giả của quá trình xác minh khôi phục:

Điều này cho phép người dùng chỉ định bất kỳ instruction data nào trong giao
dịch cho dữ liệu chữ ký và tin nhắn. Bằng cách chỉ định một sysvar instructions
đặc biệt, người dùng cũng có thể nhận dữ liệu từ chính giao dịch.

Chi phí của giao dịch sẽ tính số lượng chữ ký cần xác minh nhân với hệ số nhân
chi phí xác minh chữ ký.

Chương trình secp256r1 được sử dụng để xác minh tối đa 8 chữ ký secp256r1.

| Chương trình           | ID chương trình                               | Mô tả                                                                                                   | Hướng dẫn                                                                                      |
| ---------------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------- |
| Chương trình Secp256r1 | `Secp256r1SigVerify1111111111111111111111111` | Xác minh tối đa 8 chữ ký secp256r1. Nhận một chữ ký, khóa công khai và tin nhắn. Trả về lỗi nếu có lỗi. | [Hướng dẫn](https://docs.rs/solana-secp256r1-program/latest/solana_secp256r1_program/all.html) |

Chương trình secp256r1 xử lý một hướng dẫn. Byte đầu tiên của instruction data
là số lượng chữ ký cần kiểm tra, theo sau là một byte đệm. Sau đó, cấu trúc sau
đây được tạo cho mỗi chữ ký, sau đó được tuần tự hóa và thêm vào instruction
data.

Chữ ký ECDSA là một cặp số nguyên (r, s) được tính toán từ:

- Khóa riêng tư của người ký
- Dữ liệu đang được ký (hoặc hàm băm của nó)
- Một số ngẫu nhiên được gọi là "nonce"

Đối với mỗi chữ ký, nếu s > curve_order/2, thì s' = curve_order - s cũng là một
chữ ký hợp lệ. Để tránh sự mơ hồ này, Solana yêu cầu tất cả các chữ ký phải sử
dụng giá trị s thấp hơn.

<Callout>
  Các giá trị S thấp được áp dụng cho tất cả chữ ký để tránh tính dễ thay đổi
  chữ ký do vô tình.
</Callout>

Để xác minh chữ ký, validator cần:

1. Khóa công khai của người ký
2. Dữ liệu đã được ký
3. Chữ ký (r, s)

Nếu chữ ký hợp lệ, validator sẽ chấp nhận giao dịch. Nếu không, giao dịch sẽ bị
từ chối.

### Các chương trình cốt lõi

Các chương trình trong danh sách dưới đây cung cấp chức năng cốt lõi của mạng.

| Chương trình             | ID chương trình                               | Mô tả                                                                                                                                                                                                                                                                                                                                                                       | Hướng dẫn                                                                                                                                             |
| ------------------------ | --------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **System**               | `11111111111111111111111111111111`            | Tạo tài khoản mới, phân bổ dữ liệu tài khoản, gán tài khoản cho các chương trình sở hữu, chuyển lamport từ các tài khoản thuộc sở hữu của System Program và thanh toán phí giao dịch                                                                                                                                                                                        | [SystemInstruction](https://docs.rs/solana-program/latest/solana_program/system_instruction/enum.SystemInstruction.html)                              |
| **Vote**                 | `Vote111111111111111111111111111111111111111` | Tạo và quản lý các tài khoản theo dõi trạng thái bỏ phiếu của validator và phần thưởng                                                                                                                                                                                                                                                                                      | [VoteInstruction](https://docs.rs/solana-vote-program/latest/solana_vote_program/vote_instruction/enum.VoteInstruction.html)                          |
| **Stake**                | `Stake11111111111111111111111111111111111111` | Tạo và quản lý các tài khoản đại diện cho cổ phần và phần thưởng cho việc ủy quyền cho các validator                                                                                                                                                                                                                                                                        | [StakeInstruction](https://docs.rs/solana-sdk/latest/solana_sdk/stake/instruction/enum.StakeInstruction.html)                                         |
| **Config**               | `Config1111111111111111111111111111111111111` | Thêm dữ liệu cấu hình vào chuỗi, theo sau là danh sách các khóa công khai được phép sửa đổi nó. Không giống như các chương trình khác, chương trình Config không định nghĩa bất kỳ hướng dẫn riêng lẻ nào. Nó chỉ có một hướng dẫn ngầm: "store". Dữ liệu hướng dẫn của nó là một tập hợp các khóa kiểm soát quyền truy cập vào tài khoản và dữ liệu được lưu trữ bên trong | [ConfigInstruction](https://docs.rs/solana-config-program/latest/solana_config_program/config_instruction/index.html)                                 |
| **Compute Budget**       | `ComputeBudget111111111111111111111111111111` | Thiết lập giới hạn đơn vị tính toán và giá cho các giao dịch, cho phép người dùng kiểm soát tài nguyên tính toán và phí ưu tiên                                                                                                                                                                                                                                             | [ComputeBudgetInstruction](https://docs.rs/solana-compute-budget-interface/latest/solana_compute_budget_interface/enum.ComputeBudgetInstruction.html) |
| **Address Lookup Table** | `AddressLookupTab1e1111111111111111111111111` | Quản lý bảng tra cứu địa chỉ, cho phép các giao dịch tham chiếu nhiều tài khoản hơn so với những gì có thể phù hợp trong danh sách tài khoản của giao dịch                                                                                                                                                                                                                  | [ProgramInstruction](https://docs.rs/solana-sdk/latest/solana_sdk/address_lookup_table/instruction/enum.ProgramInstruction.html)                      |
| **ZK ElGamal Proof**     | `ZkE1Gama1Proof11111111111111111111111111111` | Cung cấp xác minh bằng chứng zero-knowledge cho dữ liệu được mã hóa ElGamal                                                                                                                                                                                                                                                                                                 | —                                                                                                                                                     |
