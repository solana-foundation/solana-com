---
title: İşlemler
description:
  Solana işlemleri hakkında bilgi edinin—Solana blok zinciriyle etkileşim
  kurmanın temel yapı taşları. Pratik örneklerle işlem yapısını ve talimat
  kompozisyonunu anlayın.
---

Solana ağıyla etkileşim kurmak için bir işlem göndermeniz gerekir. Bir işlemi,
içinde birkaç form bulunan bir zarf olarak düşünebilirsiniz. Her form, ağa ne
yapması gerektiğini söyleyen bir talimattır. İşlemi göndermek, formların
işlenebilmesi için zarfı postalamak gibidir.

Aşağıdaki örnek, iki işlemin basitleştirilmiş bir versiyonunu göstermektedir.
İlk işlem işlendiğinde, tek bir talimatı yürütecektir. İkinci işlem
işlendiğinde, **sıralı olarak** üç talimatı yürütecektir: önce talimat 1,
ardından talimat 2, ardından talimat 3.

<Callout type="warn">
  İşlemler **atomiktir**: Tek bir talimat başarısız olursa, tüm işlem başarısız
  olur ve hiçbir değişiklik gerçekleşmez.
</Callout>

![İki işlemi gösteren basitleştirilmiş bir diyagram](/assets/docs/core/transactions/transaction-simple.svg)

Bir
[Transaction](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/transaction/mod.rs#L207)
aşağıdaki bilgilerden oluşur:

<WithMentions>

- [signatures](mention:signatures): [İmzalar](#signatures) dizisi
- [message](mention:message): İşlenecek talimatlar listesi dahil işlem bilgileri

```rust title="Transaction"
pub struct Transaction {
    #[wasm_bindgen(skip)]
    #[serde(with = "short_vec")]
    // !mention signatures
    pub signatures: Vec<Signature>,

    #[wasm_bindgen(skip)]
    // !mention message
    pub message: Message,
}
```

</WithMentions>

![Bir işlemin iki parçasını gösteren diyagram](/assets/docs/core/transactions/tx_format.png)

İşlemlerin toplam boyut sınırı
[1232](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/packet/src/lib.rs#L29)
bayttır. Bu sınır hem [signatures](#signatures) dizisini hem de
[message](#message) yapısını içerir.

<Callout>
  Bu sınır, IPv6 Maksimum İletim Birimi (MTU) boyutu olan 1280 bayttan, ağ
  başlıkları için 48 bayt (40 bayt IPv6 + 8 bayt başlık) çıkarılarak elde
  edilir.
</Callout>

![İşlem formatını ve boyut sınırlarını gösteren diyagram](/assets/docs/core/transactions/issues_with_legacy_txs.png)

## İmzalar

İşlemin signatures dizisi Signature yapılarını içerir. Her
[Signature](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/signature/src/lib.rs#L30)
64 bayttır ve işlemin Message'ını hesabın özel anahtarıyla imzalayarak
oluşturulur. İşlemin talimatlarında yer alan her
[imzalayıcı hesap](#account-addresses) için bir imza sağlanmalıdır.

İlk imza, işlemin [temel ücretini](docs/core/fees#base-fee) ödeyecek hesaba
aittir ve işlem imzasıdır. İşlem imzası, ağ üzerinde işlemin ayrıntılarını
aramak için kullanılabilir.

## Mesaj

İşlemin `message` kısmı, aşağıdaki bilgileri içeren bir
[`Message`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/program/src/message/legacy.rs#L131)
yapısıdır:

<WithMentions>

- [`header`](mention:message-header): Mesaj [başlığı](#header)
- [`account_keys`](mention:account-addresses): İşlemin talimatları tarafından
  gereken [hesap adreslerinin](#account-addresses) bir dizisi
- [`recent_blockhash`](mention:recent-blockhash): İşlem için zaman damgası
  görevi gören bir [blok hash'i](#recent-blockhash)
- [`instructions`](mention:instructions): [Talimatların](#instructions) bir
  dizisi

<Callout>
  Alandan tasarruf etmek için, işlem her hesap için izinleri ayrı ayrı saklamaz.
  Bunun yerine, hesap izinleri `header` ve `account_keys` kullanılarak
  belirlenir.
</Callout>

```rust title="Message"
pub struct Message {
    /// The message header, identifying signed and read-only `account_keys`.
    // !mention message-header
    pub header: MessageHeader,

    /// All the account keys used by this transaction.
    #[serde(with = "short_vec")]
    // !mention account-addresses
    pub account_keys: Vec<Pubkey>,

    /// The id of a recent ledger entry.
    // !mention recent-blockhash
    pub recent_blockhash: Hash,

    /// Programs that will be executed in sequence and committed in
    /// one atomic transaction if all succeed.
    #[serde(with = "short_vec")]
    // !mention instructions
    pub instructions: Vec<CompiledInstruction>,
}
```

</WithMentions>

### Başlık

<WithMentions>

Mesajın `header` kısmı bir
[`MessageHeader`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/program/src/message/mod.rs#L97)
yapısıdır. Aşağıdaki bilgileri içerir:

- [`num_required_signatures`](mention:num_required_signatures): İşlem için
  gereken toplam imza sayısı
- [`num_readonly_signed_accounts`](mention:num_readonly_signed_accounts): İmza
  gerektiren salt okunur hesapların toplam sayısı
- [`num_readonly_unsigned_accounts`](mention:num_readonly_unsigned_accounts):
  İmza gerektirmeyen salt okunur hesapların toplam sayısı

```rust title="MessageHeader"
pub struct MessageHeader {
    /// The number of signatures required for this message to be considered
    /// valid. The signers of those signatures must match the first
    /// `num_required_signatures` of [`Message::account_keys`].
    // !mention num_required_signatures
    pub num_required_signatures: u8,

    /// The last `num_readonly_signed_accounts` of the signed keys are read-only
    /// accounts.
    // !mention num_readonly_signed_accounts
    pub num_readonly_signed_accounts: u8,

    /// The last `num_readonly_unsigned_accounts` of the unsigned keys are
    /// read-only accounts.
    // !mention num_readonly_unsigned_accounts
    pub num_readonly_unsigned_accounts: u8,
}
```

</WithMentions>

![Mesaj başlığının üç bölümünü gösteren diyagram](/assets/docs/core/transactions/message_header.png)

### Hesap adresleri

Mesajın
[`account_keys`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/program/src/message/legacy.rs#L138)
kısmı,
[kompakt dizi formatında](/docs/references/terminology#compact-array-format)
gönderilen hesap adreslerinin bir dizisidir. Dizinin öneki uzunluğunu belirtir.
Dizideki her öğe, talimatları tarafından kullanılan bir hesaba işaret eden bir
genel anahtardır. `accounts_keys` dizisi eksiksiz ve aşağıdaki gibi kesin bir
şekilde sıralanmış olmalıdır:

1. İmzalayan + Yazılabilir
2. İmzalayan + Salt okunur
3. İmzalamayan + Yazılabilir
4. İmzalamayan + Salt okunur

<Callout>
  Kesin sıralama, `account_keys` dizisinin mesajın [`header`](#header)
  kısmındaki bilgilerle birleştirilerek her hesap için izinlerin belirlenmesine
  olanak tanır.
</Callout>

![Hesap adresleri dizisinin sırasını gösteren diyagram](/assets/docs/core/transactions/compat_array_of_account_addresses.png)

### Son blok hash değeri

Mesajın `recent_blockhash` değeri, işlem için bir zaman damgası görevi gören ve
yinelenen işlemleri önleyen bir hash değeridir. Bir blok hash değeri
[150 blok](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/clock/src/lib.rs#L134)
sonra sona erer. (Her bloğun 400ms olduğu varsayılarak yaklaşık bir dakikaya
eşdeğerdir.) Blok süresi dolduktan sonra, işlem sona erer ve işlenemez.

<Callout>
  [`getLatestBlockhash`](/docs/rpc/http/getlatestblockhash) RPC metodu, mevcut
  blok hash değerini ve blok hash değerinin geçerli olacağı son blok
  yüksekliğini almanıza olanak tanır.
</Callout>

### Talimatlar

Mesajın
[`instructions`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/program/src/message/legacy.rs#L146)
değeri, işlenecek tüm talimatların
[kompakt dizi formatında](/docs/references/terminology#compact-array-format)
gönderilen bir dizisidir. Dizinin öneki uzunluğunu belirtir. Dizideki her öğe
bir
[`CompiledInstruction`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/program/src/instruction.rs#L22)
yapısıdır ve aşağıdaki bilgileri içerir:

<WithMentions>

1. [`program_id_index`](mention:program-id-index):
   [`account_keys`](#account-addresses) dizisindeki bir adrese işaret eden bir
   indeks. Bu değer, talimatı işleyen programın adresini gösterir.
2. [`accounts`](mention:account-indexes): `account_keys` dizisindeki adreslere
   işaret eden indekslerin bir dizisi. Her indeks, bu talimat için gerekli bir
   hesabın adresine işaret eder.
3. [`data`](mention:instruction-data): Programda hangi talimatın çağrılacağını
   belirten bir bayt dizisi. Ayrıca talimat tarafından gereken ek verileri de
   içerir. (Örneğin, fonksiyon argümanları)

```rust title="CompiledInstruction"
pub struct CompiledInstruction {
    /// Index into the transaction keys array indicating the program account that executes this instruction.
    // !mention program-id-index
    pub program_id_index: u8,
    /// Ordered indices into the transaction keys array indicating which accounts to pass to the program.
    #[serde(with = "short_vec")]
    // !mention account-indexes
    pub accounts: Vec<u8>,
    /// The program input data.
    #[serde(with = "short_vec")]
    // !mention instruction-data
    pub data: Vec<u8>,
}
```

</WithMentions>

![Talimatların kompakt dizisi](/assets/docs/core/transactions/compact_array_of_ixs.png)

## Örnek işlem yapısı

Aşağıdaki örnek, tek bir SOL transfer talimatı içeren bir işlemin yapısını
göstermektedir.

<CodeTabs storage="sol-transfer" flags="r">

```ts !! title="Kit"
import {
  createSolanaRpc,
  generateKeyPairSigner,
  lamports,
  createTransactionMessage,
  setTransactionMessageFeePayerSigner,
  setTransactionMessageLifetimeUsingBlockhash,
  appendTransactionMessageInstructions,
  pipe,
  signTransactionMessageWithSigners,
  getCompiledTransactionMessageDecoder
} from "@solana/kit";
import { getTransferSolInstruction } from "@solana-program/system";

const rpc = createSolanaRpc("http://localhost:8899");
const { value: latestBlockhash } = await rpc.getLatestBlockhash().send();

// Generate sender and recipient keypairs
const sender = await generateKeyPairSigner();
const recipient = await generateKeyPairSigner();

// Define the amount to transfer
const LAMPORTS_PER_SOL = 1_000_000_000n;
const transferAmount = lamports(LAMPORTS_PER_SOL / 100n); // 0.01 SOL

// Create a transfer instruction for transferring SOL from sender to recipient
const transferInstruction = getTransferSolInstruction({
  source: sender,
  destination: recipient.address,
  amount: transferAmount
});

// Create transaction message
const transactionMessage = pipe(
  createTransactionMessage({ version: 0 }),
  (tx) => setTransactionMessageFeePayerSigner(sender, tx),
  (tx) => setTransactionMessageLifetimeUsingBlockhash(latestBlockhash, tx),
  (tx) => appendTransactionMessageInstructions([transferInstruction], tx)
);

const signedTransaction =
  await signTransactionMessageWithSigners(transactionMessage);

// Decode the messageBytes
const compiledTransactionMessage =
  getCompiledTransactionMessageDecoder().decode(signedTransaction.messageBytes);

console.log(JSON.stringify(compiledTransactionMessage, null, 2));
```

```ts !! title="Legacy"
import {
  LAMPORTS_PER_SOL,
  SystemProgram,
  Transaction,
  Keypair,
  Connection
} from "@solana/web3.js";

const connection = new Connection("http://localhost:8899", "confirmed");
const { blockhash, lastValidBlockHeight } =
  await connection.getLatestBlockhash();

// Generate sender and recipient keypairs
const sender = Keypair.generate();
const recipient = new Keypair();

// Define the amount to transfer
const transferAmount = 0.01; // 0.01 SOL

// Create a transfer instruction for transferring SOL from sender to recipient
const transferInstruction = SystemProgram.transfer({
  fromPubkey: sender.publicKey,
  toPubkey: recipient.publicKey,
  lamports: transferAmount * LAMPORTS_PER_SOL // Convert transferAmount to lamports
});

const transaction = new Transaction({
  blockhash,
  lastValidBlockHeight,
  feePayer: sender.publicKey
}).add(transferInstruction);
transaction.sign(sender);

const compiledMessage = transaction.compileMessage();
console.log(JSON.stringify(compiledMessage, null, 2));
```

```rs !! title="Rust"
use anyhow::Result;
use solana_client::nonblocking::rpc_client::RpcClient;
use solana_commitment_config::CommitmentConfig;
use solana_sdk::{
    native_token::LAMPORTS_PER_SOL, signature::Signer, signer::keypair::Keypair,
    transaction::Transaction,
};
use solana_system_interface::instruction::transfer;

#[tokio::main]
async fn main() -> Result<()> {
    let connection = RpcClient::new_with_commitment(
        "http://localhost:8899".to_string(),
        CommitmentConfig::confirmed(),
    );

    // Fetch the latest blockhash and last valid block height
    let blockhash = connection.get_latest_blockhash().await?;

    // Generate sender and recipient keypairs
    let sender = Keypair::new();
    let recipient = Keypair::new();

    // Create a transfer instruction for transferring SOL from sender to recipient
    let transfer_instruction = transfer(
        &sender.pubkey(),
        &recipient.pubkey(),
        LAMPORTS_PER_SOL / 100, // 0.01 SOL
    );

    let mut transaction =
        Transaction::new_with_payer(&[transfer_instruction], Some(&sender.pubkey()));
    transaction.sign(&[&sender], blockhash);

    println!("{:#?}", transaction);

    Ok(())
}
```

</CodeTabs>

<WithMentions>
Aşağıdaki kod, önceki kod parçacıklarından elde edilen çıktıyı göstermektedir.
Format SDK'lar arasında farklılık gösterir,
ancak her talimatın aynı gerekli bilgileri içerdiğine dikkat edin.

<CodeTabs storage="sol-transfer">

```json !! title="Kit"
{
  "version": 0,
  // !mention header
  "header": {
    "numSignerAccounts": 1,
    "numReadonlySignerAccounts": 0,
    "numReadonlyNonSignerAccounts": 1
  },
  // !mention account_keys
  "staticAccounts": [
    "HoCy8p5xxDDYTYWEbQZasEjVNM5rxvidx8AfyqA4ywBa",
    "5T388jBjovy7d8mQ3emHxMDTbUF8b7nWvAnSiP3EAdFL",
    "11111111111111111111111111111111"
  ],
  // !mention recent_blockhash
  "lifetimeToken": "EGCWPUEXhqHJWYBfDirq3mHZb4qDpATmYqBZMBy9TBC1",
  // !mention instructions
  "instructions": [
    {
      "programAddressIndex": 2,
      "accountIndices": [0, 1],
      "data": {
        "0": 2,
        "1": 0,
        "2": 0,
        "3": 0,
        "4": 128,
        "5": 150,
        "6": 152,
        "7": 0,
        "8": 0,
        "9": 0,
        "10": 0,
        "11": 0
      }
    }
  ]
}
```

```json !! title="Legacy"
{
  // !mention header
  "header": {
    "numRequiredSignatures": 1,
    "numReadonlySignedAccounts": 0,
    "numReadonlyUnsignedAccounts": 1
  },
  // !mention account_keys
  "accountKeys": [
    "EPLUagqZZAuAtJ5LSbK7eeXjqeTdesd4q8WhoqVrfG3g",
    "9Txf5pi5jzm7FydFAsQafk7xn5wY9yN2UNm5LW15qvcK",
    "11111111111111111111111111111111"
  ],
  "recentBlockhash": "2qYPgehzMKXcMt4Ku1tKAk9DACKUbtYEY9EUEN42cseT",
  // !mention instructions
  "instructions": [
    {
      "programIdIndex": 2,
      "accounts": [0, 1],
      "data": "3Bxs4NN8M2Yn4TLb"
    }
  ],
  "indexToProgramIds": {}
}
```

```json !! title="Rust"
{
  "signatures": [
    "2fPXZtQGWWj6suxfc55FBQiexS8hEhNELqasSL5DRYa1RB1GChHz86Cyy8ukiVwA6qbq91P4cY1FuvTuYtmTHmJP"
  ],
  "message": {
    // !mention header
    "header": {
      "num_required_signatures": 1,
      "num_readonly_signed_accounts": 0,
      "num_readonly_unsigned_accounts": 1
    },
    "account_keys": [
      "9CpbtdXfUTgLMJL8DEAeEm8thERJPwDuruohjvUuzY7m",
      "6jELNgS8Q35sF4QZCvwgyKGaKrbcm8P5QcNWUyAb5ekJ",
      "11111111111111111111111111111111"
    ],
    "recent_blockhash": "3P7CVQ9nwXx4B37MvBzghzbcM9K9p5xo7ivDE8W78dCi",
    // !mention instructions
    "instructions": [
      {
        "program_id_index": 2,
        "accounts": [0, 1],
        "data": [2, 0, 0, 0, 128, 150, 152, 0, 0, 0, 0, 0]
      }
    ]
  }
}
```

</CodeTabs>
</WithMentions>

Bir işlem gönderildikten sonra, işlem imzasını ve
[getTransaction](/docs/rpc/http/gettransaction) RPC yöntemini kullanarak
ayrıntılarını alabilirsiniz. Yanıt, aşağıdaki kod parçasına benzer bir yapıya
sahip olacaktır.

<Callout>
  İşlemi [Solana Explorer](https://explorer.solana.com) kullanarak da
  bulabilirsiniz.
</Callout>

```json title="Transaction Data"
{
  "blockTime": 1745196488,
  "meta": {
    "computeUnitsConsumed": 150,
    "err": null,
    "fee": 5000,
    "innerInstructions": [],
    "loadedAddresses": {
      "readonly": [],
      "writable": []
    },
    "logMessages": [
      "Program 11111111111111111111111111111111 invoke [1]",
      "Program 11111111111111111111111111111111 success"
    ],
    "postBalances": [989995000, 10000000, 1],
    "postTokenBalances": [],
    "preBalances": [1000000000, 0, 1],
    "preTokenBalances": [],
    "rewards": [],
    "status": {
      "Ok": null
    }
  },
  "slot": 13049,
  "transaction": {
    "message": {
      "header": {
        "numReadonlySignedAccounts": 0,
        "numReadonlyUnsignedAccounts": 1,
        "numRequiredSignatures": 1
      },
      "accountKeys": [
        "8PLdpLxkuv9Nt8w3XcGXvNa663LXDjSrSNon4EK7QSjQ",
        "7GLg7bqgLBv1HVWXKgWAm6YoPf1LoWnyWGABbgk487Ma",
        "11111111111111111111111111111111"
      ],
      "recentBlockhash": "7ZCxc2SDhzV2bYgEQqdxTpweYJkpwshVSDtXuY7uPtjf",
      "instructions": [
        {
          "accounts": [0, 1],
          "data": "3Bxs4NN8M2Yn4TLb",
          "programIdIndex": 2,
          "stackHeight": null
        }
      ],
      "indexToProgramIds": {}
    },
    "signatures": [
      "3jUKrQp1UGq5ih6FTDUUt2kkqUfoG2o4kY5T1DoVHK2tXXDLdxJSXzuJGY4JPoRivgbi45U2bc7LZfMa6C4R3szX"
    ]
  },
  "version": "legacy"
}
```
