---
title: Distribuzione dei programmi
description:
  Guida completa per costruire, distribuire e gestire programmi Solana
  utilizzando la CLI di Solana.
---

Questa sezione illustra il processo base di distribuzione di un programma Solana
utilizzando la CLI di Solana.

## Riferimento comandi CLI

| Attività                              | Comando                                                                                       |
| ------------------------------------- | --------------------------------------------------------------------------------------------- |
| Compilare il programma                | `cargo build-sbf`                                                                             |
| Distribuire un nuovo programma        | `solana program deploy <path_to_program.so>`                                                  |
| Aggiornare un programma esistente     | `solana program deploy <path_to_program.so>` (uguale alla distribuzione)                      |
| Mostrare info del programma           | `solana program show <program-id>`                                                            |
| Trasferire autorità del programma     | `solana program set-upgrade-authority <program-id> --new-upgrade-authority <path_to_keypair>` |
| Rendere il programma immutabile       | `solana program set-upgrade-authority <program-id> --final`                                   |
| Chiudere il programma                 | `solana program close <program-id> --bypass-warning`                                          |
| Controllare il saldo del wallet       | `solana balance`                                                                              |
| Richiedere airdrop (devnet/localhost) | `solana airdrop 2`                                                                            |

## Concetti chiave

Prima di iniziare, chiariamo alcuni termini:

- **Program ID**: L'indirizzo on-chain del tuo programma. Gli utenti
  interagiscono con il tuo programma facendo riferimento al Program ID.
- **Program Account**: L'account on-chain che memorizza i metadati del tuo
  programma. L'indirizzo del program account è il Program ID. Il program account
  memorizza anche l'indirizzo del ProgramData Account.
- **ProgramData Account**: L'account on-chain che memorizza il codice eseguibile
  del tuo programma distribuito.
- **Program Authority**: L'account che ha il permesso di aggiornare o chiudere
  il programma. Per impostazione predefinita, questo è il tuo wallet CLI.

## Prerequisiti

<Steps>

<Step>

### Installare la CLI di Solana

Prima, [installa la CLI di Solana](/docs/intro/installation).

</Step>

<Step>

### Configurare il wallet

Dopo l'installazione, crea un wallet con keypair locale. L'indirizzo di questo
wallet viene impostato come autorità predefinita del programma durante la
distribuzione dei programmi:

```terminal
$ solana-keygen new
```

Questo crea un keypair in `~/.config/solana/id.json` per impostazione
predefinita.

</Step>

<Step>

### Configurazione del cluster

Scegli su quale cluster Solana effettuare il deployment. Usa il comando
`solana config get` per verificare la tua configurazione attuale:

```terminal
$ solana config get
Config File: ~/.config/solana/cli/config.yml
RPC URL: http://localhost:8899
WebSocket URL: ws://localhost:8900/ (computed)
Keypair Path: ~/.config/solana/id.json
Commitment: confirmed
```

Passa da un cluster all'altro secondo necessità:

```terminal
$ solana config set --url mainnet-beta
$ solana config set --url devnet
$ solana config set --url localhost
$ solana config set --url testnet
$ solana config set --url "https://your-rpc-url.com"
```

</Step>

<Step>

### Finanzia il wallet

Avrai bisogno di SOL per pagare i deployment dei programmi. La quantità dipende
dalla dimensione del tuo programma.

Per devnet o localhost, finanzia il tuo wallet usando il comando
`solana airdrop`:

```terminal
$ solana airdrop 2
Requesting airdrop of 2 SOL
Signature: 5zQKxvRdgJDA8fRGPdKfGxRLnLpwmNnMXGYxfBqFSUPqc5BTmFPrTG8vnC4HvKDVY8zQ8aQxZxcEE7WFpGhZGVAA
2 SOL
```

Controlla il saldo del tuo wallet:

```terminal
$ solana balance
2 SOL
```

</Step>

</Steps>

## Operazioni di base

### Compilazione del programma

Per compilare un programma, usa il comando `cargo build-sbf`:

```terminal
$ cargo build-sbf
```

<ScrollyCoding>

## !!steps Programma di esempio

Ecco un programma Solana minimale che stampa "Hello, Solana!" nei log del
programma.

<CodePlaceholder title="src/lib.rs" />

```rs !! title="src/lib.rs"
use solana_program::{
    account_info::AccountInfo, entrypoint, entrypoint::ProgramResult, msg, pubkey::Pubkey,
};

entrypoint!(process_instruction);

pub fn process_instruction(
    _program_id: &Pubkey,
    _accounts: &[AccountInfo],
    _instruction_data: &[u8],
) -> ProgramResult {
    msg!("Hello, Solana!");
    Ok(())
}
```

```toml !! title="Cargo.toml"
[package]
name = "hello_world"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib", "lib"]

[dependencies]
solana-program = "2.2.0"
```

## !!steps Output di compilazione

Compila il tuo programma usando il comando `cargo build-sbf`:

```terminal
$ cargo build-sbf
```

Questo crea due file importanti in `target/deploy/`:

1. `hello_world-keypair.json`: Un file keypair la cui chiave pubblica sarà
   utilizzata come tuo Program ID
2. `hello_world.so`: L'eseguibile del programma compilato

```json !! title="target/deploy/hello_world-keypair.json"
[
  203, 253, 43, 62, 165, 111, 94, 222, 105, 225, 218, 85, 143, 9, 114, 96, 243,
  181, 114, 89, 72, 230, 124, 85, 59, 165, 198, 23, 240, 212, 23, 154, 229, 241,
  153, 61, 153, 105, 79, 204, 193, 163, 33, 65, 82, 183, 49, 240, 224, 137, 248,
  24, 128, 25, 192, 197, 118, 235, 239, 67, 85, 156, 219, 231
]
```

```txt !! title="target/deploy/hello_world.so"
[binary executable file]
```

</ScrollyCoding>

### Controlla dimensione e costo del programma

La distribuzione di un programma richiede che del SOL venga allocato all'account
del programma in base alla dimensione del programma. Programmi più grandi
costano più SOL per essere distribuiti.

Controlla la dimensione del tuo programma:

```terminal
$ wc -c < ./target/deploy/hello_world.so
18504
```

Calcola il SOL necessario per questa dimensione (in byte):

```terminal
$ solana rent 18504
Rent-exempt minimum: 0.12967872 SOL
```

<Callout type="info">
  Avrai bisogno di un po' più SOL di quanto mostrato per coprire le commissioni
  di transazione per la distribuzione.
</Callout>

### Distribuisci il programma

Usa il comando `solana program deploy` per distribuire il tuo programma:

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 2BYwsqRP7ZwBNQvJp3S8bphTJ4zKW5JBPVMqCTE5KyLkP8xHzAyUEeC4LdTgjJdGBKHWNCkRF8Mf1T1WkLFyEu8W
```

L'**ID del programma** mostrato è l'indirizzo permanente del tuo programma sulla
rete.

<Callout>

Per distribuire con un ID programma specifico (invece di quello generato
automaticamente), usa:

```terminal
$ solana program deploy ./target/deploy/hello_world.so --program-id ./custom-keypair.json
```

Puoi generare nuovi keypair usando il comando `solana-keygen`:

```terminal
$ solana-keygen new -o ./custom-keypair.json
```

</Callout>

### Aggiornamento del programma

Aggiorna il tuo programma utilizzando lo stesso comando `solana program deploy`:

1. Apporta modifiche al codice del tuo programma
2. Ricompila il tuo programma: `cargo build-sbf`
3. Distribuisci l'aggiornamento:

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 3zKnXDfEm1R8hVcEmTnNFYUaFjVVbLJrKdFj5hBMXoBRfz8xGyDhCYgKr9YY5KxKYPEUQQVfwEPNz9hQGvYhLNBJ
```

<Callout type="info">

Se il tuo programma aggiornato richiede più spazio (byte) rispetto a quello
attualmente allocato, la distribuzione estenderà automaticamente il program
account. Questo accade quando il tuo nuovo programma è più grande della versione
precedente. Il program account necessita di byte aggiuntivi per memorizzare il
nuovo programma. La CLI calcolerà automaticamente il SOL necessario e lo
detrarrà dal tuo portafoglio.

Puoi anche estendere manualmente un programma per allocare più byte:

```terminal
$ solana program extend 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE 1000
Extended Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE by 1000 bytes
```

</Callout>

## Gestione del programma

Una volta che il tuo programma è stato distribuito, ci sono diversi comandi
comuni per gestire il program account.

### Visualizzazione dei metadati del programma

Per controllare i metadati del tuo programma, usa il comando
`solana program show`:

```terminal
$ solana program show 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
```

<WithNotes>

Esempio di output:

```txt
$ solana program show 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Program Id/] program-id
Program Id: 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Owner/] owner
Owner: BPFLoaderUpgradeab1e11111111111111111111111
# !tooltip[/ProgramData Address/] program-data-address
ProgramData Address: Gqn7YQVCP8NtYV1qkEqR4Udhj8EJ3fkikvS7HskCNQ7c
# !tooltip[/Authority/] authority
Authority: 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1
# !tooltip[/Last Deployed In Slot/] last-deployed-in-slot
Last Deployed In Slot: 6573
# !tooltip[/Data Length/] data-length
Data Length: 18504 (0x4848) bytes
# !tooltip[/Balance/] balance
Balance: 0.12999192 SOL
```

### !program-id

Il Program ID è l'indirizzo on-chain del tuo program account. Gli utenti e altri
programmi invocano il tuo programma facendo riferimento a questo ID nelle loro
transazioni.

### !owner

L'Owner identifica quale loader è stato utilizzato per distribuire questo
programma. Per la maggior parte dei programmi, questo sarà il BPF Upgradeable
Loader.

### !program-data-address

Il ProgramData Address punta all'account separato che memorizza il codice
eseguibile del tuo programma.

### !authority

L'Authority è l'account che ha il permesso di aggiornare o chiudere questo
programma. Solo l'authority può implementare aggiornamenti o chiudere il
programma per recuperare il SOL allocato al programma.

### !last-deployed-in-slot

L'indicatore Last Deployed In Slot mostra quando questo programma è stato
aggiornato l'ultima volta.

### !data-length

Il Data Length mostra il totale dei byte allocati a questo programma. Questo
spazio può ospitare futuri aggiornamenti che potrebbero essere più grandi delle
dimensioni attuali del programma.

### !balance

Il Balance visualizza il SOL allocato all'account del programma per memorizzare
i suoi dati.

</WithNotes>

### Trasferire l'autorità del programma

Per trasferire l'autorità del programma a un account diverso, usa il comando
`solana program set-upgrade-authority`:

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --new-upgrade-authority ./new-authority-keypair.json
```

<Callout type="warn">
  Dopo aver trasferito l'autorità del programma, non potrai più aggiornare il
  programma a meno che tu non abbia accesso al nuovo keypair dell'autorità.
</Callout>

### Rendere il tuo programma immutabile

Per rendere il tuo programma immutabile, usa il comando
`solana program set-upgrade-authority` con il flag `--final` per rimuovere
l'autorità del programma:

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --final
Account Type: Program
Authority: none
```

<Callout type="warn">
  Una volta che un programma è immutabile, non potrà mai più essere aggiornato o
  chiuso.
</Callout>

### Chiudere il tuo programma

Per chiudere il tuo programma e recuperare il SOL allocato all'account del
programma, usa il comando `solana program close`:

```terminal
$ solana program close 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --bypass-warning
Closed Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE, 0.12999192 SOL reclaimed
```

<Callout type="warn">
  Una volta chiuso, l'ID del programma non può essere riutilizzato. Non puoi
  implementare un nuovo programma allo stesso indirizzo.
</Callout>

## Comandi di utilità

### Elencare tutti i programmi

Visualizza tutti i programmi in cui il tuo wallet attuale è l'autorità:

```terminal
$ solana program show --programs
```

Esempio di output:

```txt
Program Id                                       | Slot       | Authority                                      | Balance
-------------------------------------------------|------------|------------------------------------------------|-------------
7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE     | 249885434  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.12999192
3KSGCk4m5hqJkTjPHBXUCPcqMwJnK3VmkqEsFUKKGJPK     | 249883212  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.28654328
```

### Scaricare un programma distribuito

Per scaricare un programma distribuito, usa il comando `solana program dump`:

```terminal
$ solana program dump 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE ./downloaded_program.so
Wrote program to ./downloaded_program.so
```

## Opzioni avanzate

### Flag di distribuzione

Quando la rete Solana è congestionata, usa questi flag per facilitare la
distribuzione del programma.

Esempio di utilizzo:

```terminal
$ solana program deploy ./target/deploy/hello_world.so \
    --with-compute-unit-price 10000 \
    --max-sign-attempts 10 \
    --use-rpc
```

Spiegazione delle opzioni:

- **`--with-compute-unit-price`**: Imposta la commissione prioritaria in
  micro-lamports (0.000001 SOL) per unità di calcolo. Controlla
  l'[API per commissioni prioritarie di Helius](https://docs.helius.dev/guides/priority-fee-api)
  per le tariffe attuali. Una commissione prioritaria è una commissione
  aggiuntiva pagata al leader attuale per dare priorità alla tua transazione.
- **`--max-sign-attempts`**: Numero di tentativi con un nuovo blockhash se le
  transazioni scadono. (Predefinito: 5)
- **`--use-rpc`**: Invia transazioni all'RPC configurato. Questo flag richiede
  una connessione RPC
  [ponderata in base allo stake](/developers/guides/advanced/stake-weighted-qos)
  da provider come [Triton](https://triton.one/) o
  [Helius](https://www.helius.dev/).
