---
title: البرامج
description:
  تعرف على برامج سولانا (العقود الذكية) وكيفية تطويرها باستخدام Rust أو إطار عمل
  Anchor. افهم نشر البرامج وترقياتها والتحقق منها على شبكة سولانا.
h1: البرامج
---

على سولانا، يُطلق على العقد الذكي اسم برنامج. البرنامج هو
[حساب](/docs/core/accounts#program-account) عديم الحالة يحتوي على كود قابل
للتنفيذ. يتم تنظيم هذا الكود في وظائف تسمى تعليمات. يتفاعل المستخدمون مع
البرنامج عن طريق إرسال [معاملة](/docs/core/transactions) تحتوي على تعليمة واحدة
أو أكثر من [التعليمات](/docs/core/instructions). يمكن أن تتضمن المعاملة تعليمات
من برامج متعددة.

عند نشر برنامج، تستخدم سولانا [LLVM](https://llvm.org/) لتجميعه إلى تنسيق قابل
للتنفيذ والربط
([ELF](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format)). يحتوي ملف
ELF على الشفرة الثنائية للبرنامج بتنسيق بايت كود سولانا (sBPF) ويتم حفظه على
السلسلة في حساب قابل للتنفيذ.

<Callout>
  sBPF هو إصدار سولانا المخصص من بايت كود
  [eBPF](https://en.wikipedia.org/wiki/EBPF).
</Callout>

## كتابة البرامج

تُكتب غالبية البرامج بلغة
[Rust](https://rust-book.cs.brown.edu/title-page.html)، مع نهجين شائعين للتطوير:

- [Anchor](https://www.anchor-lang.com/docs): Anchor هو إطار عمل مصمم للتطوير
  السريع والسهل على سولانا. يستخدم
  [وحدات ماكرو Rust](https://doc.rust-lang.org/book/ch20-05-macros.html) لتقليل
  الكود المتكرر—مما يجعله رائعًا للمبتدئين.
- [Native Rust](/docs/programs/rust): كتابة البرامج بلغة Rust دون الاستفادة من
  أي أطر عمل. يوفر هذا النهج مرونة أكبر ولكنه يأتي مع زيادة في التعقيد.

## تحديث البرامج

[لتعديل](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/bpf_loader/src/lib.rs#L704)
برنامج موجود، يجب تعيين حساب كـ
[سلطة الترقية](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/bpf_loader/src/lib.rs#L894).
(عادةً نفس الحساب الذي [نشر البرنامج](/docs/programs/deploying) في الأصل.) إذا
تم إلغاء سلطة الترقية وتعيينها إلى `None`، فلن يمكن تحديث البرنامج بعد ذلك.

## التحقق من البرامج

تدعم سولانا [عمليات البناء القابلة للتحقق](/docs/programs/verified-builds)،
والتي تسمح للمستخدمين بالتحقق مما إذا كان كود البرنامج على السلسلة يتطابق مع كود
المصدر العام الخاص به. يوفر إطار عمل Anchor
[دعمًا مدمجًا](https://www.anchor-lang.com/docs/verifiable-builds) لإنشاء بناء
قابل للتحقق.

للتحقق مما إذا كان البرنامج الموجود تم التحقق منه، ابحث عن معرف البرنامج الخاص
به على
[مستكشف سولانا](https://explorer.solana.com/address/PhoeNiXZ8ByJGLkxNfZRnkUfjvmuYqLR89jjFHGqdXY).
بدلاً من ذلك، يمكنك استخدام
[واجهة سطر أوامر البناء القابل للتحقق من سولانا](https://github.com/Ellipsis-Labs/solana-verifiable-build)
من Ellipsis Labs، للتحقق بشكل مستقل من البرامج على السلسلة.

## البرامج المدمجة

### System Program

System Program هو الحساب الوحيد الذي يمكنه إنشاء حسابات جديدة. بشكل افتراضي،
جميع الحسابات الجديدة مملوكة لـ
[System Program](https://github.com/anza-xyz/agave/tree/v2.1.13/programs/system/src)،
على الرغم من أن العديد منها يتم تعيين مالك جديد لها عند الإنشاء. يقوم System
Program بأداء الوظائف الرئيسية التالية:

| الوظيفة                                                                                                             | الوصف                                                                                                                                                                                      |
| ------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [إنشاء حساب جديد](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/system/src/system_processor.rs#L146)      | فقط System Program يمكنه إنشاء حسابات جديدة.                                                                                                                                               |
| [تخصيص المساحة](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/system/src/system_processor.rs#L71)         | يحدد السعة بالبايت لحقل البيانات لكل حساب.                                                                                                                                                 |
| [تعيين ملكية البرنامج](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/system/src/system_processor.rs#L113) | بمجرد أن ينشئ System Program حسابًا، يمكنه إعادة تعيين مالك البرنامج المحدد إلى حساب برنامج مختلف. هكذا تأخذ البرامج المخصصة ملكية الحسابات الجديدة التي تم إنشاؤها بواسطة System Program. |
| [تحويل SOL](https://github.com/anza-xyz/agave/blob/v2.1.13/programs/system/src/system_processor.rs#L215)            | ينقل لامبورتس (SOL) من حسابات النظام إلى حسابات أخرى.                                                                                                                                      |

عنوان برنامج النظام هو `11111111111111111111111111111111`.

### برامج التحميل

كل برنامج مملوك لبرنامج آخر - وهو المحمّل الخاص به. تُستخدم المحمّلات لنشر
البرامج أو إعادة نشرها أو ترقيتها أو إغلاقها. كما تُستخدم لإنهاء البرنامج ونقل
سلطة البرنامج.

<Callout>يشار إلى برامج التحميل أحيانًا باسم 'BPF Loaders'.</Callout>

هناك حاليًا خمسة برامج تحميل، كما هو موضح في الجدول أدناه.

| المحمّل | معرف البرنامج                                 | ملاحظات                                                                                     | رابط التعليمات                                                                                                                               |
| ------- | --------------------------------------------- | ------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| native  | `NativeLoader1111111111111111111111111111111` | يمتلك المحمّلات الأربعة الأخرى                                                              | —                                                                                                                                            |
| v1      | `BPFLoader1111111111111111111111111111111111` | تعليمات الإدارة معطلة، لكن البرامج لا تزال تعمل                                             | —                                                                                                                                            |
| v2      | `BPFLoader2111111111111111111111111111111111` | تعليمات الإدارة معطلة، لكن البرامج لا تزال تعمل                                             | [التعليمات](https://docs.rs/solana-loader-v2-interface/latest/solana_loader_v2_interface/enum.LoaderInstruction.html)                        |
| v3      | `BPFLoaderUpgradeab1e11111111111111111111111` | يمكن تحديث البرامج بعد النشر. يتم تخزين البرنامج القابل للتنفيذ في حساب بيانات برنامج منفصل | [التعليمات](https://docs.rs/solana-loader-v3-interface/latest/solana_loader_v3_interface/instruction/enum.UpgradeableLoaderInstruction.html) |
| v4      | `LoaderV411111111111111111111111111111111111` | قيد التطوير (لم يتم إصداره)                                                                 | [التعليمات](https://docs.rs/solana-loader-v4-interface/latest/solana_loader_v4_interface/instruction/enum.LoaderV4Instruction.html)          |

يمكن تعديل البرامج المنشورة باستخدام loader-v3 أو loader-v4 بعد النشر، وفقًا لما
تحدده سلطة الترقية الخاصة بها.

<Callout>
  عند نشر برنامج جديد، سيتم استخدام أحدث إصدار من المحمّل افتراضيًا.
</Callout>

### البرامج المُعدّة مسبقًا

بالإضافة إلى برامج المحمّل، توفر سولانا البرامج المُعدّة مسبقًا التالية.

#### التحقق من توقيع ed25519

يُستخدم برنامج ed25519 للتحقق من توقيع واحد أو أكثر من توقيعات ed25519.

| البرنامج       | معرف البرنامج                                 | الوصف                                                      | التعليمات                                                                                    |
| -------------- | --------------------------------------------- | ---------------------------------------------------------- | -------------------------------------------------------------------------------------------- |
| برنامج Ed25519 | `Ed25519SigVerify111111111111111111111111111` | يتحقق من توقيعات ed25519. إذا فشل أي توقيع، يتم إرجاع خطأ. | [التعليمات](https://docs.rs/solana-ed25519-program/latest/solana_ed25519_program/index.html) |

يعالج برنامج ed25519 تعليمة واحدة. يحتوي `u8` الأول من التعليمة على عدد
التوقيعات التي سيتم التحقق منها، متبوعًا ببايت واحد للحشو. بعد ذلك، يتم تسلسل
البنية التالية، واحدة لكل توقيع سيتم التحقق منه.

```rs title="Ed25519SignatureOffsets"
struct Ed25519SignatureOffsets {
    signature_offset: u16,             // offset to ed25519 signature of 64 bytes
    signature_instruction_index: u16,  // instruction index to find signature
    public_key_offset: u16,            // offset to public key of 32 bytes
    public_key_instruction_index: u16, // instruction index to find public key
    message_data_offset: u16,          // offset to start of message data
    message_data_size: u16,            // size of message data
    message_instruction_index: u16,    // index of instruction data to get message data
}
```

```txt title="Signature verification pseudocode"
process_instruction() {
    for i in 0..count {
        // i'th index values referenced:
        instructions = &transaction.message().instructions
        instruction_index = ed25519_signature_instruction_index != u16::MAX ? ed25519_signature_instruction_index : current_instruction;
        signature = instructions[instruction_index].data[ed25519_signature_offset..ed25519_signature_offset + 64]
        instruction_index = ed25519_pubkey_instruction_index != u16::MAX ? ed25519_pubkey_instruction_index : current_instruction;
        pubkey = instructions[instruction_index].data[ed25519_pubkey_offset..ed25519_pubkey_offset + 32]
        instruction_index = ed25519_message_instruction_index != u16::MAX ? ed25519_message_instruction_index : current_instruction;
        message = instructions[instruction_index].data[ed25519_message_data_offset..ed25519_message_data_offset + ed25519_message_data_size]
        if pubkey.verify(signature, message) != Success {
            return Error
        }
    }
    return Success
}
```

#### التحقق من استعادة secp256k1

يُستخدم برنامج secp256k1 للتحقق من عمليات استعادة المفتاح العام لـ secp256k1.

| البرنامج         | معرف البرنامج                                 | الوصف                                                        | التعليمات                                                                                        |
| ---------------- | --------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------ |
| برنامج Secp256k1 | `KeccakSecp256k11111111111111111111111111111` | يتحقق من عمليات استرداد المفتاح العام secp256k1 (ecrecover). | [التعليمات](https://docs.rs/solana-secp256k1-program/latest/solana_secp256k1_program/index.html) |

يعالج برنامج secp256k1 تعليمة واحدة. يحتوي البايت الأول من التعليمة على عدد
المفاتيح العامة المراد التحقق منها. بعد ذلك، يتم إنشاء البنية التالية مرة واحدة
لكل مفتاح عام، ثم يتم تسلسلها وإضافتها إلى بيانات التعليمة.

```rs title="Secp256k1SignatureOffsets"
struct Secp256k1SignatureOffsets {
    secp_signature_offset: u16,            // offset to [signature,recovery_id] of 64+1 bytes
    secp_signature_instruction_index: u8,  // instruction index to find signature
    secp_pubkey_offset: u16,               // offset to ethereum_address pubkey of 20 bytes
    secp_pubkey_instruction_index: u8,     // instruction index to find pubkey
    secp_message_data_offset: u16,         // offset to start of message data
    secp_message_data_size: u16,           // size of message data
    secp_message_instruction_index: u8,    // instruction index to find message data
}
```

```txt title="Recovery verification pseudocode"
process_instruction() {
  for i in 0..count {
      // i'th index values referenced:
      instructions = &transaction.message().instructions
      signature = instructions[secp_signature_instruction_index].data[secp_signature_offset..secp_signature_offset + 64]
      recovery_id = instructions[secp_signature_instruction_index].data[secp_signature_offset + 64]
      ref_eth_pubkey = instructions[secp_pubkey_instruction_index].data[secp_pubkey_offset..secp_pubkey_offset + 20]
      message_hash = keccak256(instructions[secp_message_instruction_index].data[secp_message_data_offset..secp_message_data_offset + secp_message_data_size])
      pubkey = ecrecover(signature, recovery_id, message_hash)
      eth_pubkey = keccak256(pubkey[1..])[12..]
      if eth_pubkey != ref_eth_pubkey {
          return Error
      }
  }
  return Success
}
```

هذا يسمح للمستخدم بتحديد أي بيانات تعليمات في المعاملة لبيانات التوقيع والرسالة.
من خلال تحديد متغير نظام تعليمات خاص، يمكن للمستخدم أيضًا استلام بيانات من
المعاملة نفسها.

ستحسب تكلفة المعاملة عدد التوقيعات المراد التحقق منها مضروبًا في مضاعف تكلفة
التحقق من التوقيع.

يُستخدم برنامج secp256r1 للتحقق من ما يصل إلى 8 توقيعات secp256r1.

| البرنامج         | معرف البرنامج                                 | الوصف                                                                                                  | التعليمات                                                                                      |
| ---------------- | --------------------------------------------- | ------------------------------------------------------------------------------------------------------ | ---------------------------------------------------------------------------------------------- |
| برنامج Secp256r1 | `Secp256r1SigVerify1111111111111111111111111` | يتحقق من ما يصل إلى 8 توقيعات secp256r1. يأخذ توقيعًا ومفتاحًا عامًا ورسالة. يرجع خطأ إذا فشل أي منها. | [التعليمات](https://docs.rs/solana-secp256r1-program/latest/solana_secp256r1_program/all.html) |

يعالج برنامج secp256r1 تعليمة واحدة. البايت الأول `u8` من التعليمة هو عدد
التوقيعات المراد التحقق منها، متبوعًا ببايت واحد للحشو. بعد ذلك، يتم إنشاء
البنية التالية لكل توقيع، ثم يتم تسلسلها وإضافتها إلى بيانات التعليمة.

```rs title="Secp256r1SignatureOffsets"
struct Secp256r1SignatureOffsets {
    signature_offset: u16,             // offset to compact secp256r1 signature of 64 bytes
    signature_instruction_index: u16,  // instruction index to find signature
    public_key_offset: u16,            // offset to compressed public key of 33 bytes
    public_key_instruction_index: u16, // instruction index to find public key
    message_data_offset: u16,          // offset to start of message data
    message_data_size: u16,            // size of message data
    message_instruction_index: u16,    // index of instruction data to get message data
}

```

<Callout>
  يتم فرض قيم S المنخفضة لجميع التوقيعات لتجنب قابلية التشكيل العرضي للتوقيع.
</Callout>

```txt title="Signature verification psuedocode"
process_instruction() {
    if data.len() < SIGNATURE_OFFSETS_START {
        return Error
    }

    num_signatures = data[0] as usize
    if num_signatures == 0 || num_signatures > 8 {
        return Error
    }

    expected_data_size = num_signatures * SIGNATURE_OFFSETS_SERIALIZED_SIZE + SIGNATURE_OFFSETS_START
    if data.len() < expected_data_size {
        return Error
    }

    for i in 0..num_signatures {
        offsets = parse_signature_offsets(data, i)

        signature = get_data_slice(data, instruction_datas, offsets.signature_instruction_index, offsets.signature_offset, SIGNATURE_SERIALIZED_SIZE)

        if s > half_curve_order {
            return Error
        }

        pubkey = get_data_slice(data, instruction_datas, offsets.public_key_instruction_index, offsets.public_key_offset, COMPRESSED_PUBKEY_SERIALIZED_SIZE)

        message = get_data_slice(data, instruction_datas, offsets.message_instruction_index, offsets.message_data_offset, offsets.message_data_size)

        if !verify_signature(signature, pubkey, message) {
            return Error
        }
    }

    return Success
}
```

### البرامج الأساسية

توفر البرامج في القائمة أدناه وظائف الشبكة الأساسية.

| البرنامج                   | معرف البرنامج                                 | الوصف                                                                                                                                                                                                                                                                                           | التعليمات                                                                                                                                             |
| -------------------------- | --------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| **النظام**                 | `11111111111111111111111111111111`            | إنشاء حسابات جديدة، تخصيص بيانات الحساب، تعيين الحسابات للبرامج المالكة، تحويل lamports من الحسابات المملوكة لبرنامج النظام، ودفع رسوم المعاملات                                                                                                                                                | [SystemInstruction](https://docs.rs/solana-program/latest/solana_program/system_instruction/enum.SystemInstruction.html)                              |
| **التصويت**                | `Vote111111111111111111111111111111111111111` | إنشاء وإدارة الحسابات التي تتتبع حالة تصويت المدقق والمكافآت                                                                                                                                                                                                                                    | [VoteInstruction](https://docs.rs/solana-vote-program/latest/solana_vote_program/vote_instruction/enum.VoteInstruction.html)                          |
| **الرهان**                 | `Stake11111111111111111111111111111111111111` | إنشاء وإدارة الحسابات التي تمثل الرهان والمكافآت للتفويضات إلى المدققين                                                                                                                                                                                                                         | [StakeInstruction](https://docs.rs/solana-sdk/latest/solana_sdk/stake/instruction/enum.StakeInstruction.html)                                         |
| **الإعدادات**              | `Config1111111111111111111111111111111111111` | إضافة بيانات الإعدادات إلى السلسلة، متبوعة بقائمة المفاتيح العامة المسموح لها بتعديلها. على عكس البرامج الأخرى، لا يحدد برنامج الإعدادات أي تعليمات فردية. لديه تعليمة ضمنية واحدة فقط: "تخزين". بيانات تعليماته هي مجموعة من المفاتيح التي تتحكم في الوصول إلى الحساب والبيانات المخزنة بداخله | [ConfigInstruction](https://docs.rs/solana-config-program/latest/solana_config_program/config_instruction/index.html)                                 |
| **ميزانية الحوسبة**        | `ComputeBudget111111111111111111111111111111` | تعيين حدود وحدات الحوسبة والأسعار للمعاملات، مما يسمح للمستخدمين بالتحكم في موارد الحوسبة ورسوم الأولوية                                                                                                                                                                                        | [ComputeBudgetInstruction](https://docs.rs/solana-compute-budget-interface/latest/solana_compute_budget_interface/enum.ComputeBudgetInstruction.html) |
| **جدول البحث عن العناوين** | `AddressLookupTab1e1111111111111111111111111` | إدارة جداول البحث عن العناوين، والتي تسمح للمعاملات بالإشارة إلى حسابات أكثر مما يمكن أن يتسع له قائمة حسابات المعاملة                                                                                                                                                                          | [ProgramInstruction](https://docs.rs/solana-sdk/latest/solana_sdk/address_lookup_table/instruction/enum.ProgramInstruction.html)                      |
| **إثبات ZK ElGamal**       | `ZkE1Gama1Proof11111111111111111111111111111` | يوفر التحقق من الإثبات بدون معرفة للبيانات المشفرة بـ ElGamal                                                                                                                                                                                                                                   | —                                                                                                                                                     |
