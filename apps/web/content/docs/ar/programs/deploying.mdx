---
title: نشر البرامج
description:
  دليل شامل لبناء ونشر وإدارة برامج سولانا باستخدام واجهة سطر أوامر سولانا.
---

يشرح هذا القسم العملية الأساسية لنشر برنامج سولانا باستخدام واجهة سطر أوامر
سولانا.

## مرجع أوامر واجهة سطر الأوامر

| المهمة                           | الأمر                                                                                         |
| -------------------------------- | --------------------------------------------------------------------------------------------- |
| بناء البرنامج                    | `cargo build-sbf`                                                                             |
| نشر برنامج جديد                  | `solana program deploy <path_to_program.so>`                                                  |
| تحديث برنامج موجود               | `solana program deploy <path_to_program.so>` (نفس أمر النشر)                                  |
| عرض معلومات البرنامج             | `solana program show <program-id>`                                                            |
| نقل صلاحية البرنامج              | `solana program set-upgrade-authority <program-id> --new-upgrade-authority <path_to_keypair>` |
| جعل البرنامج غير قابل للتعديل    | `solana program set-upgrade-authority <program-id> --final`                                   |
| إغلاق البرنامج                   | `solana program close <program-id> --bypass-warning`                                          |
| التحقق من رصيد المحفظة           | `solana balance`                                                                              |
| طلب إسقاط جوي (devnet/localhost) | `solana airdrop 2`                                                                            |

## المفاهيم الأساسية

قبل الغوص في التفاصيل، دعنا نوضح بعض المصطلحات:

- **معرّف البرنامج**: العنوان على السلسلة لبرنامجك. يتفاعل المستخدمون مع برنامجك
  من خلال الإشارة إلى معرّف البرنامج.
- **program account**: الحساب على السلسلة الذي يخزن البيانات الوصفية لبرنامجك.
  عنوان program account هو معرّف البرنامج. يخزن program account أيضًا عنوان
  programdata account.
- **programdata account**: الحساب على السلسلة الذي يخزن الشفرة التنفيذية
  المنشورة لبرنامجك.
- **صلاحية البرنامج**: الحساب الذي لديه إذن لتحديث أو إغلاق البرنامج. بشكل
  افتراضي، هذا هو محفظة واجهة سطر الأوامر الخاصة بك.

## المتطلبات الأساسية

<Steps>

<Step>

### تثبيت واجهة سطر أوامر سولانا

أولاً، [قم بتثبيت واجهة سطر أوامر سولانا](/docs/intro/installation).

</Step>

<Step>

### إعداد المحفظة

بعد التثبيت، قم بإنشاء محفظة زوج مفاتيح محلية. يتم تعيين عنوان هذه المحفظة
كصلاحية افتراضية للبرنامج عند نشر البرامج:

```terminal
$ solana-keygen new
```

هذا ينشئ زوج مفاتيح في `~/.config/solana/id.json` بشكل افتراضي.

</Step>

<Step>

### تكوين العنقود

اختر عنقود سولانا الذي تريد النشر إليه. استخدم الأمر `solana config get` للتحقق
من التكوين الحالي:

```terminal
$ solana config get
Config File: ~/.config/solana/cli/config.yml
RPC URL: http://localhost:8899
WebSocket URL: ws://localhost:8900/ (computed)
Keypair Path: ~/.config/solana/id.json
Commitment: confirmed
```

قم بالتبديل بين العناقيد حسب الحاجة:

```terminal
$ solana config set --url mainnet-beta
$ solana config set --url devnet
$ solana config set --url localhost
$ solana config set --url testnet
$ solana config set --url "https://your-rpc-url.com"
```

</Step>

<Step>

### تمويل المحفظة

ستحتاج إلى SOL لدفع تكاليف نشر البرنامج. يعتمد المبلغ على حجم البرنامج الخاص بك.

بالنسبة لشبكة devnet أو localhost، قم بتمويل محفظتك باستخدام الأمر
`solana airdrop`:

```terminal
$ solana airdrop 2
Requesting airdrop of 2 SOL
Signature: 5zQKxvRdgJDA8fRGPdKfGxRLnLpwmNnMXGYxfBqFSUPqc5BTmFPrTG8vnC4HvKDVY8zQ8aQxZxcEE7WFpGhZGVAA
2 SOL
```

تحقق من رصيد محفظتك:

```terminal
$ solana balance
2 SOL
```

</Step>

</Steps>

## العمليات الأساسية

### بناء البرنامج

لبناء برنامج، استخدم الأمر `cargo build-sbf`:

```terminal
$ cargo build-sbf
```

<ScrollyCoding>

## !!steps مثال على البرنامج

هنا برنامج سولانا بسيط يطبع "Hello, Solana!" في سجلات البرنامج.

<CodePlaceholder title="src/lib.rs" />

```rs !! title="src/lib.rs"
use solana_program::{
    account_info::AccountInfo, entrypoint, entrypoint::ProgramResult, msg, pubkey::Pubkey,
};

entrypoint!(process_instruction);

pub fn process_instruction(
    _program_id: &Pubkey,
    _accounts: &[AccountInfo],
    _instruction_data: &[u8],
) -> ProgramResult {
    msg!("Hello, Solana!");
    Ok(())
}
```

```toml !! title="Cargo.toml"
[package]
name = "hello_world"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib", "lib"]

[dependencies]
solana-program = "2.2.0"
```

## !!steps مخرجات البناء

قم ببناء برنامجك باستخدام أمر `cargo build-sbf`:

```terminal
$ cargo build-sbf
```

هذا ينشئ ملفين مهمين في `target/deploy/`:

1. `hello_world-keypair.json`: ملف keypair الذي سيتم استخدام المفتاح العام الخاص
   به كمعرف البرنامج (Program ID) الخاص بك
2. `hello_world.so`: ملف البرنامج التنفيذي المُجمّع

```json !! title="target/deploy/hello_world-keypair.json"
[
  203, 253, 43, 62, 165, 111, 94, 222, 105, 225, 218, 85, 143, 9, 114, 96, 243,
  181, 114, 89, 72, 230, 124, 85, 59, 165, 198, 23, 240, 212, 23, 154, 229, 241,
  153, 61, 153, 105, 79, 204, 193, 163, 33, 65, 82, 183, 49, 240, 224, 137, 248,
  24, 128, 25, 192, 197, 118, 235, 239, 67, 85, 156, 219, 231
]
```

```txt !! title="target/deploy/hello_world.so"
[binary executable file]
```

</ScrollyCoding>

### التحقق من حجم البرنامج والتكلفة

يتطلب نشر البرنامج تخصيص SOL لحساب البرنامج بناءً على حجم البرنامج. البرامج
الأكبر حجمًا تكلف المزيد من SOL للنشر.

تحقق من حجم برنامجك:

```terminal
$ wc -c < ./target/deploy/hello_world.so
18504
```

احسب كمية SOL المطلوبة لهذا الحجم (بالبايت):

```terminal
$ solana rent 18504
Rent-exempt minimum: 0.12967872 SOL
```

<Callout type="info">
  ستحتاج إلى SOL أكثر قليلاً مما هو موضح لتغطية رسوم معاملات النشر.
</Callout>

### نشر البرنامج

استخدم أمر `solana program deploy` لنشر برنامجك:

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 2BYwsqRP7ZwBNQvJp3S8bphTJ4zKW5JBPVMqCTE5KyLkP8xHzAyUEeC4LdTgjJdGBKHWNCkRF8Mf1T1WkLFyEu8W
```

**معرف البرنامج** المعروض هو عنوان برنامجك الدائم على الشبكة.

<Callout>

للنشر باستخدام معرف برنامج محدد (بدلاً من المعرف المُنشأ تلقائيًا)، استخدم:

```terminal
$ solana program deploy ./target/deploy/hello_world.so --program-id ./custom-keypair.json
```

يمكنك إنشاء keypair جديد باستخدام أمر `solana-keygen`:

```terminal
$ solana-keygen new -o ./custom-keypair.json
```

</Callout>

### تحديث البرنامج

قم بتحديث برنامجك باستخدام نفس أمر `solana program deploy`:

1. قم بإجراء تغييرات على كود البرنامج الخاص بك
2. أعد بناء برنامجك: `cargo build-sbf`
3. قم بنشر التحديث:

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 3zKnXDfEm1R8hVcEmTnNFYUaFjVVbLJrKdFj5hBMXoBRfz8xGyDhCYgKr9YY5KxKYPEUQQVfwEPNz9hQGvYhLNBJ
```

<Callout type="info">

إذا كان برنامجك المحدث يتطلب مساحة أكبر (بايت) مما هو مخصص حاليًا، فسيقوم النشر
تلقائيًا بتوسيع حساب البرنامج. يحدث هذا عندما يكون برنامجك الجديد أكبر من
الإصدار السابق. يحتاج حساب البرنامج إلى بايتات إضافية لتخزين البرنامج الجديد.
ستقوم واجهة سطر الأوامر بحساب كمية SOL المطلوبة وخصمها من محفظتك تلقائيًا.

يمكنك أيضًا توسيع البرنامج يدويًا لتخصيص المزيد من البايتات:

```terminal
$ solana program extend 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE 1000
Extended Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE by 1000 bytes
```

</Callout>

## إدارة البرنامج

بمجرد نشر برنامجك، هناك عدة أوامر شائعة لإدارة حساب البرنامج.

### عرض بيانات تعريف البرنامج

للتحقق من بيانات تعريف برنامجك، استخدم أمر `solana program show`:

```terminal
$ solana program show 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
```

<WithNotes>

مثال للمخرجات:

```txt
$ solana program show 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Program Id/] program-id
Program Id: 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Owner/] owner
Owner: BPFLoaderUpgradeab1e11111111111111111111111
# !tooltip[/ProgramData Address/] program-data-address
ProgramData Address: Gqn7YQVCP8NtYV1qkEqR4Udhj8EJ3fkikvS7HskCNQ7c
# !tooltip[/Authority/] authority
Authority: 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1
# !tooltip[/Last Deployed In Slot/] last-deployed-in-slot
Last Deployed In Slot: 6573
# !tooltip[/Data Length/] data-length
Data Length: 18504 (0x4848) bytes
# !tooltip[/Balance/] balance
Balance: 0.12999192 SOL
```

### !program-id

معرف البرنامج هو العنوان على السلسلة لحساب برنامجك. يستدعي المستخدمون والبرامج
الأخرى برنامجك من خلال الإشارة إلى هذا المعرف في معاملاتهم.

### !owner

المالك يحدد أي محمّل تم استخدامه لنشر هذا البرنامج. بالنسبة لمعظم البرامج، سيكون
هذا هو محمّل BPF القابل للترقية.

### !program-data-address

عنوان بيانات البرنامج يشير إلى الحساب المنفصل الذي يخزن الكود القابل للتنفيذ
لبرنامجك.

### !authority

السلطة هي الحساب الذي يملك صلاحية ترقية أو إغلاق هذا البرنامج. فقط السلطة يمكنها
نشر التحديثات أو إغلاق البرنامج لاسترداد عملات SOL المخصصة للبرنامج.

### !last-deployed-in-slot

آخر نشر في الـslot يشير إلى آخر مرة تم فيها تحديث هذا البرنامج.

### !data-length

طول البيانات يوضح إجمالي البايتات المخصصة لهذا البرنامج. يمكن لهذه المساحة
استيعاب التحديثات المستقبلية التي قد تكون أكبر من حجم البرنامج الحالي.

### !balance

الرصيد يعرض عملات SOL المخصصة لحساب البرنامج لتخزين بياناته.

</WithNotes>

### نقل سلطة البرنامج

لنقل سلطة البرنامج إلى حساب مختلف، استخدم الأمر
`solana program set-upgrade-authority`:

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --new-upgrade-authority ./new-authority-keypair.json
```

<Callout type="warn">
  بعد نقل سلطة البرنامج، لن تتمكن من تحديث البرنامج ما لم يكن لديك وصول إلى زوج
  المفاتيح الخاص بالسلطة الجديدة.
</Callout>

### جعل برنامجك غير قابل للتغيير

لجعل برنامجك غير قابل للتغيير، استخدم الأمر
`solana program set-upgrade-authority` مع العلامة `--final` لإزالة سلطة
البرنامج:

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --final
Account Type: Program
Authority: none
```

<Callout type="warn">
  بمجرد أن يصبح البرنامج غير قابل للتغيير، لا يمكن تحديثه أو إغلاقه أبدًا.
</Callout>

### إغلاق برنامجك

لإغلاق برنامجك واسترداد عملات SOL المخصصة لحساب البرنامج، استخدم الأمر
`solana program close`:

```terminal
$ solana program close 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --bypass-warning
Closed Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE, 0.12999192 SOL reclaimed
```

<Callout type="warn">
  بمجرد الإغلاق، لا يمكن إعادة استخدام معرف البرنامج. لا يمكنك نشر برنامج جديد
  على نفس العنوان.
</Callout>

## أوامر المساعدة

### عرض جميع البرامج

عرض جميع البرامج التي تكون محفظتك الحالية هي السلطة عليها:

```terminal
$ solana program show --programs
```

مثال على المخرجات:

```txt
Program Id                                       | Slot       | Authority                                      | Balance
-------------------------------------------------|------------|------------------------------------------------|-------------
7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE     | 249885434  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.12999192
3KSGCk4m5hqJkTjPHBXUCPcqMwJnK3VmkqEsFUKKGJPK     | 249883212  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.28654328
```

### تنزيل برنامج منشور

لتنزيل برنامج منشور، استخدم الأمر `solana program dump`:

```terminal
$ solana program dump 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE ./downloaded_program.so
Wrote program to ./downloaded_program.so
```

## خيارات متقدمة

### علامات النشر

عندما تكون شبكة سولانا مزدحمة، استخدم هذه العلامات للمساعدة في نشر البرنامج.

مثال على الاستخدام:

```terminal
$ solana program deploy ./target/deploy/hello_world.so \
    --with-compute-unit-price 10000 \
    --max-sign-attempts 10 \
    --use-rpc
```

شرح الخيارات:

- **`--with-compute-unit-price`**: تعيين رسوم الأولوية بالميكرو-لامبورت
  (0.000001 SOL) لكل وحدة حسابية. راجع
  [واجهة برمجة تطبيقات رسوم الأولوية من Helius](https://docs.helius.dev/guides/priority-fee-api)
  للحصول على المعدلات الحالية. رسوم الأولوية هي رسوم إضافية تُدفع للقائد الحالي
  لإعطاء الأولوية لمعاملتك.
- **`--max-sign-attempts`**: عدد مرات إعادة المحاولة باستخدام بلوكهاش جديد إذا
  انتهت صلاحية المعاملات. (الافتراضي: 5)
- **`--use-rpc`**: إرسال المعاملات إلى RPC المُكوّن. تتطلب هذه العلامة اتصال RPC
  [مرجح بالحصة](/developers/guides/advanced/stake-weighted-qos) من مزودين مثل
  [Triton](https://triton.one/) أو [Helius](https://www.helius.dev/).
