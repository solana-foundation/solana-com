---
title: Déployer un programme
description:
  Apprenez à construire, déployer et tester votre premier programme Solana en
  utilisant le framework Anchor et Solana Playground. Ce guide pour débutants
  vous accompagne dans la création d'un programme simple, son déploiement sur
  devnet, l'exécution de tests et la fermeture du programme.
h1: Déployez votre premier programme Solana
---

Construisez, déployez et testez votre premier [programme](/docs/core/programs)
sur la blockchain Solana en utilisant le framework Anchor. Ce guide vous aidera
à vous familiariser avec Solana Playground et vous préparera à utiliser les
Program Derived Addresses (PDA) et le Cross Program Invocation (CPI).

<Steps>

<Step>

### Créer un projet Anchor

1. Ouvrez [Solana Playground](https://beta.solpg.io) dans votre navigateur web
2. Dans le panneau de gauche, cliquez sur **+ Créer un nouveau projet**
3. Saisissez un **Nom de projet**
4. Sélectionnez **Anchor (Rust)** comme framework
5. Cliquez sur **Créer**

![Nouveau projet](/assets/docs/intro/quickstart/pg-new-project.gif)

Le fichier source `src/lib.rs` s'ouvrira. Il contient une structure appelée
`Initialize`, qui effectue les opérations suivantes :

- Reçoit un paramètre obligatoire appelé _rs`data: u64`_
- Crée un nouveau compte
- Enregistre la valeur de _rs`data: u64`_ dans le nouveau compte
- Ajoute un message aux journaux du programme de la transaction

<WithNotes>

```rust title="lib.rs"
use anchor_lang::prelude::*;

// This is your program's public key and it will update
// automatically when you build the project.
// !tooltip[/declare_id/] declare_id
declare_id!("11111111111111111111111111111111");

// !tooltip[/program/] program
#[program]
mod hello_anchor {
    use super::*;
    // !tooltip[/data: u64/] parameter
    pub fn initialize(ctx: Context<Initialize>, data: u64) -> Result<()> {
        // !tooltip[/ctx.accounts.new_account.data = data/] initialize
        ctx.accounts.new_account.data = data;
        // !tooltip[/msg!/] msg
        msg!("Changed data to: {}!", data); // Message will show up in the tx logs
        Ok(())
    }
}

// !tooltip[/Accounts/] accounts
#[derive(Accounts)]
pub struct Initialize<'info> {
    // We must specify the space in order to initialize an account.
    // First 8 bytes are default account discriminator,
    // next 8 bytes come from NewAccount.data being type u64.
    // (u64 = 64 bits unsigned integer = 8 bytes)
    // !tooltip[/account/] constraints
    #[account(
      // !tooltip[/init/] init
      init,
      // !tooltip[/payer/] payer
      payer = signer,
      // !tooltip[/space/] space
      space = 8 + 8
    )]
    pub new_account: Account<'info, NewAccount>,
    // !tooltip[/account/] constraints
    #[account(mut)]
    pub signer: Signer<'info>,
    pub system_program: Program<'info, System>,
}

// !tooltip[/account/] account
#[account]
pub struct NewAccount {
    data: u64
}
```

### !declare_id

L'adresse de votre programme sur la chaîne. Elle sera mise à jour lorsque vous
construirez le projet

### !program

Le module qui contient les instructions du programme

### !accounts

Annote une structure contenant les comptes du programme

### !account

Une structure qui représente les types de données de compte que ce programme
peut créer et posséder

### !constraints

Contraintes de compte. Par exemple, des vérifications courantes ou des
fonctionnalités qui améliorent la sécurité du programme

### !parameter

La valeur transmise à l'instruction lorsqu'elle est appelée

### !initialize

Accède au champ `data` du compte `new_account` et le définit à la valeur de
`data: u64`

### !msg

La macro _rs`msg!`_ enregistre un message dans les journaux du programme de la
transaction

### !init

Invoque le System Program pour créer un nouveau compte et définit ce programme
comme propriétaire. En tant que propriétaire du programme, ce programme peut
alors écrire dans les données du compte

### !payer

Le compte qui paie pour le nouveau compte

### !space

Le nombre d'octets à allouer pour le compte

</WithNotes>

<Accordions>

<Accordion title="Explication">

<WithMentions>

- La macro [`declare_id!`](mention:one) spécifie l'adresse on-chain de votre
  programme. Solana Playground mettra automatiquement à jour cette adresse
  lorsque vous compilerez le programme.

```rs
// !mention one
declare_id!("11111111111111111111111111111111");
```

</WithMentions>

<WithMentions>

- L'attribut [`#[program]`](mention:one) annote un module contenant des
  fonctions qui représentent les instructions du programme.

```rs
// !mention one
#[program]
mod hello_anchor {
    use super::*;
    // !mention two
    pub fn initialize(ctx: Context<Initialize>, data: u64) -> Result<()> {
        // !mention three
        ctx.accounts.new_account.data = data;
        msg!("Changed data to: {}!", data); // Message will show up in the tx logs
        Ok(())
    }
}
```

Dans cet exemple, l'instruction [`initialize`](mention:two) prend deux
paramètres :

- `ctx: Context<Initialize>` : transmet les comptes requis pour cette
  instruction à la fonction, comme spécifié dans la structure `Initialize`.
- `data: u64` : un paramètre personnalisé que vous devez fournir lorsque vous
  appelez l'instruction.

Le corps de la fonction
[définit le champ `data` de `new_account`](mention:three) à l'argument `data`
fourni, puis affiche un message dans les journaux du programme.

</WithMentions>

<WithMentions>

- L'attribut [`#[derive(Accounts)]`](mention:one) définit une structure qui
  spécifie les comptes requis pour une instruction particulière. Chaque champ
  représente un compte distinct.

  Anchor gère automatiquement les vérifications de sécurité courantes liées à la
  validation des comptes via les types de champs (ex. `Signer<'info>`) et les
  contraintes (ex. `#[account(mut)]`).

  ```rs
  // !mention one
  #[derive(Accounts)]
  pub struct Initialize<'info> {
      #[account(init, payer = signer, space = 8 + 8)]
      pub new_account: Account<'info, NewAccount>,
      #[account(mut)]
      pub signer: Signer<'info>,
      pub system_program: Program<'info, System>,
  }
  ```

</WithMentions>

<WithMentions>

- L'attribut [`#[account]`](mention:one) définit une structure qui représente le
  type de données pour les comptes que ce programme crée et possède.

```rs
// !mention one
#[account]
pub struct NewAccount {
  data: u64
}
```

</WithMentions>

</Accordion>
</Accordions>

</Step>

<Step>

### Compiler et déployer le programme

1. Compiler le code du programme

```terminal
$ build
Building...
Build successful. Completed in 1.46s.
```

<Callout>
  Votre [ID de programme](/docs/intro/quick-start/deploying-programs), défini
  dans _rs`declare_id!()`_, sera maintenant mis à jour.
</Callout>

2. Ajouter du SOL à votre portefeuille _(Facultatif)_

Le déploiement d'un programme nécessite du SOL dans le compte on-chain du
programme. Si nécessaire,
[ajoutez du SOL à votre portefeuille](/docs/intro/quick-start#add-sol-to-your-wallet)
avant de passer à l'étape 3.

3. Déployer le programme sur le réseau

```terminal
$ deploy
Deploying... This could take a while depending on the program size and network conditions.
Warning: 1 transaction not confirmed, retrying...
Deployment successful. Completed in 19s.
```

<Callout type="info">
  Lors du déploiement, le bytecode du programme est stocké dans un program
  account exécutable.
</Callout>

**Remarque :** Si vous préférez, vous pouvez utiliser les boutons **Build** et
**Deploy** sur le panneau de gauche, comme illustré dans la capture d'écran
ci-dessous.

![Build et Deploy](/assets/docs/intro/quickstart/pg-build-deploy.png)

</Step>

<Step>

### Tester le programme

<WithMentions>

1. Ouvrez le fichier de test appelé `tests/anchor.test.ts`. Ce fichier montre
   comment invoquer la structure [`initialize`](mention:one) du programme depuis
   le client.

```ts title="anchor.test.ts"
// No imports needed: web3, anchor, pg and more are globally available

describe("Test", () => {
  it("initialize", async () => {
    // Generate keypair for the new account
    const newAccountKp = new web3.Keypair();

    // Send transaction
    const data = new BN(42);
    const txHash = await pg.program.methods
      // !mention one
      .initialize(data)
      .accounts({
        newAccount: newAccountKp.publicKey,
        signer: pg.wallet.publicKey,
        systemProgram: web3.SystemProgram.programId
      })
      .signers([newAccountKp])
      .rpc();
    console.log(`Use 'solana confirm -v ${txHash}' to see the logs`);

    // Confirm transaction
    await pg.connection.confirmTransaction(txHash);

    // Fetch the created account
    const newAccount = await pg.program.account.newAccount.fetch(
      newAccountKp.publicKey
    );

    console.log("On-chain data is:", newAccount.data.toString());

    // Check whether the data on-chain is equal to local 'data'
    assert(data.eq(newAccount.data));
  });
});
```

</WithMentions>

2. Exécutez le fichier de test

```terminal
$ test
Running tests...
  hello_anchor.test.ts:
  hello_anchor
    Use 'solana confirm -v 3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc' to see the logs
    On-chain data is: 42
    ✔ initialize (961ms)
  1 passing (963ms)
```

3. Conservez le hash de transaction (`TxHash`) inclus dans la sortie

(Dans l'exemple ci-dessus, le hash de transaction est
`3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc`.)

**Remarque :** Si vous préférez, vous pouvez utiliser le bouton `Test` dans le
panneau latéral gauche.

![Exécuter le test](/assets/docs/intro/quickstart/pg-test.png)

4. Exécutez `solana confirm -v [TxHash]` pour afficher les journaux de
   transaction

```terminal
$ solana confirm -v 3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc
RPC URL: https://api.devnet.solana.com
Default Signer: Playground Wallet
Commitment: confirmed

Transaction executed in slot 308150984:
  Block Time: 2024-06-25T12:52:05-05:00
  Version: legacy
  Recent Blockhash: 7AnZvY37nMhCybTyVXJ1umcfHSZGbngnm4GZx6jNRTNH
  Signature 0: 3TewJtiUz1EgtT88pLJHvKFzqrzDNuHVi8CfD2mWmHEBAaMfC5NAaHdmr19qQYfTiBace6XUmADvR4Qrhe8gH5uc
  Signature 1: 3TrRbqeMYFCkjsxdPExxBkLAi9SB2pNUyg87ryBaTHzzYtGjbsAz9udfT9AkrjSo1ZjByJgJHBAdRVVTZv6B87PQ
  Account 0: srw- 3z9vL1zjN6qyAFHhHQdWYRTFAcy69pJydkZmSFBKHg1R (fee payer)
  Account 1: srw- c7yy8zdP8oeZ2ewbSb8WWY2yWjDpg3B43jk3478Nv7J
  Account 2: -r-- 11111111111111111111111111111111
  Account 3: -r-x 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r
  Instruction 0
    Program:   2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r (3)
    Account 0: c7yy8zdP8oeZ2ewbSb8WWY2yWjDpg3B43jk3478Nv7J (1)
    Account 1: 3z9vL1zjN6qyAFHhHQdWYRTFAcy69pJydkZmSFBKHg1R (0)
    Account 2: 11111111111111111111111111111111 (2)
    Data: [175, 175, 109, 31, 13, 152, 155, 237, 42, 0, 0, 0, 0, 0, 0, 0]
  Status: Ok
    Fee: ◎0.00001
    Account 0 balance: ◎5.47001376 -> ◎5.46900152
    Account 1 balance: ◎0 -> ◎0.00100224
    Account 2 balance: ◎0.000000001
    Account 3 balance: ◎0.00139896
  Log Messages:
    Program 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r invoke [1]
    Program log: Instruction: Initialize
    Program 11111111111111111111111111111111 invoke [2]
    Program 11111111111111111111111111111111 success
    Program log: Changed data to: 42!
    Program 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r consumed 5661 of 200000 compute units
    Program 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r success

Confirmed
```

4. Consultez les détails de la transaction

Ouvrez soit [SolanaFM](https://solana.fm/) soit
[Solana Explorer](https://explorer.solana.com/?cluster=devnet) et recherchez le
hash de transaction.

<Callout type="warn">
  **Solana Explorer :** Définissez le cluster réseau sur `devnet`, pour
  correspondre à celui du Solana Playground.
</Callout>

</Step>

<Step>

### Fermer le programme

Fermez le programme pour récupérer les SOL alloués au programme on-chain. Pour
ce faire, exécutez `solana program close [ProgramID]`, en utilisant l'adresse du
programme stockée dans la macro _rs`declare_id!()`_.

```terminal
$ solana program close 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r
Closed Program Id 2VvQ11q8xrn5tkPNyeraRsPaATdiPx8weLAD8aD4dn2r, 2.79511512 SOL reclaimed
```

<Callout type="warn">
  Les programmes peuvent **uniquement** être fermés ou mis à jour par un compte
  ayant l'autorité de mise à jour. Votre portefeuille Playground devient
  automatiquement l'autorité de mise à jour pour chaque programme lors de son
  déploiement. Si l'autorité de mise à jour est révoquée, le programme devient
  immuable.
</Callout>

Félicitations ! Vous avez créé et déployé votre premier programme Solana en
utilisant Anchor.

</Step>

</Steps>

## Prochaines étapes

Maintenant que vous avez déployé votre premier programme, vous êtes prêt à
explorer les
[adresses dérivées de programme](/docs/intro/quick-start/program-derived-address)
et
[l'invocation inter-programmes](/docs/intro/quick-start/cross-program-invocation).
