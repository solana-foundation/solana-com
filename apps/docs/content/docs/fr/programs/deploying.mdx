---
title: Déploiement de programmes
description:
  Guide complet pour construire, déployer et gérer des programmes Solana en
  utilisant la CLI Solana.
---

Cette section explique le processus de base pour déployer un programme Solana en
utilisant la CLI Solana.

## Référence des commandes CLI

| Tâche                                  | Commande                                                                                      |
| -------------------------------------- | --------------------------------------------------------------------------------------------- |
| Compiler le programme                  | `cargo build-sbf`                                                                             |
| Déployer un nouveau programme          | `solana program deploy <path_to_program.so>`                                                  |
| Mettre à jour un programme existant    | `solana program deploy <path_to_program.so>` (identique au déploiement)                       |
| Afficher les informations du programme | `solana program show <program-id>`                                                            |
| Transférer l'autorité du programme     | `solana program set-upgrade-authority <program-id> --new-upgrade-authority <path_to_keypair>` |
| Rendre le programme immuable           | `solana program set-upgrade-authority <program-id> --final`                                   |
| Fermer le programme                    | `solana program close <program-id> --bypass-warning`                                          |
| Vérifier le solde du portefeuille      | `solana balance`                                                                              |
| Demander un airdrop (devnet/localhost) | `solana airdrop 2`                                                                            |

## Concepts clés

Avant de commencer, clarifions quelques termes :

- **ID du programme** : L'adresse de votre programme sur la blockchain. Les
  utilisateurs interagissent avec votre programme en référençant l'ID du
  programme.
- **Program Account** : Le compte sur la blockchain qui stocke les métadonnées
  de votre programme. L'adresse du program account est l'ID du programme. Le
  program account stocke également l'adresse du ProgramData Account.
- **ProgramData Account** : Le compte sur la blockchain qui stocke le code
  exécutable déployé de votre programme.
- **Autorité du programme** : Le compte qui a la permission de mettre à jour ou
  de fermer le programme. Par défaut, il s'agit de votre portefeuille CLI.

## Prérequis

<Steps>

<Step>

### Installer la CLI Solana

D'abord, [installez la CLI Solana](/docs/intro/installation).

</Step>

<Step>

### Configurer le portefeuille

Après l'installation, créez un portefeuille local avec une paire de clés.
L'adresse de ce portefeuille est définie comme l'autorité du programme par
défaut lors du déploiement des programmes :

```terminal
$ solana-keygen new
```

Cela crée un keypair à l'emplacement `~/.config/solana/id.json` par défaut.

</Step>

<Step>

### Configurer le cluster

Choisissez le cluster Solana sur lequel déployer. Utilisez la commande
`solana config get` pour vérifier votre configuration actuelle :

```terminal
$ solana config get
Config File: ~/.config/solana/cli/config.yml
RPC URL: http://localhost:8899
WebSocket URL: ws://localhost:8900/ (computed)
Keypair Path: ~/.config/solana/id.json
Commitment: confirmed
```

Basculez entre les clusters selon vos besoins :

```terminal
$ solana config set --url mainnet-beta
$ solana config set --url devnet
$ solana config set --url localhost
$ solana config set --url testnet
$ solana config set --url "https://your-rpc-url.com"
```

</Step>

<Step>

### Financer le portefeuille

Vous aurez besoin de SOL pour payer les déploiements de programmes. Le montant
dépend de la taille de votre programme.

Pour devnet ou localhost, approvisionnez votre portefeuille en utilisant la
commande `solana airdrop` :

```terminal
$ solana airdrop 2
Requesting airdrop of 2 SOL
Signature: 5zQKxvRdgJDA8fRGPdKfGxRLnLpwmNnMXGYxfBqFSUPqc5BTmFPrTG8vnC4HvKDVY8zQ8aQxZxcEE7WFpGhZGVAA
2 SOL
```

Vérifiez le solde de votre portefeuille :

```terminal
$ solana balance
2 SOL
```

</Step>

</Steps>

## Opérations de base

### Compiler le programme

Pour compiler un programme, utilisez la commande `cargo build-sbf` :

```terminal
$ cargo build-sbf
```

<ScrollyCoding>

## !!steps Programme d'exemple

Voici un programme Solana minimal qui affiche "Hello, Solana!" dans les logs du
programme.

<CodePlaceholder title="src/lib.rs" />

```rs !! title="src/lib.rs"
use solana_program::{
    account_info::AccountInfo, entrypoint, entrypoint::ProgramResult, msg, pubkey::Pubkey,
};

entrypoint!(process_instruction);

pub fn process_instruction(
    _program_id: &Pubkey,
    _accounts: &[AccountInfo],
    _instruction_data: &[u8],
) -> ProgramResult {
    msg!("Hello, Solana!");
    Ok(())
}
```

```toml !! title="Cargo.toml"
[package]
name = "hello_world"
version = "0.1.0"
edition = "2021"

[lib]
crate-type = ["cdylib", "lib"]

[dependencies]
solana-program = "2.2.0"
```

## !!steps Résultat de la compilation

Compilez votre programme en utilisant la commande `cargo build-sbf` :

```terminal
$ cargo build-sbf
```

Cela crée deux fichiers importants dans `target/deploy/` :

1. `hello_world-keypair.json` : un fichier keypair dont la clé publique sera
   utilisée comme identifiant de votre programme
2. `hello_world.so` : l'exécutable du programme compilé

```json !! title="target/deploy/hello_world-keypair.json"
[
  203, 253, 43, 62, 165, 111, 94, 222, 105, 225, 218, 85, 143, 9, 114, 96, 243,
  181, 114, 89, 72, 230, 124, 85, 59, 165, 198, 23, 240, 212, 23, 154, 229, 241,
  153, 61, 153, 105, 79, 204, 193, 163, 33, 65, 82, 183, 49, 240, 224, 137, 248,
  24, 128, 25, 192, 197, 118, 235, 239, 67, 85, 156, 219, 231
]
```

```txt !! title="target/deploy/hello_world.so"
[binary executable file]
```

</ScrollyCoding>

### Vérifier la taille et le coût du programme

Le déploiement d'un programme nécessite que des SOL soient alloués au compte du
programme en fonction de la taille du programme. Les programmes plus volumineux
coûtent plus de SOL à déployer.

Vérifiez la taille de votre programme :

```terminal
$ wc -c < ./target/deploy/hello_world.so
18504
```

Calculez les SOL nécessaires pour cette taille (en octets) :

```terminal
$ solana rent 18504
Rent-exempt minimum: 0.12967872 SOL
```

<Callout type="info">
  Vous aurez besoin d'un peu plus de SOL que ce qui est indiqué pour couvrir les
  frais de transaction du déploiement.
</Callout>

### Déployer le programme

Utilisez la commande `solana program deploy` pour déployer votre programme :

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 2BYwsqRP7ZwBNQvJp3S8bphTJ4zKW5JBPVMqCTE5KyLkP8xHzAyUEeC4LdTgjJdGBKHWNCkRF8Mf1T1WkLFyEu8W
```

L'**ID du programme** affiché est l'adresse permanente de votre programme sur le
réseau.

<Callout>

Pour déployer avec un ID de programme spécifique (au lieu de celui généré
automatiquement), utilisez :

```terminal
$ solana program deploy ./target/deploy/hello_world.so --program-id ./custom-keypair.json
```

Vous pouvez générer de nouveaux keypairs en utilisant la commande
`solana-keygen` :

```terminal
$ solana-keygen new -o ./custom-keypair.json
```

</Callout>

### Mettre à jour le programme

Mettez à jour votre programme en utilisant la même commande
`solana program deploy` :

1. Apportez des modifications au code de votre programme
2. Reconstruisez votre programme : `cargo build-sbf`
3. Déployez la mise à jour :

```terminal
$ solana program deploy ./target/deploy/hello_world.so
Program Id: 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
Signature: 3zKnXDfEm1R8hVcEmTnNFYUaFjVVbLJrKdFj5hBMXoBRfz8xGyDhCYgKr9YY5KxKYPEUQQVfwEPNz9hQGvYhLNBJ
```

<Callout type="info">

Si votre programme mis à jour nécessite plus d'espace (octets) que ce qui est
actuellement alloué, le déploiement étendra automatiquement le compte du
programme. Cela se produit lorsque votre nouveau programme est plus volumineux
que la version précédente. Le compte du programme a besoin d'octets
supplémentaires pour stocker le nouveau programme. L'interface en ligne de
commande calculera automatiquement le SOL requis et le déduira de votre
portefeuille.

Vous pouvez également étendre manuellement un programme pour allouer plus
d'octets :

```terminal
$ solana program extend 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE 1000
Extended Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE by 1000 bytes
```

</Callout>

## Gestion du programme

Une fois votre programme déployé, il existe plusieurs commandes courantes pour
gérer le compte du programme.

### Afficher les métadonnées du programme

Pour vérifier les métadonnées de votre programme, utilisez la commande
`solana program show` :

```terminal
$ solana program show 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE
```

<WithNotes>

Exemple de sortie :

```txt
$ solana program show 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Program Id/] program-id
Program Id: 7283x8k8fyBcfaFLyPsxbd2VV1AMmZFP7FNoyTXVKJw7
# !tooltip[/Owner/] owner
Owner: BPFLoaderUpgradeab1e11111111111111111111111
# !tooltip[/ProgramData Address/] program-data-address
ProgramData Address: Gqn7YQVCP8NtYV1qkEqR4Udhj8EJ3fkikvS7HskCNQ7c
# !tooltip[/Authority/] authority
Authority: 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1
# !tooltip[/Last Deployed In Slot/] last-deployed-in-slot
Last Deployed In Slot: 6573
# !tooltip[/Data Length/] data-length
Data Length: 18504 (0x4848) bytes
# !tooltip[/Balance/] balance
Balance: 0.12999192 SOL
```

### !program-id

L'ID du programme est l'adresse sur la chaîne de votre compte de programme. Les
utilisateurs et autres programmes invoquent votre programme en référençant cet
ID dans leurs transactions.

### !owner

Le propriétaire identifie quel chargeur a été utilisé pour déployer ce
programme. Pour la plupart des programmes, ce sera le BPF Upgradeable Loader.

### !program-data-address

L'adresse ProgramData pointe vers le compte séparé qui stocke le code exécutable
de votre programme.

### !authority

L'autorité est le compte qui a la permission de mettre à jour ou de fermer ce
programme. Seule l'autorité peut déployer des mises à jour ou fermer le
programme pour récupérer le SOL alloué au programme.

### !last-deployed-in-slot

Le dernier déploiement dans le slot indique quand ce programme a été mis à jour
pour la dernière fois.

### !data-length

La longueur des données indique le nombre total d'octets alloués à ce programme.
Cet espace peut accueillir des mises à jour futures qui pourraient être plus
volumineuses que la taille actuelle du programme.

### !balance

Le solde affiche le SOL alloué au compte du programme pour stocker ses données.

</WithNotes>

### Transférer l'autorité du programme

Pour transférer l'autorité du programme à un compte différent, utilisez la
commande `solana program set-upgrade-authority` :

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --new-upgrade-authority ./new-authority-keypair.json
```

<Callout type="warn">
  Après avoir transféré l'autorité du programme, vous ne pourrez plus mettre à
  jour le programme à moins d'avoir accès à la nouvelle paire de clés
  d'autorité.
</Callout>

### Rendre votre programme immuable

Pour rendre votre programme immuable, utilisez la commande
`solana program set-upgrade-authority` avec le flag `--final` pour supprimer
l'autorité du programme :

```terminal
$ solana program set-upgrade-authority 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --final
Account Type: Program
Authority: none
```

<Callout type="warn">
  Une fois qu'un programme est immuable, il ne peut plus jamais être mis à jour
  ou fermé.
</Callout>

### Fermer votre programme

Pour fermer votre programme et récupérer les SOL alloués au compte du programme,
utilisez la commande `solana program close` :

```terminal
$ solana program close 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE --bypass-warning
Closed Program Id 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE, 0.12999192 SOL reclaimed
```

<Callout type="warn">
  Une fois fermé, l'ID du programme ne peut pas être réutilisé. Vous ne pouvez
  pas déployer un nouveau programme à la même adresse.
</Callout>

## Commandes utilitaires

### Lister tous les programmes

Afficher tous les programmes où votre portefeuille actuel est l'autorité :

```terminal
$ solana program show --programs
```

Exemple de sortie :

```txt
Program Id                                       | Slot       | Authority                                      | Balance
-------------------------------------------------|------------|------------------------------------------------|-------------
7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE     | 249885434  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.12999192
3KSGCk4m5hqJkTjPHBXUCPcqMwJnK3VmkqEsFUKKGJPK     | 249883212  | 5kh6HxYZiAebF8HWLsUWod2EaQQ6iWHpHYCz8UcmFbM1   | 0.28654328
```

### Télécharger un programme déployé

Pour télécharger un programme déployé, utilisez la commande
`solana program dump` :

```terminal
$ solana program dump 7NxQjW8H8hVcqBKgXbVDWqGQCovHbqDW9p1SJJwUyTpE ./downloaded_program.so
Wrote program to ./downloaded_program.so
```

## Options avancées

### Drapeaux de déploiement

Lorsque le réseau Solana est congestionné, utilisez ces drapeaux pour faciliter
le déploiement de programmes.

Exemple d'utilisation :

```terminal
$ solana program deploy ./target/deploy/hello_world.so \
    --with-compute-unit-price 10000 \
    --max-sign-attempts 10 \
    --use-rpc
```

Explication des options :

- **`--with-compute-unit-price`** : définit les frais de priorité en
  micro-lamports (0,000001 SOL) par unité de calcul. Consultez
  [l'API de frais de priorité Helius](https://docs.helius.dev/guides/priority-fee-api)
  pour les tarifs actuels. Les frais de priorité sont des frais supplémentaires
  payés au leader actuel pour prioriser votre transaction.
- **`--max-sign-attempts`** : nombre de tentatives de réessai avec un nouveau
  blockhash si les transactions expirent. (Par défaut : 5)
- **`--use-rpc`** : envoie les transactions au RPC configuré. Ce flag nécessite
  une connexion RPC
  [pondérée par stake](/developers/guides/advanced/stake-weighted-qos) auprès de
  fournisseurs tels que [Triton](https://triton.one/) ou
  [Helius](https://www.helius.dev/).
