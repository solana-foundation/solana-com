---
title: Tạo Clients
description:
  Hướng dẫn đầy đủ về việc tạo clients cho các chương trình Solana bằng Codama
  CLI.
---

[Codama](https://github.com/codama-idl/codama) tạo ra các client TypeScript và
Rust từ tệp IDL của chương trình. Các client được tạo ra bao gồm các hàm để gọi
các lệnh và truy xuất tài khoản, loại bỏ nhu cầu phải thủ công tuần tự hóa và
giải tuần tự hóa tài khoản chương trình hoặc instruction data.

<Callout type="warn">
  Codama đang trong quá trình phát triển tích cực và có thể thay đổi. Tham khảo
  các kho lưu trữ được liên kết trong tham khảo nhanh để biết thông tin mới
  nhất.
</Callout>

## Tham khảo nhanh

### Lệnh CLI

| Lệnh          | Mô tả                                   |
| ------------- | --------------------------------------- |
| `codama init` | Tạo tệp cấu hình codama                 |
| `codama run`  | Tạo client chương trình từ tệp cấu hình |

### Trình tạo Client

| Package                                                                                                  | Mô tả                                                                                  |
| -------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- |
| [`@codama/renderers-js`](https://github.com/codama-idl/renderers-js)                                     | Tạo client TypeScript tương thích với [`@solana/kit`](https://www.solanakit.com)       |
| [`@codama/renderers-rust`](https://github.com/codama-idl/renderers-rust)                                 | Tạo client Rust tương thích với [`solana_sdk`](https://github.com/anza-xyz/solana-sdk) |
| [`@codama/nodes-from-anchor`](https://github.com/codama-idl/codama/tree/main/packages/nodes-from-anchor) | Chuyển đổi Anchor IDL sang Codama IDL để tạo client                                    |

### Tài nguyên bổ sung

| Tài nguyên                                                                                                 | Mô tả                                                                               |
| ---------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------- |
| [Codama](https://github.com/codama-idl/codama)                                                             | GitHub của Codama                                                                   |
| [Codama CLI](https://github.com/codama-idl/codama/blob/main/packages/cli/README.md)                        | GitHub của Codama CLI                                                               |
| [Codama Macros](https://github.com/codama-idl/codama-rs)                                                   | GitHub của Codama Macros. Tạo Codama IDL từ chương trình Rust gốc với Codama macros |
| [Codama Macros Example Program](https://github.com/lorisleiva/codama-demo-2025-08/tree/main/3-from-macros) | Chương trình mẫu minh họa cách sử dụng Codama macros                                |

## Ví dụ

Ví dụ này hướng dẫn quy trình tạo client từ
[IDL của chương trình Anchor](https://www.anchor-lang.com/docs/basics/idl).

<ScrollyCoding>

## !!steps Thiết lập tệp dự án

Để thực hiện theo, hãy tạo một thư mục mới có tên `example` và thêm tệp
`idl.json` và tệp `package.json` từ các đoạn mã.

<Callout type="info">

Ví dụ này sử dụng IDL của chương trình counter.
[Xem mã nguồn](https://github.com/solana-developers/anchor-web3js-nextjs/blob/main/program/programs/counter/src/lib.rs).

Trong dự án Anchor, IDL được tìm thấy tại `target/idl/<program_name>.json` sau
khi chạy `anchor build`.

</Callout>

```json !! title="example/idl.json"
{
  "address": "8PY1q5J3Aq2z7TBDLBrVjv77mYzjXSCz6iHQaFEFw9hY",
  "metadata": {
    "name": "counter",
    "version": "0.1.0",
    "spec": "0.1.0",
    "description": "Created with Anchor"
  },
  "instructions": [
    {
      "name": "decrement",
      "discriminator": [106, 227, 168, 59, 248, 27, 150, 101],
      "accounts": [
        {
          "name": "user",
          "writable": true,
          "signer": true
        },
        {
          "name": "counter",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [99, 111, 117, 110, 116, 101, 114]
              }
            ]
          }
        },
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [118, 97, 117, 108, 116]
              },
              {
                "kind": "account",
                "path": "user"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    },
    {
      "name": "increment",
      "discriminator": [11, 18, 104, 9, 104, 174, 59, 33],
      "accounts": [
        {
          "name": "user",
          "writable": true,
          "signer": true
        },
        {
          "name": "counter",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [99, 111, 117, 110, 116, 101, 114]
              }
            ]
          }
        },
        {
          "name": "vault",
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [118, 97, 117, 108, 116]
              },
              {
                "kind": "account",
                "path": "user"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    }
  ],
  "accounts": [
    {
      "name": "Counter",
      "discriminator": [255, 176, 4, 245, 188, 253, 124, 25]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "UnderflowError",
      "msg": "Counter cannot be decremented below zero"
    }
  ],
  "types": [
    {
      "name": "Counter",
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "count",
            "type": "u64"
          }
        ]
      }
    }
  ]
}
```

```json !! title="example/package.json"
{
  "name": "example",
  "version": "1.0.0",
  "type": "module",
  "devDependencies": {
    "@types/node": "^24.10.0",
    "tsx": "^4.20.6",
    "typescript": "^5.9.3"
  }
}
```

## !!steps Tạo tệp cấu hình Codama

Codama sử dụng một tệp cấu hình để chỉ định vị trí của tệp IDL, ngôn ngữ client
nào cần tạo, và nơi xuất mã đã tạo. Tạo cấu hình này bằng cách chạy:

```terminal
$ npx codama init
```

Lệnh này sẽ hiển thị các câu hỏi để tạo tệp `codama.json` trong thư mục gốc của
dự án và cài đặt các dependency Codama cần thiết.

```shell title="example output"
Welcome to Codama!
✔ Where is your IDL located? (Supports Codama and Anchor IDLs). … idl.json
✔ Which script preset would you like to use? › Generate JavaScript client, Generate Rust client
✔ [js] Where should the JavaScript code be generated? … clients/js/src/generated
✔ [rust] Where is the Rust client crate located? … clients/rust
✔ [rust] Where should the Rust code be generated? … clients/rust/src/generated
▲ Your configuration requires additional dependencies.
▲ Install command: pnpm install @codama/nodes-from-anchor @codama/renderers-js @codama/renderers-rust
✔ Install dependencies? … yes
→ Installing
  ├─ @codama/nodes-from-anchor
  ├─ @codama/renderers-js
  └─ @codama/renderers-rust
✔ Dependencies installed successfully.

✔ Configuration file created.
  └─ Path: /example/codama.json
```

```json !! title="example/codama.json"
{
  "idl": "idl.json",
  "before": [],
  "scripts": {
    "js": {
      "from": "@codama/renderers-js",
      "args": ["clients/js/src/generated"]
    },
    "rust": {
      "from": "@codama/renderers-rust",
      "args": [
        "clients/rust/src/generated",
        {
          "crateFolder": "clients/rust",
          "formatCode": true
        }
      ]
    }
  }
}
```

```json !! title="example/package.json"
{
  "name": "example",
  "version": "1.0.0",
  "type": "module",
  "devDependencies": {
    "@types/node": "^24.10.0",
    "tsx": "^4.20.6",
    "typescript": "^5.9.3"
  },
  "dependencies": {
    "@codama/nodes-from-anchor": "^1.2.9",
    "@codama/renderers-js": "^1.4.3",
    "@codama/renderers-rust": "^1.2.7"
  }
}
```

## !!steps Tạo Clients

Sau khi tệp cấu hình được tạo, chạy lệnh tạo để tạo các clients:

```terminal
$ npx codama run --all
```

<WithMentions>

Điều này sẽ tạo các client chương trình trong [đường dẫn tệp](mention:path) được
chỉ định trong tệp cấu hình codama.

```json title="codama.json"
{
  "idl": "idl.json",
  "before": [],
  "scripts": {
    "js": {
      "from": "@codama/renderers-js",
      // !mark
      // !mention path
      "args": ["clients/js/src/generated"]
    },
    "rust": {
      "from": "@codama/renderers-rust",
      "args": [
        // !mark
        // !mention path
        "clients/rust/src/generated",
        {
          "crateFolder": "clients/rust",
          "formatCode": true
        }
      ]
    }
  }
}
```

</WithMentions>

<Callout type="info">
  Không phải tất cả các tệp được tạo đều được hiển thị trong các đoạn mã tương
  ứng.
</Callout>

```ts !! title="example/clients/js/src/generated/index.ts"
/**
 * This code was AUTOGENERATED using the Codama library.
 * Please DO NOT EDIT THIS FILE, instead use visitors
 * to add features, then rerun Codama to update it.
 *
 * @see https://github.com/codama-idl/codama
 */

export * from "./accounts";
export * from "./errors";
export * from "./instructions";
export * from "./programs";
```

```rs !! title="example/clients/rust/src/generated/mod.rs"
//! This code was AUTOGENERATED using the codama library.
//! Please DO NOT EDIT THIS FILE, instead use visitors
//! to add features, then rerun codama to update it.
//!
//! <https://github.com/codama-idl/codama>
//!

pub mod accounts;
pub mod errors;
pub mod instructions;
pub mod programs;
pub mod shared;

pub(crate) use programs::*;
```

</ScrollyCoding>

## Sử dụng các Clients đã tạo

Các client được tạo bao gồm mã nguồn để tương tác với chương trình của bạn nhưng
không bao gồm `package.json` (cho TypeScript) hoặc `Cargo.toml` (cho Rust).

Bạn sẽ cần tạo tệp `package.json` và `Cargo.toml` mới hoặc thêm các dependency
cần thiết từ client được tạo vào các tệp hiện có của dự án.

### Tích hợp vào ứng dụng của bạn

Tạo client trực tiếp vào thư mục nguồn của ứng dụng và sau đó thêm các
dependency cần thiết vào `package.json` hoặc `Cargo.toml` hiện có.

Sử dụng cách tiếp cận này khi xây dựng ứng dụng mà mã client không cần được chia
sẻ hoặc xuất bản.

### Các gói hoặc crate độc lập

Tạo các package TypeScript hoặc crate Rust riêng biệt cho mỗi client. Ví dụ,
thêm `package.json` vào `clients/js/` và `Cargo.toml` vào `clients/rust/`.

Sử dụng cách tiếp cận này để xuất bản client như một thư viện có thể tái sử dụng
(npm hoặc crates.io) hoặc chia sẻ client giữa nhiều ứng dụng trong một monorepo.
