---
title: Ομαδικές πληρωμές
description: Μάθετε πώς να πληρώνετε πολλούς παραλήπτες σε μία μόνο συναλλαγή.
---

Μια συναλλαγή Solana είναι ένα container που περιέχει μία ή περισσότερες
οδηγίες. Κάθε οδηγία είναι μια λειτουργία—μεταφορά tokens, δημιουργία
λογαριασμού, κλήση προγράμματος. Το δίκτυο εκτελεί όλες τις οδηγίες σε μια
συναλλαγή διαδοχικά και ατομικά: είτε κάθε οδηγία επιτυγχάνει, είτε ολόκληρη η
συναλλαγή αποτυγχάνει και επαναφέρεται.

Αυτό σημαίνει ότι μπορείτε να συσκευάσετε πολλαπλές μεταφορές σε μία μόνο
συναλλαγή. Αντί να στείλετε τρεις ξεχωριστές συναλλαγές για να πληρώσετε τρεις
παραλήπτες, στέλνετε μία συναλλαγή με τρεις οδηγίες μεταφοράς. Αυτό είναι
ταχύτερο (μία επιβεβαίωση αντί για τρεις) και φθηνότερο (μία βασική χρέωση αντί
για τρεις). Ακολουθεί ένα ενδεικτικό παράδειγμα του πώς οι πληρωμές (που
αναφέρονται ως "drops" σε αυτή την εικόνα) ομαδοποιούνται σε μία μόνο συναλλαγή
και πολλαπλές συναλλαγές αποστέλλονται για να διαχειριστούν τη μεγαλύτερη ομάδα.

![Διάγραμμα ομαδικών πληρωμών](/assets/docs/payments/qn-bulk-send.png)

_Πηγή:
[QuickNode - How to Send Bulk Transactions on Solana](https://www.quicknode.com/guides/solana-development/transactions/how-to-send-bulk-transactions-on-solana)_

Για περισσότερες πληροφορίες σχετικά με τις συναλλαγές και τις οδηγίες, δείτε
τους οδηγούς [Συναλλαγές](/docs/core/transactions) και
[Οδηγίες](/docs/core/instructions).

Η παρακάτω περιγραφή δείχνει πώς να φορτώσετε πολλαπλές οδηγίες μεταφοράς σε μία
μόνο συναλλαγή για ομαδικές πληρωμές.

## Ομαδοποίηση οδηγιών σε μία μόνο συναλλαγή

Μια συναλλαγή Solana μπορεί να περιέχει πολλαπλές μεταφορές σε διαφορετικούς
παραλήπτες. Υπογράφετε μία φορά, πληρώνετε μία χρέωση συναλλαγής και όλες οι
μεταφορές διευθετούνται μαζί. Αν οποιαδήποτε μεταφορά αποτύχει, ολόκληρη η
συναλλαγή απορρίπτεται.

<Callout>
  Δείτε το [Πώς λειτουργούν οι πληρωμές στο
  Solana](/docs/payments/how-payments-work) για βασικές έννοιες πληρωμών.
</Callout>

Η ομαδοποίηση πολλαπλών μεταφορών απαιτεί τη δημιουργία κάθε οδηγίας ξεχωριστά
και στη συνέχεια τον συνδυασμό τους σε μία μόνο συναλλαγή.

Τα παρακάτω βήματα δείχνουν τη βασική ροή. Δείτε το [Demo](#demo) για πλήρη
εκτελέσιμο κώδικα.

<ScrollyCoding>

## !!steps Παραγωγή λογαριασμών token

Πρώτα, παράγετε τις διευθύνσεις Associated Token Account (ATA) για τον αποστολέα
και κάθε παραλήπτη. Τα ATA είναι ντετερμινιστικές διευθύνσεις που βασίζονται στο
πορτοφόλι και το mint.

<CodePlaceholder title="Batch Payments" />

```ts !! title="Batch Payments"
const [senderAta] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: sender.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient1Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient1.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient2Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient2.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});
```

## !!steps Δημιουργία οδηγιών μεταφοράς

Δημιουργήστε μια ξεχωριστή οδηγία μεταφοράς για κάθε παραλήπτη. Κάθε οδηγία
καθορίζει:

- τη διεύθυνση του λογαριασμού token προέλευσης
- τη διεύθυνση του λογαριασμού token προορισμού
- την εξουσιοδότηση (διεύθυνση κατόχου του λογαριασμού token προέλευσης)
- το ποσό σε βασικές μονάδες (προσαρμοσμένο για τα δεκαδικά του mint)

<CodePlaceholder title="Batch Payments" />

```ts !! title="Batch Payments"
const [senderAta] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: sender.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient1Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient1.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient2Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient2.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

// !focus(1:12)
const transfer1Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient1Ata,
  authority: sender.address,
  amount: 250_000n
});

const transfer2Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient2Ata,
  authority: sender.address,
  amount: 250_000n
});
```

## !!steps Αποστολή ως μεμονωμένη συναλλαγή

Προσθέστε όλες τις οδηγίες μεταφοράς σε μία συναλλαγή. Αυτό εκτελεί όλες τις
μεταφορές ατομικά, είτε όλες οι μεταφορές επιτυγχάνουν είτε ολόκληρη η συναλλαγή
αποτυγχάνει.

```ts !! title="Batch Payments"
const [senderAta] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: sender.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient1Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient1.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient2Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient2.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const transfer1Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient1Ata,
  authority: sender.address,
  amount: 250_000n
});

const transfer2Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient2Ata,
  authority: sender.address,
  amount: 250_000n
});

// !focus(1:5)
const signature = await client.transaction.prepareAndSend({
  authority: sender,
  // !mark
  instructions: [transfer1Instruction, transfer2Instruction],
  version: 0
});
```

## !!steps Επαλήθευση υπολοίπων

Μετά τη μαζική μεταφορά, επαληθεύστε τα υπόλοιπα token για όλα τα μέρη
χρησιμοποιώντας το `splToken` βοηθητικό εργαλείο.

<CodePlaceholder title="Batch Payments" />

```ts !! title="Batch Payments"
const [senderAta] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: sender.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient1Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient1.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const [recipient2Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient2.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

const transfer1Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient1Ata,
  authority: sender.address,
  amount: 250_000n
});

const transfer2Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient2Ata,
  authority: sender.address,
  amount: 250_000n
});

const signature = await client.transaction.prepareAndSend({
  authority: sender,
  instructions: [transfer1Instruction, transfer2Instruction],
  version: 0
});

// !focus(1:8)
const splToken = client.splToken({
  mint: mint.address,
  tokenProgram: "auto"
});

const senderBalance = await splToken.fetchBalance(sender.address);
const recipient1Balance = await splToken.fetchBalance(recipient1.address);
const recipient2Balance = await splToken.fetchBalance(recipient2.address);
```

</ScrollyCoding>

### Επίδειξη

<CodeTabs flags="r">

```ts !! title="Demo"
// !collapse(1:14) collapsed
// Click ">" icon on left to expand demo imports
import { createClient, lamports } from "@solana/client";
import { generateKeypair } from "@solana/client/server";
import type { ServerKeypair } from "@solana/client/server";
import { getCreateAccountInstruction } from "@solana-program/system";
import {
  getCreateAssociatedTokenInstructionAsync,
  getInitializeMintInstruction,
  getMintSize,
  TOKEN_2022_PROGRAM_ADDRESS,
  findAssociatedTokenPda,
  getMintToInstruction,
  getTransferInstruction
} from "@solana-program/token-2022";

// Generate keypairs for sender and two recipients
const sender = (await generateKeypair()).signer;
const recipient1 = (await generateKeypair()).signer;
const recipient2 = (await generateKeypair()).signer;

console.log("Sender Address:", sender.address);
console.log("Recipient 1 Address:", recipient1.address);
console.log("Recipient 2 Address:", recipient2.address);

// Demo Setup: Create client, mint account, token accounts, and fund with initial tokens
const { client, mint } = await demoSetup(sender, recipient1, recipient2);

console.log("\nMint Address:", mint.address);

// Derive the Associated Token Accounts addresses (ATAs) for sender and recipients
// !mark(1:5)
const [senderAta] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: sender.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

// !mark(1:5)
const [recipient1Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient1.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

// !mark(1:5)
const [recipient2Ata] = await findAssociatedTokenPda({
  mint: mint.address,
  owner: recipient2.address,
  tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
});

console.log("Sender Token Account:", senderAta.toString());
console.log("Recipient 1 Token Account:", recipient1Ata.toString());
console.log("Recipient 2 Token Account:", recipient2Ata.toString());

// =============================================================================
// Batch Token Payment Demo
// =============================================================================

// Create instructions to transfer tokens from sender to both recipients
// Transferring 250,000 base units = 0.25 tokens (with 6 decimals) to each
// !mark(1:6)
const transfer1Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient1Ata,
  authority: sender.address,
  amount: 250_000n // 0.25 tokens
});

// !mark(1:6)
const transfer2Instruction = getTransferInstruction({
  source: senderAta,
  destination: recipient2Ata,
  authority: sender.address,
  amount: 250_000n // 0.25 tokens
});

// Prepare and send both transfers in a single transaction using @solana/client
const signature = await client.transaction.prepareAndSend({
  authority: sender,
  // !mark
  instructions: [transfer1Instruction, transfer2Instruction],
  version: 0
});

console.log("\n=== Batch Token Payment Complete ===");
console.log("Transaction Signature:", signature.toString());

// Fetch final token account balances using @solana/client SPL token helper
const splToken = client.splToken({
  mint: mint.address,
  tokenProgram: "auto"
});

const senderBalance = await splToken.fetchBalance(sender.address);
const recipient1Balance = await splToken.fetchBalance(recipient1.address);
const recipient2Balance = await splToken.fetchBalance(recipient2.address);

console.log("\nSender Token Account Balance:", senderBalance);
console.log("Recipient 1 Token Account Balance:", recipient1Balance);
console.log("Recipient 2 Token Account Balance:", recipient2Balance);

// =============================================================================
// Demo Setup Helper Function
// =============================================================================
// !collapse(1:1000) collapsed

/**
 * Sets up for a batch token transfer demo:
 * - Creates @solana/client instance
 * - Airdrops SOL to sender for transaction fees
 * - Generates mint keypair and creates/initializes mint account
 * - Creates associated token accounts for sender and both recipients
 * - Mints initial tokens to sender
 *
 * @param sender - The sender's keypair (will be funded and used as mint authority)
 * @param recipient1 - The first recipient's keypair
 * @param recipient2 - The second recipient's keypair
 * @returns Returns client instance and mint address
 */
async function demoSetup(
  sender: ServerKeypair["signer"],
  recipient1: ServerKeypair["signer"],
  recipient2: ServerKeypair["signer"]
) {
  // Create @solana/client instance pointing to local validator
  const client = createClient({
    endpoint: "http://localhost:8899",
    websocketEndpoint: "ws://localhost:8900",
    commitment: "confirmed",
    logger: () => {} // Disable all logs
  });

  // Fund sender with SOL for transaction fees using @solana/client actions
  await client.actions.requestAirdrop(sender.address, lamports(1_000_000_000n));

  // Generate keypair to use as address of mint
  const mint = (await generateKeypair()).signer;

  // Get default mint account size (in bytes), no extensions enabled
  const space = BigInt(getMintSize());

  // Get minimum balance for rent exemption
  const rent = await client.runtime.rpc
    .getMinimumBalanceForRentExemption(space)
    .send();

  // Instruction to create new account for mint (token program)
  // Invokes the system program
  const createAccountInstruction = getCreateAccountInstruction({
    payer: sender,
    newAccount: mint,
    lamports: rent,
    space,
    programAddress: TOKEN_2022_PROGRAM_ADDRESS
  });

  // Instruction to initialize mint account data
  // Invokes the token 2022 program
  const initializeMintInstruction = getInitializeMintInstruction({
    mint: mint.address,
    decimals: 6,
    mintAuthority: sender.address
  });

  // Derive sender's associated token account address (ATA)
  const [senderAta] = await findAssociatedTokenPda({
    mint: mint.address,
    owner: sender.address,
    tokenProgram: TOKEN_2022_PROGRAM_ADDRESS
  });

  // Create instruction for sender's ATA
  const createSenderAtaInstruction =
    await getCreateAssociatedTokenInstructionAsync({
      payer: sender,
      mint: mint.address,
      owner: sender.address
    });

  // Create instruction for recipient 1's ATA
  const createRecipient1AtaInstruction =
    await getCreateAssociatedTokenInstructionAsync({
      payer: sender,
      mint: mint.address,
      owner: recipient1.address
    });

  // Create instruction for recipient 2's ATA
  const createRecipient2AtaInstruction =
    await getCreateAssociatedTokenInstructionAsync({
      payer: sender,
      mint: mint.address,
      owner: recipient2.address
    });

  // Create instruction to mint initial tokens to sender
  const mintToInstruction = getMintToInstruction({
    mint: mint.address,
    token: senderAta,
    mintAuthority: sender.address,
    amount: 1_000_000n // Mint 1.00 tokens (1,000,000 base units with 6 decimals)
  });

  // Combine all instructions and send using @solana/client transaction helper
  const setupInstructions = [
    createAccountInstruction, // Create mint account
    initializeMintInstruction, // Initialize mint
    createSenderAtaInstruction, // Create sender's ATA
    createRecipient1AtaInstruction, // Create recipient 1's ATA
    createRecipient2AtaInstruction, // Create recipient 2's ATA
    mintToInstruction // Mint tokens to sender
  ];

  // Prepare and send transaction using @solana/client
  await client.transaction.prepareAndSend({
    authority: sender,
    instructions: setupInstructions,
    version: 0
  });

  return {
    client,
    mint
  };
}
```

</CodeTabs>

## Κλιμάκωση με σχεδιασμό συναλλαγών

Μια μεμονωμένη συναλλαγή έχει όρια μεγέθους—περίπου 1232 bytes. Για μεγάλες
μαζικές λειτουργίες (μισθοδοσία για εκατοντάδες υπαλλήλους, μαζικά airdrops), θα
υπερβείτε αυτό το όριο και θα χρειαστεί να χωρίσετε την εργασία σε πολλαπλές
συναλλαγές.

Αν και μπορείτε να δημιουργήσετε τη δική σας λογική κατανομής συναλλαγών, το
πακέτο
[`@solana/instruction-plans`](https://www.solanakit.com/docs/concepts/instruction-plans)
(μέρος του Solana Kit) το χειρίζεται σε δύο επίπεδα:

Τα **σχέδια οδηγιών** ορίζουν τις λειτουργίες σας και τους περιορισμούς σειράς
τους:

- **Διαδοχικές** — οδηγίες που πρέπει να εκτελεστούν με σειρά
- **Παράλληλες** — οδηγίες που μπορούν να εκτελεστούν με οποιαδήποτε σειρά
- **Μη διαιρετές** — οδηγίες που πρέπει να παραμείνουν μαζί στην ίδια συναλλαγή

Τα **σχέδια συναλλαγών** δημιουργούνται από τα σχέδια οδηγιών. Ο σχεδιαστής
πακετάρει έξυπνα τις οδηγίες σε συναλλαγές βέλτιστου μεγέθους, σεβόμενος τους
περιορισμούς σειράς σας. Το τελικό σχέδιο συναλλαγής μπορεί στη συνέχεια να:

- **Εκτελεστεί** — υπογραφεί και σταλεί στο δίκτυο, με παράλληλες συναλλαγές να
  αποστέλλονται ταυτόχρονα
- **Προσομοιωθεί** — δοκιμαστική εκτέλεση στο δίκτυο για επαλήθευση πριν την
  αποστολή
- **Σειριοποιηθεί** — μεταγλωττιστεί σε base64 για εξωτερικές υπηρεσίες
  υπογραφής ή ροές εργασίας πολλαπλών μερών

Αυτή η προσέγγιση δύο επιπέδων σας επιτρέπει να σκέφτεστε με όρους λειτουργιών
("μεταφορά στην Alice, στη συνέχεια μεταφορά στον Bob") ενώ η βιβλιοθήκη
χειρίζεται τη μηχανική του μεγέθους συναλλαγής, του πακεταρίσματος και της
παράλληλης εκτέλεσης.
