import classNames from "classnames";
import { memo, useState, useId } from "react";
import { useSpring, animated } from "react-spring";

import Link from "../../../utils/Link";

import styles from "./AnimatedCta.module.scss";

export default memo(function AnimatedCta({
  onClick,
  to,
  children,
  type = "primary",
  size = "regular",
  ...props
}) {
  const maskId = useId();
  const Element = onClick ? "button" : Link;
  const action = onClick
    ? {
        onClick,
      }
    : {
        to,
      };
  const [isHovering, setIsHovering] = useState(false);
  const { x } = useSpring({ config: { duration: 200 }, x: isHovering ? 1 : 0 });

  return (
    <Element
      onMouseEnter={() => setIsHovering(true)}
      onMouseLeave={() => setIsHovering(false)}
      className={classNames(styles["animated-cta"], {
        [styles["animated-cta--primary"]]: type === "primary",
        [styles["animated-cta--secondary"]]: type === "secondary",
        [styles["animated-cta--large"]]: size === "large",
      })}
      {...action}
      {...props}
    >
      <span className={styles["animated-cta__text"]}>{children}</span>
      {type === "primary" ? (
        <svg
          height="49"
          width="185"
          viewBox="0 0 185 49"
          fill="none"
          className={styles["animated-cta__background"]}
        >
          <mask
            id={maskId}
            style={{ maskType: "alpha" }}
            maskUnits="userSpaceOnUse"
            x="4"
            y="1"
            width="172"
            height="45"
          >
            <path
              d="M5.333 19.578C8.056 9.083 18.7 2.84 29.427 4.418 75.51 11.194 103.71-1.356 157.635 2.58c13.553.989 21.561 15.106 16.468 27.705l-0.786 1.942c-3.875 9.587-14.151 14.845-24.351 13.141-54.528-9.11-77.744 3.55-127.946-2.048C9.6 42.046 2.447 30.7 5.333 19.578Z"
              fill="#14F195"
            />
          </mask>
          <g mask={`url(#${maskId})`}>
            <rect
              x="-47.984"
              y="-23.951"
              width="287.878"
              height="96.113"
              rx="21.089"
              fill="#14F195"
            />
            <animated.circle
              cx={x.to({
                range: [0, 1],
                output: ["76.413", "68.245"],
              })}
              cy={x.to({
                range: [0, 1],
                output: ["-0.552", "-17.306"],
              })}
              r="29.577"
              fill="#1FCFF1"
            />
            <animated.path
              d={x.to({
                range: [0, 1],
                output: [
                  "M -1.884 -7.44 L 68.431 65.775 L 5.365 87.522 C 0.295 78.602 -31.571 87.708 -38.528 76.14 C -48.997 58.731 -34.34 21.572 -36.44 21.47 C -36.85 21.782 -36.951 21.829 -36.678 21.555 Z",
                  "M -10.052 -24.195 L 60.263 49.019 L -2.803 70.766 C -11.656 76.501 -34.281 84.528 -41.436 72.659 C -51.676 55.673 -45.599 7.605 -47.657 7.505 C -48.067 7.817 -21.134 -14.818 -10.052 -24.195 Z",
                ],
              })}
              fill="#F087FF"
            />
            <animated.path
              d={x.to({
                range: [0, 1],
                output: [
                  "M183.643-32.418c-0.672-1.878-16.702 2.82-29.807 5.78-3.11 50.399-43.714 22.598-35.368 57.911l30.933 42.754 37.354-27.126c1.405-12.581-2.439-77.442-3.112-79.32Z",
                  "M175.475-44.172c-0.672-1.878-16.702 2.82-29.807 5.78-3.11 50.399-43.714 22.598-35.368 57.911l30.933 42.754 37.354-27.126c1.405-12.58-2.439-77.442-3.112-79.32Z",
                ],
              })}
              fill="#FFD512"
            />
          </g>
          <animated.path
            d={x.to({
              range: [0, 1],
              output: [
                "m 127.04381,211.10935 c 0,-14.91359 0.003,-32.17749 0.003,-42.36834 -0.004,-20.38227 -0.003,-21.7271 -0.003,-42.10937 0,-9.01496 0.003,-25.3606 0.003,-37.8159 -10.12444,0 -16.33391,-0.001 -24.82899,-0.001 -10.247197,3.062792 -11.04603,3.338535 -23.70081,7.71398 3.219216,10.98961 3.923509,12.69764 7.027253,24.85177 6.190354,-2.25005 6.308442,-2.18734 11.865083,-3.67743 0,10.12296 0.0028,17.26578 0.0028,22.75715 0,2.74568 -6.06e-4,15.5244 -0.0013,22.72161 -6.74e-4,7.19722 -0.0014,18.91094 -0.0017,24.27864 -5.47e-4,10.73539 0.003,23.6491 0.003,23.6491 10.54953,0 22.21003,-2.1e-4 29.63216,-2.1e-4 z",
                "m 147.37298,211.0425 c 0,-12.87559 -0.0733,-16.96041 -0.0733,-25.94198 -13.28238,0 -30.99957,-0.006 -48.083266,-0.006 1.945436,-7.2604 10.848226,-12.9841 25.592646,-25.65209 14.56441,-12.51334 21.31788,-18.67489 21.31788,-38.38628 0,-16.57099 -15.69897,-34.99446 -40.24609,-34.99446 -23.223349,0 -39.737742,15.0486 -43.25384,31.78353 8.205794,2.62262 18.220113,5.4265 25.810648,7.67225 3.235642,-9.6238 10.773686,-12.89988 16.734722,-11.97323 5.792,0.90037 10.5743,4.53094 10.5743,11.16538 0,9.71751 -10.84859,17.07429 -25.914468,31.69552 -26.242909,25.46838 -26.270987,31.22153 -26.270987,54.5227 33.135324,0 58.393495,0.11466 83.811755,0.11466 z",
              ],
            })}
          />
        </svg>
      ) : (
        <svg
          width="257"
          height="68"
          viewBox="0 0 257 68"
          fill="none"
          className={styles["animated-cta__background"]}
        >
          <mask
            id={maskId}
            style={{ maskType: "alpha" }}
            maskUnits="userSpaceOnUse"
            x="6"
            y="1"
            width="239"
            height="62"
          >
            <path
              d="M7.433 26.359c3.795-14.627 18.631-23.327 33.581-21.13 64.23 9.444 103.534-8.047 178.693-2.562 18.89 1.379 30.051 21.055 22.953 38.615l-1.095 2.707c-5.401 13.362-19.724 20.691-33.94 18.316-75.999-12.697-108.357 4.948-178.327-2.856C13.38 57.674 3.41 41.862 7.433 26.36Z"
              fill="#14F195"
            />
          </mask>
          <g mask={`url(#${maskId})`}>
            <rect
              x="-66.875"
              y="-34.31"
              width="401.237"
              height="133.959"
              rx="29.393"
              fill="#9945FF"
            />
            <animated.path
              d={x.to({
                range: [0, 1],
                output: [
                  "M-20.618-11.299 77.385 90.746l-87.9 30.31c-17.7-31.14-53.395-91.823-58.269-92.06-0.572.435-0.712.5-0.33.119a.417.417 0 0 1 0.33-0.12c4.278-3.254 32.72-27.224 48.166-40.294Z",
                  "M-2.898-31.244 62.3 90.746l-87.9 30.31c-17.7-31.14-53.395-91.823-58.269-92.06-0.572.435-0.712.5-0.33.119a.417.417 0 0 1 0.35-0.02c5.023-1.914 39.076-16.876 48.166-40.294Z",
                ],
              })}
              fill="#F087FF"
            />
            <animated.path
              d={x.to({
                range: [0, 1],
                output: [
                  "M307.203 -45.1126C306.266 -47.7293 283.924 -41.1818 265.659 -37.055C261.325 33.1885 204.731 -5.5593 216.364 43.6591L259.478 103.248L311.54 65.4408C313.499 47.9055 308.141 -42.4959 307.203 -45.1126Z",
                  "M241.391 -59.5086C238.884 -60.7097 227.605 -40.3433 217.522 -24.5647C263.838 28.4236 196.353 40.6745 239.236 67.4857L311.793 79.5316L322.22 16.0403C311.281 2.19609 243.898 -58.3075 241.391 -59.5086Z",
                ],
              })}
              fill="#FFD512"
            />
          </g>
        </svg>
      )}
    </Element>
  );
});
