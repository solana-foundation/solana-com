---
title: 安装
seoTitle: 安装Solana CLI和Anchor
description:
  设置本地Solana开发环境的指南。学习如何在Windows（WSL）、Linux
  和Mac上安装Rust、Solana CLI和Anchor框架。
---

本节介绍为Solana开发设置本地环境的步骤。

## 快速安装

在Mac和Linux上，运行这个单一命令来安装所有依赖项。

```terminal
$ curl --proto '=https' --tlsv1.2 -sSfL https://solana-install.solana.workers.dev | bash
```

<Callout type="warn">
  Windows用户：您必须首先安装WSL（请参阅[安装依赖项](#install-dependencies)）。然后在Ubuntu（Linux）终端中运行上述命令。
</Callout>

安装后，您应该看到类似以下的输出：

```
已安装版本：
Rust: rustc 1.85.0 (4d91de4e4 2025-02-17)
Solana CLI: solana-cli 2.1.14 (src:3ad46824; feat:3271415109, client:Agave)
Anchor CLI: anchor-cli 0.30.1
Node.js: v23.8.0
Yarn: 1.22.1
```

<Callout>
  如果快速安装命令不起作用，请参阅下面的[安装依赖项](#install-dependencies)部分，了解单独安装每个依赖项的说明。

  如果快速安装命令成功运行，请跳至下面的[Solana CLI基础](#solana-cli-basics)和[Anchor CLI基础](#anchor-cli-basics)部分。
</Callout>

## 安装依赖项

以下说明将指导您单独安装每个依赖项。

* Windows用户必须首先安装WSL（Windows的Linux子系统），然后安装下面Linux部分中指定的依赖项。
* Linux用户应首先安装下面Linux部分中指定的依赖项。
* Mac用户应从下面的Rust安装说明开始。

<Accordions>
  <Accordion title="Windows的Linux子系统（WSL）">
    在Windows上开发Solana程序**你必须使用
    [WSL](https://learn.microsoft.com/en-us/windows/wsl/install)**（Windows
    的Linux子系统）。通过Linux终端安装所有其他依赖项。

    安装WSL后，在继续安装Rust、Solana CLI和Anchor CLI之前，请先通过Linux终端安装下面Linux部分中指定的依赖项。

    要安装WSL，请在Windows PowerShell中运行以下命令：

    ```terminal
    $ wsl --install
    ```

    安装过程会提示你创建一个默认用户账户。

    ![WSL Install](/assets/docs/intro/installation/wsl-install.png)

    默认情况下，WSL安装Ubuntu。你可以通过在搜索栏中搜索"Ubuntu"来打开Linux终端。

    ![WSL Ubuntu](/assets/docs/intro/installation/wsl-ubuntu-search.png)

    如果你的Ubuntu终端看起来像下图，你可能会遇到一个问题，即`ctrl + v`（粘贴快捷键）在终端中不起作用。

    ![Ubuntu Terminal](/assets/docs/intro/installation/wsl-ubuntu-terminal-1.png)

    如果你遇到这个问题，请通过在搜索栏中搜索"Terminal"来打开Windows Terminal。

    ![Windows Terminal](/assets/docs/intro/installation/wsl-windows-terminal.png)

    接下来，关闭Windows Terminal并通过再次搜索Ubuntu重新打开Linux终端。现在终端应该看起来像下图，其中
    `ctrl + v`（粘贴快捷键）可以正常工作。

    ![Ubuntu Terminal](/assets/docs/intro/installation/wsl-ubuntu-terminal-2.png)

    如果你使用VS Code，
    [WSL扩展](https://code.visualstudio.com/docs/remote/wsl-tutorial)使你能够将WSL和VS Code一起使用。

    ![WSL Setup in VS Code](/assets/docs/intro/installation/wsl-vscode.png)

    然后你应该在VS Code状态栏中看到以下内容：

    ![WSL: Ubuntu](/assets/docs/intro/installation/wsl-vscode-ubuntu.png)

    一旦你设置好WSL，通过Ubuntu（Linux）终端安装所有其他依赖项。

    要安装所需的Solana依赖项，首先尝试在Ubuntu（Linux）终端中运行
    [快速安装](#quick-installation)命令。

    <Callout>
      如果快速安装命令不起作用，请在继续进行安装Rust、Solana CLI和Anchor CLI的各个步骤之前，先安装Linux部分中指定的依赖项。

      如果快速安装命令成功运行，请跳至
      [Solana CLI 基础](#solana-cli-basics)和
      [Anchor CLI 基础](#anchor-cli-basics)部分。
    </Callout>
  </Accordion>

  <Accordion title="Linux">
    Anchor CLI 安装需要以下依赖项。

    首先，运行以下命令：

    ```terminal
    $ sudo apt-get update
    ```

    接下来，安装以下依赖项：

    ```terminal
    $ sudo apt-get install -y \
        build-essential \
        pkg-config \
        libudev-dev llvm libclang-dev \
        protobuf-compiler libssl-dev
    ```

    如果在安装`protobuf-compiler`时遇到以下错误，请确保先运行*shell`sudo apt-get update`*：

    ```
    Package protobuf-compiler is not available, but is referred to by another package.
    This may mean that the package is missing, has been obsoleted, or
    is only available from another source
    ```
  </Accordion>
</Accordions>

<Steps>
  <Step>
    ### 安装 Rust

    开发者使用
    [Rust 编程语言](https://www.rust-lang.org/)构建 Solana 程序。

    使用[rustup](https://www.rust-lang.org/tools/install)安装 Rust。

    运行以下命令安装Rust：

    ```terminal
    $ curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh -s -- -y
    ```

    安装完成后，您应该看到以下信息：

    <Accordions>
      <Accordion title="Rust安装成功信息">
        ```
        Rust is installed now. Great!

        To get started you may need to restart your current shell.
        This would reload your PATH environment variable to include
        Cargo's bin directory ($HOME/.cargo/bin).

        To configure your current shell, you need to source
        the corresponding env file under $HOME/.cargo.

        This is usually done by running one of the following (note the leading DOT):
        . "$HOME/.cargo/env"            # For sh/bash/zsh/ash/dash/pdksh
        source "$HOME/.cargo/env.fish"  # For fish
        ```
      </Accordion>
    </Accordions>

    运行以下命令重新加载您的PATH环境变量，以包含Cargo的bin目录：

    ```terminal
    $ . "$HOME/.cargo/env"
    ```

    要验证安装是否成功，请检查Rust版本：

    ```terminal
    $ rustc --version
    ```

    您应该看到类似以下的输出：

    ```
    rustc 1.84.1 (e71f9a9a9 2025-01-27)
    ```
  </Step>

  <Step>
    ### 安装Solana CLI

    Solana CLI提供了构建和部署Solana程序所需的所有工具。

    使用官方安装命令安装Solana CLI工具套件：

    ```terminal
    $ sh -c "$(curl -sSfL https://release.anza.xyz/stable/install)"
    ```

    您可以将`stable`替换为与您所需发布版本软件版本匹配的发布标签（例如`v2.0.3`），或使用三个符号通道名称之一：`stable`、`beta`或`edge`。

    首次安装Solana命令行界面时，您可能会看到以下消息，提示您添加`PATH`环境变量：

    ```
    关闭并重新打开您的终端以应用PATH更改，或在当前shell中运行以下命令：

    export PATH="/Users/test/.local/share/solana/install/active_release/bin:$PATH"
    ```

    <Tabs groupId="language" items={["Linux", "Mac"]}>
      <Tab value="Linux">
        如果您使用的是**Linux**或**WSL**，您需要将Solana CLI二进制文件添加到您的`PATH`中，以便该命令在您的终端中可用。

        首先，运行以下命令检查您正在使用的shell：

        ```terminal
        $ echo $SHELL
        ```

        * 如果输出包含`/bash`，使用`.bashrc`。
        * 如果输出包含`/zsh`，使用`.zshrc`。

        根据您的shell，运行相应的命令。

        对于Bash（`bashrc`）：

        ```terminal
        $ echo 'export PATH="$HOME/.local/share/solana/install/active_release/bin:$PATH"' >> ~/.bashrc
        $ source ~/.bashrc
        ```

        对于Zsh（`zshrc`）：

        ```terminal
        $ echo 'export PATH="$HOME/.local/share/solana/install/active_release/bin:$PATH"' >> ~/.zshrc
        $ source ~/.zshrc
        ```

        然后运行以下命令刷新终端会话或重启您的终端。

        ```terminal
        $ source ~/.bashrc # 如果使用Bash
        $ source ~/.zshrc # 如果使用Zsh
        ```
      </Tab>

      <Tab value="Mac">
        如果您使用带有`zsh`的Mac，运行安装过程中记录的默认`export PATH`命令在关闭终端后不会持续生效。

        相反，您可以通过运行以下命令将PATH添加到您的shell配置文件中：

        ```terminal
        $ echo 'export PATH="$HOME/.local/share/solana/install/active_release/bin:$PATH"' >> ~/.zshrc
        ```

        然后运行以下命令刷新终端会话或重启您的终端。

        ```terminal
        $ source ~/.zshrc
        ```
      </Tab>
    </Tabs>

    要验证安装是否成功，请检查Solana CLI版本：

    ```terminal
    $ solana --version
    ```

    您应该看到类似以下的输出：

    ```
    solana-cli 2.0.26 (src:3dccb3e7; feat:607245837, client:Agave)
    ```

    您可以在
    [Agave Github仓库](https://github.com/anza-xyz/agave/releases)中查看所有可用版本。

    <Callout>
      Agave是来自[Anza](https://www.anza.xyz/)的验证节点客户端，前身为Solana Labs验证节点客户端。
    </Callout>

    要将Solana CLI更新到最新版本，您可以使用以下命令：

    ```terminal
    $ agave-install update
    ```
  </Step>

  <Step>
    ### 安装Anchor CLI

    [Anchor](https://www.anchor-lang.com/)是一个用于开发Solana程序的框架。Anchor框架利用Rust宏来简化编写Solana程序的过程。

    您可以通过两种方式安装Anchor CLI和工具：

    1. Anchor版本管理器(AVM) - 推荐的安装方法
    2. 不使用AVM - 直接从GitHub安装

    <Tabs groupId="anchor" items={["AVM", "Without AVM"]}>
      <Tab value="AVM">
        Anchor版本管理器(AVM)允许您在系统上安装和管理不同的Anchor版本，并在未来轻松更新Anchor版本。

        使用以下命令安装AVM：

        ```terminal
        $ cargo install --git https://github.com/coral-xyz/anchor avm --force
        ```

        确认 AVM 安装成功：

        ```terminal
        $ avm --version
        ```

        使用 AVM 安装最新版本的 Anchor CLI：

        ```terminal
        $ avm install latest
        $ avm use latest
        ```

        您可以通过指定版本号来安装特定版本的 Anchor CLI：

        ```terminal
        $ avm install 0.30.1
        $ avm use 0.30.1
        ```

        <Callout type="info">
          别忘了运行 *shell`avm use`* 命令来声明系统上要运行的 Anchor CLI 版本。

          * 如果您安装了 `latest` 版本，请运行 *shell`avm use latest`*。
          * 如果您安装了版本 `0.30.1`，请运行 *shell`avm use 0.30.1`*。
        </Callout>
      </Tab>

      <Tab value="不使用 AVM">
        使用以下命令安装特定版本的Anchor CLI：

        ```terminal
        $ cargo install --git https://github.com/coral-xyz/anchor --tag v0.30.1 anchor-cli
        ```
      </Tab>
    </Tabs>

    要验证安装是否成功，请检查Anchor CLI版本：

    ```terminal
    $ anchor --version
    ```

    您应该看到类似以下的输出：

    ```
    anchor-cli 0.30.1
    ```

    <Callout type="warn">
      在Linux或WSL上安装Anchor CLI时，您可能会遇到此错误：

      ```
      error: could not exec the linker cc = note: Permission denied (os error 13)
      ```

      如果您看到此错误信息：

      1. 安装本页顶部
         [Linux](/docs/intro/installation#install-dependencies) 部分列出的依赖项。
      2. 重新尝试安装Anchor CLI。
    </Callout>

    #### Node.js和Yarn

    使用
    *shell`anchor init`* 命令创建的默认Anchor项目测试文件（TypeScript）需要Node.js和Yarn。（使用 *shell`anchor init --test-template rust`* 可获得Rust测试模板）

    <Accordions>
      <Accordion title="Node安装">
        使用 [Node版本管理器（nvm）](https://github.com/nvm-sh/nvm)。

        使用以下命令安装 nvm：

        ```terminal
        $ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/master/install.sh | bash
        ```

        重启终端并确认 nvm 命令运行成功：

        ```terminal
        $ command -v nvm
        ```

        接下来，使用 `nvm` 安装 node：

        ```terminal
        $ nvm install node
        ```

        要验证安装是否成功，请检查 Node 版本：

        ```terminal
        $ node --version
        ```

        你应该看到类似以下的输出：

        ```
        v23.7.0
        ```
      </Accordion>

      <Accordion title="Yarn 安装">
        安装 Yarn：

        ```terminal
        $ npm install --global yarn
        ```

        要验证安装是否成功，请检查 Yarn 版本：

        ```terminal
        $ yarn --version
        ```

        你应该看到以下输出：

        ```
        1.22.1
        ```
      </Accordion>
    </Accordions>

    <Callout type="警告">
      运行 `anchor build` 时，如果遇到以下错误：

      <Accordions>
        <Accordion title="error: not a directory">
          ```
          错误：不是一个目录：'.../solana-release/bin/sdk/sbf/dependencies/platform-tools/rust/lib'
          ```

          尝试以下解决方案：

          1. 使用以下命令强制安装：

          ```terminal
          $ cargo build-sbf --force-tools-install
          ```

          2. 如果上述解决方案不起作用，请清除Solana缓存：

          ```terminal
          $ rm -rf ~/.cache/solana/*
          ```
        </Accordion>

        <Accordion title="锁定文件版本4需要`-Znext-lockfile-bump">
          你可以通过将`Cargo.lock`文件中的版本字段从4改为3来修复这个问题：

          ```diff title="Cargo.lock"
          -version = 4
          +version = 3
          ```

          查看[此问题](https://github.com/coral-xyz/anchor/issues/3392)获取更多
          信息。
        </Accordion>
      </Accordions>

      应用上述解决方案后，尝试再次运行*shell`anchor build`*
      命令。
    </Callout>

    <Callout type="警告">
      在Linux或WSL上创建新的Anchor项目后运行*shell`anchor test`*&#x65F6;，
      如果你没有安装Node.js或Yarn，可能会遇到以下错误：

      ```
      权限被拒绝（操作系统错误13）
      ```

      ```
      没有这样的文件或目录（操作系统错误2）
      ```
    </Callout>
  </Step>
</Steps>

## Solana CLI 基础

本节将引导您了解一些常用的 Solana CLI 命令，帮助您入门。

<Steps>
  <Step>
    ### Solana 配置

    查看当前配置：

    ```terminal
    $ solana config get
    ```

    您应该会看到类似以下的输出：

    ```
    Config File: /Users/test/.config/solana/cli/config.yml
    RPC URL: https://api.mainnet-beta.solana.com
    WebSocket URL: wss://api.mainnet-beta.solana.com/ (computed)
    Keypair Path: /Users/test/.config/solana/id.json
    Commitment: confirmed
    ```

    RPC URL 和 Websocket URL 指定了 CLI 向其发送请求的 Solana 集群。

    您可以使用以下命令更新 Solana CLI 集群：

    ```terminal
    $ solana config set --url mainnet-beta
    $ solana config set --url devnet
    $ solana config set --url localhost
    $ solana config set --url testnet
    ```

    您也可以使用以下简短选项：

    ```terminal
    $ solana config set -um    # 用于主网测试版
    $ solana config set -ud    # 用于开发网
    $ solana config set -ul    # 用于本地主机
    $ solana config set -ut    # 用于测试网
    ```

    密钥对路径指向 Solana CLI 用于支付交易费用和部署程序的默认 Solana 钱包（密钥对）。默认情况下，该文件存储在`~/.config/solana/id.json`。
  </Step>

  <Step>
    ### 创建钱包

    要使用 Solana CLI 发送交易，您需要一个充值了 SOL 的 Solana 钱包。

    要在默认密钥对路径生成密钥对，请运行以下命令：

    ```terminal
    $ solana-keygen new
    ```

    您应该会看到类似以下的输出：

    ```
    Generating a new keypair

    For added security, enter a BIP39 passphrase

    NOTE! This passphrase improves security of the recovery seed phrase NOT the
    keypair file itself, which is stored as insecure plain text

    BIP39 Passphrase (empty for none):

    Wrote new keypair to /Users/test/.config/solana/id.json
    ===========================================================================
    pubkey: 8dBTPrjnkXyuQK3KDt9wrZBfizEZijmmUQXVHpFbVwGT
    ===========================================================================
    Save this seed phrase and your BIP39 passphrase to recover your new keypair:
    cream bleak tortoise ocean nasty game gift forget fancy salon mimic amazing
    ===========================================================================
    ```

    <Callout type="info">
      如果您已经在默认位置保存了文件系统钱包，此命令不会覆盖它，除非您使用`--force`标志显式强制覆盖。
    </Callout>

    要查看您钱包的地址（公钥），请运行：

    ```terminal
    $ solana address
    ```
  </Step>

  <Step>
    ### 空投 SOL

    请求向您的钱包空投 SOL 以支付交易和程序部署费用。

    将您的集群设置为开发网络：

    ```terminal
    $ solana config set -ud
    ```

    然后请求开发网络 SOL 的空投：

    ```terminal
    $ solana airdrop 2
    ```

    <Callout>
      开发网络空投每次请求限制为 5 SOL。如果您遇到速率限制或错误，请尝试使用[网页水龙头](https://faucet.solana.com)代替。
    </Callout>

    要检查您钱包的 SOL 余额，请运行以下命令：

    ```terminal
    $ solana balance
    ```
  </Step>

  <Step>
    ### 运行本地验证器

    Solana CLI 包含内置的[测试验证器](https://docs.anza.xyz/cli/examples/test-validator)，用于本地开发。

    在另一个终端中，运行以下命令启动本地验证器：

    ```terminal
    $ solana-test-validator
    ```

    <Callout>
      在运行 Solana CLI 命令之前，请记得更新您的 CLI 以使用本地主机：

      ```terminal
      $ solana config set -ul
      ```
    </Callout>
  </Step>
</Steps>

## Anchor CLI 基础

本节将介绍一些常用的 Anchor CLI 命令，帮助你入门。有关 Anchor
CLI 的更多信息，请参阅 [Anchor 文档](https://www.anchor-lang.com/docs)。

<Steps>
  <Step>
    ### 初始化项目

    要创建一个新的 Anchor 项目，请运行以下命令：

    ```terminal
    $ anchor init <project-name>
    ```

    例如，要创建一个名为 `my-project` 的项目，运行：

    ```terminal
    $ anchor init my-project
    ```

    此命令会创建一个新目录，使用项目名称并初始化一个新的 Anchor 项目，其中包含基本的 Rust 程序和 TypeScript 测试模板。

    导航到项目目录：

    ```terminal
    $ cd <project-name>
    ```

    查看 Anchor 项目的
    [文件结构](https://www.anchor-lang.com/docs/quickstart/local#project-file-structure)。
  </Step>

  <Step>
    ### 构建程序

    要构建你的项目，运行以下命令：

    ```terminal
    $ anchor build
    ```

    你可以在 `/target/deploy` 目录中找到编译后的程序。
  </Step>

  <Step>
    ### 部署程序

    要部署你的项目，运行以下命令：

    ```terminal
    $ anchor deploy
    ```

    此命令将您的程序部署到`集群`中，该集群在
    [`Anchor.toml`](https://www.anchor-lang.com/docs/references/anchor-toml)文件中指定。
  </Step>

  <Step>
    ### 测试程序

    要测试您的项目，请运行以下命令：

    ```terminal
    $ anchor test
    ```

    <Callout>
      此命令构建、部署并运行项目的测试。

      当在`localnet`作为`集群`在`Anchor.toml`中使用时，Anchor会自动
      启动本地验证器，部署您的程序，运行测试，然后停止
      验证器。
    </Callout>
  </Step>
</Steps>
