---
title: 交易费用
description:
  了解Solana的交易费用，包括基础费用和优先费用，
  每种费用的应用方式，以及在交易中管理计算单元的最佳实践。
---

每笔Solana交易都需要支付基础费用（SOL），以补偿验证者处理交易的成本。还可以选择支付优先费用，以提高交易被当前领导者（验证者）处理的概率。

## 关键点

- 交易的**基础费用**为每个签名至少5000个lamports。
- **优先费用**（可选）是支付给验证者的额外费用，以提高交易被处理的概率。
- 优先费用的计算方式为：**（计算单元限制 \* 计算单元价格）**。
- **计算单元限制**是交易可以消耗的最大计算单元数量。
- **计算单元价格**是每个计算单元的价格，以微lamports计。
- 1,000,000微lamports = 1 lamport
- 交易费用的支付者必须是由系统程序拥有的账户。

## 基础交易费用

基础费用是发送交易的最低成本。每个签名的费用为5000个lamports。

基础费用由交易费用支付者自动支付，交易费用支付者是交易中的第一个签名者。费用支付者必须是由系统程序拥有的账户。

- [50% 被销毁](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/fee-calculator/src/lib.rs#L70)：
  一半的基础费用被销毁。
- [50% 分配](https://github.com/anza-xyz/agave/blob/e621336acad4f5d6e5b860eaa1b074b01c99253c/runtime/src/bank/fee_distribution.rs#L58-L62)：
  一半支付给处理交易的验证者。

## 优先费用

优先费用是支付给验证者的可选费用，以提高交易被处理的概率。

- [SIMD-0096](https://github.com/solana-foundation/solana-improvement-documents/blob/main/proposals/0096-reward-collected-priority-fee-in-entirety.md)：
  100%的优先费用直接支付给处理交易的验证者。

### 计算单元和限制

当交易被执行时，它消耗以计算单元（CU）计量的计算资源。每个指令都会从交易的计算单元预算中扣除。

- 最大限制：一笔交易最多可以使用
  [140万个计算单元](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget_limits.rs#L14)。
- 默认限制：默认情况下，每个指令限制为
  [200,000个计算单元](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget_limits.rs#L10)。
- 自定义限制：您可以通过在交易中包含`SetComputeUnitLimit`指令来请求特定的计算单元限制。

有关计算单元使用的更多详细信息：

- [ComputeBudget 类型](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget.rs#L22-L130)
- [计算单元消耗默认值](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget.rs#L149-L197)

请参考
[如何请求最佳计算](/developers/guides/advanced/how-to-request-optimal-compute)
指南以获取有关计算单元使用的更多详细信息。

### 计算单元价格

计算单元价格以微lamports计，是计算优先费用时每个计算单元支付的可选价格。

<Callout>1,000,000微lamports = 1 lamport</Callout>

使用以下资源获取当前计算单元价格的实时建议：

- [优先费用API](https://docs.helius.dev/solana-apis/priority-fee-api) 由Helius提供
- [全球优先费用跟踪器](https://triton.one/solana-prioritization-fees/) 由Triton提供

请参考
[如何使用优先费用](/developers/guides/advanced/how-to-use-priority-fees)
指南以获取有关优先费用的更多详细信息。

### 计算优先费用

优先费用的计算方式为：

**优先费用 = 计算单元限制 × 计算单元价格**

使用以下指令在交易中设置计算单元限制和价格：

- [`SetComputeUnitLimit`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/compute_budget.rs#L42-L44)
  设置特定的单元限制。
- [`SetComputeUnitPrice`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/compute_budget.rs#L48-L50)
  定义每个计算单元的价格。

<Callout>

如果未提供这些指令，交易将自动使用默认的计算单元限制，计算单元价格为0（无优先费用）。

优先费用基于交易请求的计算单元，而不是交易实际使用的计算单元。如果您设置的计算单元限制过高或使用默认金额，您可能会为未使用的计算单元支付费用。

</Callout>

### 示例

以下是用于设置交易的计算单元限制和价格的指令示例。

#### Rust

`solana-sdk`通过
[`ComputeBudgetInstruction`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/compute_budget.rs#L17-L31)
类型提供方法：

```rust
let limit_instruction = ComputeBudgetInstruction::set_compute_unit_limit(300_000);

let price_instruction = ComputeBudgetInstruction::set_compute_unit_price(1);
```

#### JavaScript

`@solana/web3.js`库（v1）通过
[`ComputeBudgetProgram`](https://solana-labs.github.io/solana-web3.js/v1.x/classes/ComputeBudgetProgram.html)
类提供方法：

```js
const limitInstruction = ComputeBudgetProgram.setComputeUnitLimit({
  units: 300_000,
});

const priceInstruction = ComputeBudgetProgram.setComputeUnitPrice({
  microLamports: 1,
});
```
