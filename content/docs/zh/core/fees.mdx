---
title: 交易费用
description: 了解Solana的交易费用，包括基础费用和优先级费用，它们各自的应用方式，以及在交易中管理计算单元的最佳实践。
---

每笔Solana交易都需要支付基本费用（SOL）以补偿验证者处理交易的工作。用户还可以选择支付优先级费用，以提高当前主导验证者处理该交易的概率。

## 要点

- 交易的**基本费用**最低为每个交易签名5000 lamport。
- **优先级费用**（可选）是支付给验证者的额外费用，用于提高交易被处理的概率。
- 优先级费用的计算方式为：**（计算单元限制 \* 计算单元价格）**。
- **计算单元限制**是交易可以消耗的最大计算单元数。
- **计算单元价格**是每个计算单元的价格，以微lamport计。
- 1,000,000微lamport = 1 lamport
- 交易费用支付者必须是由System Program拥有的账户。

## 基本交易费用

基本费用是发送交易的最低成本。费用为交易中包含的每个签名5000 lamport。

基本费用自动由交易费用支付者支付，该支付者是交易的第一个签名者。费用支付者必须是由System
Program拥有的账户。

- [50%销毁](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/fee-calculator/src/lib.rs#L70)：基本费用的一半被销毁。
- [50%分配](https://github.com/anza-xyz/agave/blob/e621336acad4f5d6e5b860eaa1b074b01c99253c/runtime/src/bank/fee_distribution.rs#L58-L62)：另一半支付给处理该交易的验证者。

## 优先级费用

优先级费用是支付给验证者的可选费用，用于提高交易被处理的概率。

- [SIMD-0096](https://github.com/solana-foundation/solana-improvement-documents/blob/main/proposals/0096-reward-collected-priority-fee-in-entirety.md)：100%的优先级费用直接支付给处理交易的验证者。

### 计算单元和限制

当执行交易时，它会消耗以计算单元（CU）衡量的计算资源。每条指令都会从交易的计算单元预算中扣除。

- 最大限制：一个交易最多可以使用[140万计算单元](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget_limits.rs#L14)。
- 默认限制：默认情况下，每条指令限制为[200,000计算单元](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget_limits.rs#L10)。
- 自定义限制：您可以通过在交易中包含`SetComputeUnitLimit`指令来请求特定的计算单元限制。

有关计算单元使用的更多详细信息：

- [ComputeBudget类型](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget.rs#L22-L130)
- [计算单元消耗默认值](https://github.com/anza-xyz/agave/blob/v2.1.13/compute-budget/src/compute_budget.rs#L149-L197)

参考

[如何请求最佳计算资源](/developers/guides/advanced/how-to-request-optimal-compute)

指南获取有关计算单元使用的更多详细信息。

### 计算单元价格

计算单元价格以微lamport为单位，是计算优先级费用的可选价格。

<Callout>1,000,000微lamport = 1 lamport</Callout>

使用以下资源获取当前计算单元价格的实时建议：

- Helius提供的[优先级费用API](https://docs.helius.dev/solana-apis/priority-fee-api)
- Triton提供的[全球优先级费用追踪器](https://triton.one/solana-prioritization-fees/)

参考

[如何使用优先级费用](/developers/guides/advanced/how-to-use-priority-fees)

指南获取有关优先级费用的更多详细信息。

### 计算优先级费用

优先级费用的计算方式为：

**优先级费用 = 计算单元限制 × 计算单元价格**

使用以下指令在交易中设置计算单元限制和价格：

- [`SetComputeUnitLimit`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/compute_budget.rs#L42-L44)设置特定的单元限制。
- [`SetComputeUnitPrice`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/compute_budget.rs#L48-L50)定义每个计算单元的价格。

<Callout>

如果未提供这些指令，交易将自动使用默认计算单元限制，计算单元价格为0（无优先级费用）。

优先级费用基于交易请求的计算单元，而不是交易实际使用的计算单元。如果您设置的计算单元限制过高或使用默认数量，您可能会为未使用的计算单元付费。

</Callout>

### 示例

以下是设置交易计算单元限制和价格的指令示例。

#### Rust

通过 `solana-sdk` 提供的

[`ComputeBudgetInstruction`](https://github.com/anza-xyz/agave/blob/v2.1.13/sdk/src/compute_budget.rs#L17-L31)

类型可以使用以下方法：

```rust
let limit_instruction = ComputeBudgetInstruction::set_compute_unit_limit(300_000);

let price_instruction = ComputeBudgetInstruction::set_compute_unit_price(1);
```

#### JavaScript

在 `@solana/web3.js` 库（v1版本）中，可以通过

[`ComputeBudgetProgram`](https://solana-labs.github.io/solana-web3.js/v1.x/classes/ComputeBudgetProgram.html)

类使用以下方法：

```js
const limitInstruction = ComputeBudgetProgram.setComputeUnitLimit({
  units: 300_000
});

const priceInstruction = ComputeBudgetProgram.setComputeUnitPrice({
  microLamports: 1
});
```
