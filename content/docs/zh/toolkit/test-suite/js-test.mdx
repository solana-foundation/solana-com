---
title: JavaScript 测试
seoTitle: 如何使用 JavaScript/TypeScript 测试 Solana 程序
description:
  如何使用 Solana bankrun 在 JavaScript 和 NodeJS 中为 Solana 程序编写快速测试
keywords:
  - solana javascript 测试
  - solana 测试
  - solana bankrun
  - bankrun 测试
  - bankrun 示例
  - solana 测试示例
h1: Solana 的 JavaScript 测试框架
---

> 这是 [Solana 工具包](/docs/toolkit/)
> 的测试版，仍在开发中（WIP）。请将所有反馈作为 GitHub 问题发布
> [这里](https://github.com/solana-foundation/mucho/issues/new?title=%5Btoolkit%5D%20)。

## 添加依赖

导航到您的程序目录并运行：

```shell
npm install solana-bankrun
```

## Bankrun 概述

[Bankrun](https://github.com/kevinheavey/solana-bankrun)
是一个快速且轻量的框架，用于在 NodeJS 中测试 Solana 程序。

它使用
[`solana-program-test`](https://crates.io/crates/solana-program-test)
crate 作为底层支持，并允许您执行其他工具无法实现的操作，例如在时间上前后跳转或动态设置账户数据。

Bankrun 通过启动一个轻量级的 `BanksServer`，类似于一个 RPC 节点但速度更快，并创建一个 `BanksClient` 与服务器通信。它运行 Solana 的
[Banks](https://github.com/solana-labs/solana/blob/master/runtime/src/bank.rs)。

## 最小示例

```javascript
import { start } from "solana-bankrun";
import { PublicKey, Transaction, SystemProgram } from "@solana/web3.js";

test("one transfer", async () => {
  const context = await start([], []);
  const client = context.banksClient;
  const payer = context.payer;
  const receiver = PublicKey.unique();
  const blockhash = context.lastBlockhash;
  const transferLamports = 1_000_000n;
  const ixs = [
    SystemProgram.transfer({
      fromPubkey: payer.publicKey,
      toPubkey: receiver,
      lamports: transferLamports,
    }),
  ];
  const tx = new Transaction();
  tx.recentBlockhash = blockhash;
  tx.add(...ixs);
  tx.sign(payer);
  await client.processTransaction(tx);
  const balanceAfter = await client.getBalance(receiver);
  expect(balanceAfter).toEqual(transferLamports);
});
```

## 其他资源

- [Bankrun 文档](https://kevinheavey.github.io/solana-bankrun/)
- [Bankrun 源代码](https://github.com/kevinheavey/solana-bankrun)
- [官方 Bankrun 教程](https://kevinheavey.github.io/solana-bankrun/tutorial/)
- [完整项目示例](https://github.com/solana-developers/developer-bootcamp-2024/tree/main/project-2-voting/anchor/tests)
