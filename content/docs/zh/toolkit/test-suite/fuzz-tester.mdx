---
title: 模糊测试工具
seoTitle: 如何为 Solana 程序进行模糊测试
description: 如何使用 Rust 为 Solana 程序创建模糊测试
keywords:
  - solana 模糊测试
  - solana 模糊测试工具
  - 模糊测试
h1: Solana 模糊测试工具
---

> 这是 [Solana 工具包](/docs/toolkit/)
> 的测试版，仍在开发中（WIP）。请将所有反馈作为 GitHub 问题发布
> [这里](https://github.com/solana-foundation/mucho/issues/new?title=%5Btoolkit%5D%20)。

> Trident 模糊测试工具仍在开发中（WIP），目前仅兼容 Anchor，可能需要一些手动操作来完成测试。

## 初始化模糊测试

导航到基于 Anchor 的工作区并运行：

```shell
trident init
```

此命令执行以下操作：

- 构建基于 Anchor 的项目。
- 读取生成的 IDL。
- 基于 IDL 创建模糊测试模板。

## 定义模糊账户

为每个您希望使用的 `AccountsStorage` 类型定义 `Account`：

```rust
#[doc = r" Use AccountsStorage<T> where T can be one of:"]
#[doc = r" Keypair, PdaStore, TokenStore, MintStore, ProgramStore"]
#[derive(Default)]
pub struct FuzzAccounts {
    author: AccountsStorage<Keypair>,
    hello_world_account: AccountsStorage<PdaStore>,
    // No need to fuzz system_program
    // system_program: AccountsStorage<todo!()>,
}
```

## 实现模糊指令

模糊测试中的每个指令都需要定义以下函数：

- `get_program_id()` 指定指令所属的程序。此函数会自动定义，通常无需更新。特别是在您的工作区中有多个程序时，这一点非常重要，它允许 Trident 生成对应于不同程序的指令序列。
- `get_data()` 指定发送到程序指令的输入。
- `get_accounts()` 指定发送到程序指令的账户。

## 执行模糊测试

```shell
# Replace <TARGET_NAME> with the name of the
# fuzz test (for example: "fuzz_0")
trident fuzz run-hfuzz <TARGET_NAME>
```

## 调试模糊测试

```shell
# fuzzer will run the <TARGET_NAME> with the specified <CRASH_FILE_PATH>
trident fuzz debug-hfuzz <TARGET_NAME> <CRASH_FILE_PATH>
```

有关更多文档，请访问 [这里](https://ackee.xyz/trident/docs/latest/)。

## 其他资源

- [Fuzz Tester 源代码](https://github.com/Ackee-Blockchain/trident)。
