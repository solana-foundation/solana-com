---
title: دليل تكامل المبلغ المقياسي للواجهة
description: تعلم كيفية دمج رمز يستخدم امتداد المبلغ المقياسي للواجهة في تطبيقك.
---

# دعم امتداد المبلغ المقياسي للواجهة على سولانا

## الخلفية

تم إطلاق امتداد جديد للرمز يسمى "المبلغ المقياسي للواجهة" مؤخرًا والذي يسمح
لمصدري الرموز بتحديد مضاعف لاستخدامه عند حساب مبلغ واجهة المستخدم لرصيد الرمز
الخاص بالمستخدم. هذا يمكّن المصدرين من إنشاء رموز قابلة لإعادة التأسيس وتمكين
أشياء مثل تقسيم الأسهم. هذا الامتداد، مثل امتداد الرمز الحامل للفائدة، يوفر مبلغ
واجهة تجميلي بحت. الحسابات والتحويلات الأساسية تتم جميعها باستخدام المبالغ الخام
في البرنامج.

### الموارد:

- [وثائق المطورين](https://www.solana-program.com/docs/token-2022/extensions#scaled-ui-amount)
- [كود راست للامتداد](https://github.com/solana-program/token-2022/tree/main/program/src/extension/scaled_ui_amount)
- [كود راست لتحويل المبلغ إلى مبلغ واجهة المستخدم](https://github.com/solana-program/token-2022/blob/main/program/src/processor.rs#L1425)

## الأهداف

- توفير أفضل تجربة مستخدم للمستخدمين النهائيين
- توفير إرشادات واضحة ومباشرة للفرق لإنشاء تجربة موحدة للرموز الحاملة للفائدة
  عبر النظام البيئي
- تحديد وتخطيط العمل لتقليل الجهد الذي يتعين على الفرق القيام به للتكامل مع
  امتداد المبلغ المقياسي للواجهة

## ملخص سريع

- يجب أن يتفاعل المستخدمون النهائيون مع مبلغ الواجهة (المبلغ الخام × المضاعف)
  لسعر الرمز، ورصيد الرمز، ومبالغ الرمز كلما أمكن ذلك
- يجب على التطبيقات اللامركزية ومقدمي الخدمات استخدام المبلغ الخام والأسعار غير
  المقياسية لجميع الحسابات والتحويل للمستخدمين عند الحافة
- يجب توفير تغذيات الأسعار التاريخية لكل من المبالغ المقياسية وغير المقياسية
  لتسهيل التكامل
- يجب أن تكون قيم المضاعف التاريخية متاحة للوصول إليها للحصول على بيانات تاريخية
  دقيقة

## تعريفات المصطلحات

- المضاعف: مضاعف ثابت قابل للتحديث يُستخدم لحسابات المبلغ في واجهة المستخدم
- مبلغ واجهة المستخدم: المضاعف × المبلغ الخام (أي: المبلغ المقياس)
- المبلغ الخام: المبلغ (أي: المبلغ غير المقياس)

## الرصيد الحالي

### المبلغ الحالي للعرض

- في أي وقت تعرض فيه مبالغ للرموز التي تستخدم امتداد مبلغ واجهة المستخدم المقياس
  للمستخدمين النهائيين، يجب عليك استخدام إما:
  - UIAmount/UIAmountString (**_مفضل_**)
  - حساب يدوي للمبلغ الخام × المضاعف
  - نوصي باقتطاع هذه القيمة بناءً على عدد المنازل العشرية التي يمتلكها الرمز.
    - مثال: إذا كان لـ yUSD 6 منازل عشرية ولدى المستخدم UIAmount بقيمة
      1.123456789، فيجب عرض "1.123456"

### من أين تحصل على هذه البيانات:

- للحصول على رصيد المستخدم المباشر، يمكنك الحصول على معلومات محدثة حول المبالغ
  المذكورة أعلاه عن طريق استدعاء إما getTokenAccountBalance أو getAccountInfo
- إذا كنت بحاجة إلى معرفة مبلغ واجهة المستخدم لمبلغ عشوائي، يمكنك الحصول على هذا
  الحساب عن طريق استدعاء الدالة
  [`amountToUiAmountForMintWithoutSimulation`](https://github.com/solana-program/token-2022/blob/main/clients/js-legacy/src/actions/amountToUiAmount.ts#L164)
  (web3.js v1) أو محاكاة معاملة باستخدام amountToUiAmount.
  - ملاحظة: يتطلب amountToUiAmount محاكاة معاملة مما يعني أنه يحتاج أيضًا إلى
    دافع رسوم صالح برصيد. لهذا السبب، يجب ألا تكون هذه الطريقة الافتراضية للحصول
    على الرصيد.

### تحديث المبلغ الحالي

نظرًا لأن المصدرين يمكنهم تحديث المضاعف في أي وقت، يمكنك التفكير في الاستعلام
بشكل دوري للحفاظ على تحديث رصيد الحساب. من غير المرجح أن يقوم المصدرون بتحديث
هذا المضاعف أكثر من مرة واحدة في اليوم. إذا تم تعيين مضاعف لتاريخ مستقبلي، يمكنك
الاستعلام تلقائيًا في وقت التحديث هذا

## مبالغ الرموز في المعاملات (التحويلات / المبادلات إلخ)

- يجب على المستخدمين إدخال المبالغ ليتم تفسيرها على أنها "UIAmount" المقياسي.
  يجب على التطبيق الذي سيعالج هذا تحويله إلى المبلغ الخام للرمز المميز للمعاملة.
  - إذا كانت هناك مشكلات في التقريب، قم بالتقريب لأسفل ويفضل ترك كمية صغيرة من
    البقايا بدلاً من المخاطرة بفشل المعاملة
  - للقيام بهذا التحويل يمكنك استخدام الدالة
    [`uiAmountToAmountForMintWithoutSimulation`](https://github.com/solana-program/token-2022/blob/main/clients/js-legacy/src/actions/amountToUiAmount.ts#L312C23-L312C63)
    (web3.js v1) أو محاكاة معاملة باستخدام amountToUiAmount.
- يجب أن تستخدم التطبيقات المبلغ الإجمالي الخام عندما يطلب المستخدم القيام
  بإجراء مع "الحد الأقصى" أو "كل" رصيدهم. هذا يضمن عدم ترك أي بقايا.
  - اختياري: يمكنك التفكير في إغلاق الحساب تلقائيًا عند استخدام "الحد الأقصى"
    لاسترداد وديعة التخزين للمستخدم

## سعر الرمز المميز

- يجب دائمًا عرض سعر الرمز المميز كسعر مقياسي حيثما أمكن ذلك.
- إذا كنت مزود خدمة تغذية الأسعار، مثل أوراكل، فيجب عليك عرض كل من السعر
  المقياسي وغير المقياسي.
  - حيثما أمكن، قدم SDK/API يجرد تعقيدات امتداد UIAmount المقياسي.

## المضاعف الحالي

- يمكن قراءة المضاعف الحالي من سك الرمز المميز في أي وقت عن طريق استدعاء
  `getAccountInfo`. بالإضافة إلى ذلك، إذا تم تعيين مضاعف مستقبلي، فإن هذه
  المعلومات متاحة أيضًا من سك الرمز المميز. نوصي بعدم إظهار هذا المضاعف لأنه قد
  يربك تجربة المستخدم.

## البيانات التاريخية

### البيانات التاريخية لتغذية الأسعار

- يجب على الخدمات التي توفر بيانات تاريخية تخزين وعرض **كل من الأسعار المقياسية
  وغير المقياسية لامتداد UIAmount المقياسي**.
- نتوقع استخدام المبالغ المقياسية بشكل أكثر تكرارًا حيث يتوافق ذلك مع كيفية
  تعامل عالم التمويل التقليدي مع الرسوم البيانية المتعلقة بالرموز المميزة مع
  تقسيمات الأسهم.

### البيانات التاريخية للمبالغ

- إذا كنت ترغب في إظهار الرصيد المحول في الماضي، فأنت بحاجة إلى الوصول إلى
  المضاعف في ذلك الـ slot المحدد. يمكنك أيضًا حفظ UiAmount للتحويلات أثناء
  معالجة المعاملات لتجنب إجراء هذا الحساب في المستقبل.

## التوافق مع الإصدارات السابقة

- افتراضيًا، المحافظ والتطبيقات التي لا تفهم امتداد مبلغ واجهة المستخدم المقياسي
  ستظهر السعر الإجمالي الصحيح للنشاط من خلال ضرب السعر غير المقياسي × المبلغ
  الخام.
- ومع ذلك، ستعرض السعر غير المقياسي مما قد يسبب بعض الارتباك للمستخدم.
- نأمل أن يشجع هذا الفرق على تحديث تطبيقاتهم اللامركزية لتكون متوافقة مع الرموز
  التي تستخدم امتداد مبلغ واجهة المستخدم المقياسي، ونحن سعداء بتقديم الدعم خلال
  هذه العملية.

## وظائف المساعدة المطلوب إضافتها إلى مكتبة SPL-Token:

- **\[تم\]** تحويل المبلغ إلى UIAmount: توفير وظيفة للحصول على UIAmount في الوقت
  الحالي بناءً على العملة والمبلغ الخام
- **\[تم\]** تحويل UIAmount إلى المبلغ: توفير وظيفة للحصول على المبلغ الخام في
  الوقت الحالي بناءً على العملة وUIAmount
- **\[تم\]** تحويل المبلغ إلى UIAmount لـ: توفير وظيفة للحصول على UIAmount
  لمضاعف وعشري ومبلغ خام معين
- **\[تم\]** تحويل UIAmount إلى المبلغ: توفير وظيفة للحصول على المبلغ الخام لـ
  مضاعف وعشري وUIAmount معين
- **\[مطلوب\]** جميع وظائف المساعدة المذكورة أعلاه لـ @solana/kit

## معايير القبول لكل منصة

### **المتطلبات العامة**

| المتطلب                                | الوصف                                                                                                                                                                                  | الأولوية |
| :------------------------------------- | :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| دعم إجراءات المستخدم باستخدام UiAmount | يجب إدخال جميع إجراءات المستخدم بـ UiAmount عندما يكون UiAmount مفعلاً في جميع أنحاء التطبيق. إذا لم يكن UiAmount مرئيًا في التطبيق، فيجب استخدام المبالغ الخام حتى يتم تحديث التطبيق. | **P0**   |

---

### **المحافظ**

| المتطلب                                | الوصف                                                                                                | الأولوية |
| :------------------------------------- | :--------------------------------------------------------------------------------------------------- | :------- |
| عرض الرصيد المقياسي                    | عرض المبلغ المقياسي (uiAmount) كرصيد أساسي.                                                          | **P0**   |
| دعم تحويلات الرموز                     | يجب على المستخدمين إدخال مبالغ التحويل بأرصدتهم المقياسية (المبلغ الخام \* الرصيد).                  | **P0**   |
| عرض السعر الفوري                       | عرض السعر الفوري المقياسي للمستخدمين                                                                 | **P0**   |
| بيانات وصفية لسجل المعاملات            | عرض المبلغ المقياسي (UIAmount) لكل تحويل حيثما أمكن.                                                 | **P1**   |
| إظهار تحديثات المضاعف في سجل المعاملات | عند حدوث تحديثات المضاعف، يتم عرض ذلك كحدث في سجل معاملات المستخدم بما في ذلك المبلغ المكتسب         | **P2**   |
| عرض رسم بياني لتاريخ الأسعار           | عكس الأسعار المقياسية في الرسم البياني للسعر                                                         | **P1**   |
| التأهيل/تلميحات الأدوات                | تقديم تلميحات أدوات أو تأهيل لتثقيف المستخدمين حول الرموز التي تستخدم امتداد المبلغ المقياسي للواجهة | **P2**   |

---

### **المستكشفات**

| المتطلب                                    | الوصف                                                                    | الأولوية |
| :----------------------------------------- | :----------------------------------------------------------------------- | :------- |
| تحسينات صفحة تفاصيل الرمز                  | عرض البيانات الوصفية مثل إجمالي القيمة السوقية المقياسية والمضاعف الحالي | **P0**   |
| عرض الرصيد المقياسي للأرصدة                | عرض الأرصدة المقياسية (UiAmount) للأرصدة الحالية.                        | **P0**   |
| عرض الرصيد المقياسي للمعاملات              | عرض الأرصدة المقياسية (UiAmount) لمبالغ التحويل للمعاملات التاريخية.     | **P0**   |
| عرض السعر المقياسي للمعاملات               | عرض الأسعار المقياسية للمعاملات السابقة                                  | **P1**   |
| تحليل وعرض معاملات تحديث المضاعف بشكل صحيح | عرض التفاصيل بشكل صحيح حول تحديث المضاعف                                 | **P2**   |

---

### **مجمعات بيانات السوق (مثال: CoinGecko)**

| المتطلب                                         | الوصف                                                                                                      | الأولوية |
| :---------------------------------------------- | :--------------------------------------------------------------------------------------------------------- | :------- |
| تحديثات واجهة برمجة التطبيقات للبيانات المقياسة | توسيع وظائف واجهة برمجة التطبيقات لتشمل تغييرات المضاعف مع مرور الوقت بالإضافة إلى تغذية الأسعار المقياسة. | **P0**   |
| إجمالي المعروض مع تعديل المقياس                 | عند عرض إجمالي المعروض وإجمالي القيمة السوقية، يجب أخذ الأرصدة المقياسة في الاعتبار                        | **P0**   |
| تتبع الأسعار التاريخية                          | توفير رسم بياني تاريخي للأسعار باستخدام السعر المقياس مع مرور الوقت.                                       | **P1**   |
| تتبع المضاعف التاريخي                           | توفير علامات تاريخية لتحديثات المضاعف للرموز ذات الفائدة.                                                  | **P2**   |
| المحتوى التعليمي أو الشروحات                    | تضمين أوصاف موجزة أو تلميحات تشرح كيفية عمل الرموز المقياسة.                                               | **P2**   |

---

### **مزودو تغذية الأسعار**

| المتطلب                               | الوصف                                                                                       | الأولوية |
| :------------------------------------ | :------------------------------------------------------------------------------------------ | :------- |
| تغذيات الأسعار المقياسة وغير المقياسة | توفير تغذيات الأسعار لكل من الأسعار المقياسة وغير المقياسة.                                 | **P0**   |
| بيانات المضاعف التاريخية              | تقديم واجهات برمجة تطبيقات مع تغييرات المضاعف التاريخية.                                    | **P0**   |
| بيانات الأسعار التاريخية              | تقديم واجهات برمجة تطبيقات مع أسعار تاريخية تستند إلى كل من المبالغ المقياسة وغير المقياسة. | **P0**   |

---

### **منصات التبادل اللامركزية**

| المتطلب                          | الوصف                                                                                                               | الأولوية |
| :------------------------------- | :------------------------------------------------------------------------------------------------------------------ | :------- |
| عرض أرصدة الرموز المعاد تقييمها  | عرض الأرصدة المقياسة للتداول أو توفير السيولة على واجهة المستخدم. (يمكن للخلفية الاستمرار في استخدام المبالغ الخام) | **P0**   |
| دعم إجراءات الرموز               | يجب على المستخدمين النهائيين إدخال مبالغ الإجراءات بأرصدة واجهة المستخدم الخاصة بهم (المضاعف × المبلغ الخام).       | **P0**   |
| تكييف تغذية الأسعار              | في أي مكان يتم فيه استخدام تغذية الأسعار لعرض السعر الحالي، يجب توفير السعر المقياس للمستخدمين النهائيين.           | **P1**   |
| عرض الرسم البياني لتاريخ الأسعار | عكس الأسعار المقياسة في الرسم البياني للأسعار                                                                       | **P1**   |
