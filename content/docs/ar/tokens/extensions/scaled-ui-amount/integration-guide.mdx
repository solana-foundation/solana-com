---
title: دليل تكامل المبلغ المقياسي للواجهة
description: تعلم كيفية دمج رمز يستخدم امتداد المبلغ المقياسي للواجهة في تطبيقك.
---

# دعم امتداد المبلغ المقياسي للواجهة على سولانا

## الخلفية

يسمح امتداد مبلغ واجهة المستخدم المقياسي لمصدري الرموز بتحديد مضاعف ليتم
استخدامه عند حساب مبلغ واجهة المستخدم لرصيد الرمز الخاص بالمستخدم. هذا يمكّن
المصدرين من إنشاء رموز قابلة لإعادة التأسيس وتمكين أشياء مثل تقسيم الأسهم. هذا
الامتداد، مثل امتداد الرمز الحامل للفائدة، يوفر مبلغ واجهة مستخدم تجميلي بحت مما
يعني أن الفرق تحتاج إلى القيام ببعض العمل الإضافي لتوفير تجربة جيدة. تتم جميع
العمليات الحسابية والتحويلات الأساسية باستخدام المبالغ الخام في البرنامج.

### الموارد:

- [وثائق المطورين](https://www.solana-program.com/docs/token-2022/extensions#scaled-ui-amount)
- [كود راست للامتداد](https://github.com/solana-program/token-2022/tree/main/program/src/extension/scaled_ui_amount)
- [كود راست لتحويل المبلغ إلى مبلغ واجهة المستخدم](https://github.com/solana-program/token-2022/blob/main/program/src/processor.rs#L1425)

## ملخص سريع

- يجب على المستخدمين النهائيين التفاعل مع مبلغ واجهة المستخدم (المبلغ الخام ×
  المضاعف) لسعر الرمز، ورصيد الرمز، ومبالغ الرمز كلما أمكن ذلك
- يجب على التطبيقات اللامركزية ومقدمي الخدمات استخدام المبلغ الخام والأسعار غير
  المقياسة لجميع الحسابات والتحويل للمستخدمين عند الحافة
- يجب توفير تغذيات الأسعار التاريخية لكل من المبالغ المقياسة وغير المقياسة
  لتسهيل التكامل
- يجب أن تكون قيم المضاعف التاريخية متاحة للوصول إليها للحصول على بيانات تاريخية
  دقيقة

## تعريفات المصطلحات

- المضاعف: مضاعف ثابت قابل للتحديث يُستخدم لحسابات مبلغ واجهة المستخدم
- مبلغ واجهة المستخدم: المضاعف × المبلغ الخام (المعروف أيضًا باسم: المبلغ
  المقياسي)
- المبلغ الخام: المبلغ (المعروف أيضًا باسم: المبلغ غير المقياسي)

## الرصيد الحالي

### المبلغ الحالي للعرض

- في أي وقت تعرض فيه مبالغ للرموز التي تستخدم امتداد مبلغ واجهة المستخدم
  المقياسي للمستخدمين النهائيين، يجب عليك استخدام إما:
  - مبلغ واجهة المستخدم/سلسلة مبلغ واجهة المستخدم (**_مفضل_**)
  - حساب يدوي للمبلغ الخام × المضاعف
  - نوصي باقتطاع هذه القيمة بناءً على عدد المنازل العشرية التي يمتلكها الرمز.
    - مثال: إذا كان لـ yUSD 6 منازل عشرية ولدى المستخدم مبلغ واجهة مستخدم قدره
      1.123456789، فيجب عليك عرض "1.123456"

### أين يمكن الحصول على هذه البيانات:

- للحصول على الرصيد الحالي للمستخدم، يمكنك الحصول على معلومات محدثة عن المبالغ
  المذكورة أعلاه عن طريق استدعاء إما getTokenAccountBalance أو getAccountInfo
- إذا كنت بحاجة إلى معرفة مبلغ واجهة المستخدم (UI Amount) لمبلغ معين، يمكنك
  الحصول على هذه الحسابات عن طريق استدعاء الدالة
  [`amountToUiAmountForMintWithoutSimulation`](https://github.com/solana-program/token-2022/blob/main/clients/js-legacy/src/actions/amountToUiAmount.ts#L164)
  (web3.js v1) أو محاكاة معاملة باستخدام amountToUiAmount.
  - ملاحظة: تتطلب amountToUiAmount محاكاة معاملة مما يعني أنها تحتاج أيضًا إلى
    دافع رسوم صالح برصيد كافٍ. لهذا السبب، لا ينبغي أن تكون هذه الطريقة
    الافتراضية للحصول على الرصيد.

### تحديث المبلغ الحالي

نظرًا لأن المُصدرين يمكنهم تحديث المضاعف في أي وقت، يمكنك التفكير في الاستعلام
الدوري للحفاظ على تحديث رصيد الحساب. من غير المرجح أن يقوم المُصدرون بتحديث هذا
المضاعف أكثر من مرة واحدة في اليوم. إذا تم تعيين مضاعف لتاريخ مستقبلي، يمكنك
الاستعلام تلقائيًا في وقت التحديث هذا

## مبالغ الرموز في المعاملات (التحويلات / المبادلات وما إلى ذلك)

- يجب على المستخدمين إدخال المبالغ ليتم تفسيرها على أنها "UIAmount" المقياس. يجب
  على التطبيق الذي يعالج هذا تحويله إلى مبلغ الرمز الخام للمعاملة.
  - إذا كانت هناك مشكلات في التقريب، قم بالتقريب لأسفل ويفضل ترك كمية صغيرة جدًا
    من الغبار بدلاً من المخاطرة بفشل المعاملة
  - للقيام بهذا التحويل يمكنك استخدام الدالة
    [`uiAmountToAmountForMintWithoutSimulation`](https://github.com/solana-program/token-2022/blob/main/clients/js-legacy/src/actions/amountToUiAmount.ts#L312C23-L312C63)
    (web3.js v1) أو محاكاة معاملة باستخدام amountToUiAmount.
- يجب أن تستخدم التطبيقات المبلغ الخام الإجمالي عندما يطلب المستخدم القيام
  بإجراء مع "الحد الأقصى" أو "كل" رصيدهم. هذا يضمن عدم ترك أي غبار.
  - اختياري: يمكنك التفكير في إغلاق الحساب تلقائيًا عند استخدام "الحد الأقصى"
    لاسترداد إيداع التخزين للمستخدم

## سعر الرمز

- يجب دائمًا عرض سعر الرمز كسعر مقياس حيثما أمكن ذلك.
- إذا كنت مزود خدمة تغذية الأسعار، مثل أوراكل، فيجب عليك عرض كل من السعر المقياس
  وغير المقياس.
  - حيثما أمكن، قدم SDK/API يجرد تعقيدات امتداد المبلغ المقياس في واجهة
    المستخدم.

## المضاعف الحالي

- يمكن قراءة المضاعف الحالي من سك الرمز في أي وقت عن طريق استدعاء
  `getAccountInfo`. بالإضافة إلى ذلك، إذا تم تعيين مضاعف مستقبلي، فإن هذه
  المعلومات متاحة أيضًا من سك الرمز. نوصي بعدم إظهار هذا المضاعف لأنه قد يسبب
  ارتباكًا في تجربة المستخدم.

## البيانات التاريخية

### البيانات التاريخية لتغذية الأسعار

- يجب على الخدمات التي توفر بيانات تاريخية تخزين وعرض **كل من الأسعار المقياسة
  وغير المقياسة لامتداد المبلغ المقياس في واجهة المستخدم**.
- نتوقع استخدام المبالغ المقياسة بشكل أكثر تكرارًا حيث يتماشى ذلك مع كيفية تعامل
  عالم التمويل التقليدي مع الرسوم البيانية المتعلقة بالرموز ذات تقسيمات الأسهم.

### البيانات التاريخية للمبالغ

- إذا كنت ترغب في إظهار الرصيد المحول في الماضي، فأنت بحاجة إلى الوصول إلى
  المضاعف في ذلك الـ slot المحدد. يمكنك أيضًا حفظ UiAmount للتحويلات أثناء
  معالجة المعاملات لتجنب إجراء هذا الحساب في المستقبل.

## التوافق مع الإصدارات السابقة

- افتراضيًا، المحافظ والتطبيقات التي لا تفهم امتداد المبلغ المقياس في واجهة
  المستخدم ستعرض السعر الإجمالي الصحيح للنشاط من خلال ضرب السعر غير المقياس ×
  المبلغ الخام.
- ومع ذلك، سيعرضون السعر غير المقياس مما يسبب بعض الارتباك للمستخدم.
- نأمل أن يشجع هذا الفرق على تحديث تطبيقاتهم اللامركزية لتكون متوافقة مع الرموز
  التي تستخدم امتداد المبلغ المقياس في واجهة المستخدم، ونحن سعداء بتقديم الدعم
  خلال هذه العملية.

## أولويات التكامل الموصى بها لكل منصة

### **المتطلبات العامة**

| المتطلب                                | الوصف                                                                                                                                                                                   | الأولوية |
| :------------------------------------- | :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | :------- |
| دعم إجراءات المستخدم باستخدام UiAmount | يجب إدخال جميع إجراءات المستخدم في UiAmount عندما يكون UiAmount مفعلاً في جميع أنحاء التطبيق. إذا لم يكن UiAmount مرئيًا في التطبيق، يجب استخدام المبالغ الأولية حتى يتم تحديث التطبيق. | **P0**   |

---

### **المحافظ**

| المتطلب                                | الوصف                                                                                        | الأولوية |
| :------------------------------------- | :------------------------------------------------------------------------------------------- | :------- |
| عرض الرصيد المقياسي                    | عرض المبلغ المقياسي (uiAmount) كرصيد أساسي.                                                  | **P0**   |
| دعم تحويلات الرموز                     | يجب على المستخدمين إدخال مبالغ التحويل بأرصدتهم المقياسية (المبلغ الأولي \* الرصيد).         | **P0**   |
| عرض السعر الفوري                       | عرض السعر الفوري المقياسي للمستخدمين                                                         | **P0**   |
| بيانات تعريف سجل المعاملات             | عرض المبلغ المقياسي (UIAmount) لكل تحويل حيثما أمكن ذلك.                                     | **P1**   |
| إظهار تحديثات المضاعف في سجل المعاملات | عند حدوث تحديثات المضاعف، عرض هذا كحدث في سجل معاملات المستخدم بما في ذلك المبلغ المكتسب     | **P2**   |
| عرض رسم بياني لتاريخ الأسعار           | عكس الأسعار المقياسية في الرسم البياني للسعر                                                 | **P1**   |
| التعريف/تلميحات الأدوات                | تقديم تلميحات أدوات أو تعريف لتثقيف المستخدمين حول الرموز التي تستخدم امتداد المبلغ المقياسي | **P2**   |

---

### **المستكشفات**

| المتطلب                                    | الوصف                                                                    | الأولوية |
| :----------------------------------------- | :----------------------------------------------------------------------- | :------- |
| تحسينات صفحة تفاصيل الرمز                  | عرض البيانات الوصفية مثل إجمالي القيمة السوقية المقياسية والمضاعف الحالي | **P0**   |
| عرض الرصيد المقياسي للأرصدة                | عرض الأرصدة المقياسية (UiAmount) للأرصدة الحالية.                        | **P0**   |
| عرض الرصيد المقياسي للمعاملات              | عرض الأرصدة المقياسية (UiAmount) لمبالغ التحويل للمعاملات التاريخية.     | **P0**   |
| عرض السعر المقياسي للمعاملات               | عرض الأسعار المقياسية للمعاملات السابقة                                  | **P1**   |
| تحليل وعرض معاملات تحديث المضاعف بشكل صحيح | عرض التفاصيل بشكل صحيح حول تحديث المضاعف                                 | **P2**   |

---

### **مجمعات بيانات السوق (مثال: CoinGecko)**

| المتطلب                                         | الوصف                                                                                                      | الأولوية |
| :---------------------------------------------- | :--------------------------------------------------------------------------------------------------------- | :------- |
| تحديثات واجهة برمجة التطبيقات للبيانات المقياسة | توسيع وظائف واجهة برمجة التطبيقات لتشمل تغييرات المضاعف مع مرور الوقت بالإضافة إلى تغذية الأسعار المقياسة. | **P0**   |
| إجمالي المعروض مع تعديل المقياس                 | عند عرض إجمالي المعروض وإجمالي القيمة السوقية، يجب أخذ الأرصدة المقياسة في الاعتبار                        | **P0**   |
| تتبع الأسعار التاريخية                          | توفير رسم بياني تاريخي للأسعار باستخدام السعر المقياس مع مرور الوقت.                                       | **P1**   |
| تتبع المضاعف التاريخي                           | توفير علامات تاريخية لتحديثات المضاعف للرموز ذات الفائدة.                                                  | **P2**   |
| المحتوى التعليمي أو الشروحات                    | تضمين أوصاف موجزة أو تلميحات تشرح كيفية عمل الرموز المقياسة.                                               | **P2**   |

---

### **مزودو تغذية الأسعار**

| المتطلب                               | الوصف                                                                                       | الأولوية |
| :------------------------------------ | :------------------------------------------------------------------------------------------ | :------- |
| تغذيات الأسعار المقياسة وغير المقياسة | توفير تغذيات الأسعار لكل من الأسعار المقياسة وغير المقياسة.                                 | **P0**   |
| بيانات المضاعف التاريخية              | تقديم واجهات برمجة تطبيقات مع تغييرات المضاعف التاريخية.                                    | **P0**   |
| بيانات الأسعار التاريخية              | تقديم واجهات برمجة تطبيقات مع أسعار تاريخية تستند إلى كل من المبالغ المقياسة وغير المقياسة. | **P0**   |

---

### **منصات التبادل اللامركزية**

| المتطلب                          | الوصف                                                                                                               | الأولوية |
| :------------------------------- | :------------------------------------------------------------------------------------------------------------------ | :------- |
| عرض أرصدة الرموز المعاد تقييمها  | عرض الأرصدة المقياسة للتداول أو توفير السيولة على واجهة المستخدم. (يمكن للخلفية الاستمرار في استخدام المبالغ الخام) | **P0**   |
| دعم إجراءات الرموز               | يجب على المستخدمين النهائيين إدخال مبالغ الإجراءات مع أرصدة واجهة المستخدم الخاصة بهم (المضاعف × المبلغ الخام).     | **P0**   |
| تكييف تغذية الأسعار              | في أي مكان يتم فيه استخدام تغذية الأسعار لعرض السعر الحالي، يجب توفير السعر المقياس للمستخدمين النهائيين.           | **P1**   |
| عرض الرسم البياني لتاريخ الأسعار | عكس الأسعار المقياسة في الرسم البياني للأسعار                                                                       | **P1**   |
