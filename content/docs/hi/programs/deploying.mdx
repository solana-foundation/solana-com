---
title: प्रोग्राम्स को डिप्लॉय करना
description:
  सोलाना CLI का उपयोग करके कस्टम प्रोग्राम्स को सोलाना ब्लॉकचेन पर अपलोड करना।
---

यह गाइड निम्नलिखित विषयों के ज्ञान की मान्यता रखती है:

- [सोलाना अकाउंट मॉडल](/core/accounts)
- [सामान्य रूप से सोलाना प्रोग्राम्स](/core/programs)
- [कस्टम सोलाना प्रोग्राम्स का विकास](/programs/rust/)

## लोडर-v3 और लोडर-v4

वर्तमान में लोडर-v3 (program सबकमांड) से लोडर-v4 (program **-v4** सबकमांड) में
संक्रमण चल रहा है क्योंकि लोडर-v3 को डेप्रिकेट किया जा रहा है।

नए डिप्लॉयमेंट के लिए कृपया `solana program-v4 deploy` का उपयोग करें,
`solana program deploy` के बजाय।

मौजूदा प्रोग्राम को माइग्रेट करने के लिए (जो अनिवार्य रूप से इसे फिर से डिप्लॉय
करना है):

```shell
solana program migrate ./target/deploy/your_program-keypair.json
```

## तैयारी

सबसे पहले, प्रोग्राम को बिल्ड करने की आवश्यकता है (कंपाइल, लिंक, स्ट्रिप)।

```shell
cargo +solana build --target sbpf-solana-solana --release
```

यह चरण हर री-/डिप्लॉयमेंट से पहले किया जाना चाहिए।

जांचें कि डिफ़ॉल्ट पेयर अकाउंट में एक्ज़ेक्यूटेबल के आकार के अनुपात में पर्याप्त
फंड उपलब्ध हैं:

```shell
du -h ./target/deploy/your_program.so
solana balance
```

इसके अतिरिक्त, प्रत्येक प्रोग्राम का एक प्रोग्राम अकाउंट और एक प्रोग्राम ID होता
है, जो उस प्रोग्राम अकाउंट का पता है। निम्नलिखित प्रोग्राम अकाउंट के लिए एक
keypair जनरेट करता है:

```shell
solana-keygen new -o ./target/deploy/your_program-keypair.json
```

यह प्रति प्रोग्राम केवल एक बार किया जाना चाहिए और बाद में उसी प्रोग्राम के पुनः
डिप्लॉयमेंट के लिए पुन: उपयोग किया जाएगा।

टूलचेन में एक शॉर्टकट था, हालांकि इसे चरणबद्ध तरीके से हटाया जा रहा है /
डेप्रिकेट किया जा रहा है:

```shell
cargo-build-sbf
```

## प्रारंभिक डिप्लॉयमेंट

अब एक्ज़ेक्यूटेबल को प्रोग्राम अकाउंट पर अपलोड किया जा सकता है:

### लोडर-v3

पैरामीटर को `program-id` कहा जाता है, भले ही यह keypair के फ़ाइल-पथ की अपेक्षा
करता है:

```shell
solana program deploy ./target/deploy/your_program.so --program-id ./target/deploy/your_program-keypair.json
```

### लोडर-v4

```shell
solana program-v4 deploy ./target/deploy/your_program.so --program-keypair ./target/deploy/your_program-keypair.json
```

## पुनः डिप्लॉयमेंट

एक ही प्रोग्राम खाते में फिर से एक अलग एक्जीक्यूटेबल अपलोड करने से इसे अधिलेखित
/ प्रतिस्थापित कर दिया जाएगा। हालांकि, पुनः डिप्लॉयमेंट के लिए, केवल प्रोग्राम
आईडी (pubkey प्रोग्राम keypair का) की आवश्यकता होती है, न कि पूरे keypair की,
क्योंकि हस्ताक्षरकर्ता अपग्रेड अथॉरिटी keypair है।

### लोडर-v3

यह प्रारंभिक डिप्लॉयमेंट के बिल्कुल समान है:

```shell
solana program deploy ./target/deploy/your_program.so --program-id ./target/deploy/your_program-keypair.json
```

यदि पुराना एक्जीक्यूटेबल नए की तुलना में छोटा था, तो पहले programdata खाते को
बढ़ाना आवश्यक हो सकता है:

```shell
solana program extend ./target/deploy/your_program.so <ADDITIONAL_BYTES>
```

### लोडर-v4

ध्यान दें कि प्रारंभिक डिप्लॉयमेंट में `program-keypair` का उपयोग किया गया था,
जबकि पुनः डिप्लॉयमेंट में `program-id` का उपयोग किया जाता है:

```shell
solana program-v4 deploy ./target/deploy/your_program.so --program-id ./target/deploy/your_program-keypair.json
```

## अपलोड को प्राथमिकता देना

भीड़ के समय में, प्रोग्राम डिप्लॉयमेंट में मदद के लिए कुछ अतिरिक्त फ्लैग हैं
जिनका आप उपयोग कर सकते हैं:

- `--with-compute-unit-price`: लेनदेन के लिए कंप्यूट यूनिट मूल्य सेट करें, प्रति
  कंप्यूट यूनिट 0.000001 lamports (माइक्रो-lamports) के वृद्धि में। प्राथमिकता
  शुल्क का अनुमान लगाने के लिए
  [Helius द्वारा प्राथमिकता शुल्क API](https://docs.helius.dev/guides/priority-fee-api)
  का उपयोग करें।
- `--use-rpc`: वैलिडेटर TPUs के बजाय कॉन्फ़िगर किए गए RPC पर राइट ट्रांजैक्शन
  भेजें। इस फ्लैग के लिए
  [स्टेक-वेटेड](/developers/guides/advanced/stake-weighted-qos) RPC कनेक्शन जैसे
  [Helius](https://www.helius.dev/) या [Triton](https://triton.one/) की आवश्यकता
  होती है। इस फ्लैग को डिफ़ॉल्ट के रूप में भी कॉन्फ़िगर किया जा सकता है इसका
  उपयोग करके: `solana config set --url <RPC_URL>`।
- `--max-sign-attempts`: ब्लॉकहैश समाप्ति के बाद लेनदेन पर हस्ताक्षर करने या
  पुनः हस्ताक्षर करने के प्रयासों की अधिकतम संख्या। यदि प्रोग्राम डिप्लॉय के
  दौरान भेजे गए कोई भी लेनदेन प्रारंभ में चुने गए हालिया ब्लॉकहैश की समाप्ति के
  बाद भी अपुष्ट रहते हैं, तो उन लेनदेनों पर एक नए हालिया ब्लॉकहैश के साथ पुनः
  हस्ताक्षर किए जाएंगे और फिर से भेजे जाएंगे। लेनदेन हस्ताक्षर इटरेशन की अधिकतम
  संख्या को समायोजित करने के लिए इस सेटिंग का उपयोग करें। प्रत्येक ब्लॉकहैश लगभग
  60 सेकंड के लिए मान्य होता है, जिसका अर्थ है कि डिफ़ॉल्ट मान 5 का उपयोग करने
  से कम से कम 5 मिनट तक या जब तक सभी लेनदेन पुष्ट नहीं हो जाते, जो भी पहले हो,
  लेनदेन भेजे जाएंगे।

## अपलोड फिर से शुरू करना

यह संभव है कि अपलोड अटक जाए या बीच में रुक जाए।

### लोडर-v3

अगर प्रोग्राम डिप्लॉयमेंट विफल होता है, तो एक अटका हुआ इंटरमीडिएट बफर अकाउंट
रहेगा जिसमें गैर-शून्य बैलेंस होगा। इस बैलेंस को पुनः प्राप्त करने के लिए आप उसी
इंटरमीडिएट बफर को `deploy` के नए कॉल में प्रदान करके विफल डिप्लॉयमेंट को फिर से
शुरू कर सकते हैं।

डिप्लॉयमेंट विफलताओं पर एक त्रुटि संदेश प्रिंट होगा जिसमें जनरेट किए गए
इंटरमीडिएट बफर के keypair को रिकवर करने के लिए आवश्यक seed फ्रेज निर्दिष्ट होगा:

```
==================================================================================
Recover the intermediate account's ephemeral keypair file with
`solana-keygen recover` and the following 12-word seed phrase:
==================================================================================
valley flat great hockey share token excess clever benefit traffic avocado athlete
==================================================================================
To resume a deploy, pass the recovered keypair as
the [BUFFER_SIGNER] to `solana program deploy` or `solana program write-buffer'.
Or to recover the account's lamports, pass it as the
[BUFFER_ACCOUNT_ADDRESS] argument to `solana program drain`.
==================================================================================
```

keypair को रिकवर करने के लिए:

```shell
solana-keygen recover -o ./target/deploy/buffer-keypair.json
```

जब पूछा जाए, तो 12-शब्द वाला seed फ्रेज दर्ज करें।

फिर एक नया `deploy` कमांड जारी करें और बफर निर्दिष्ट करें:

```shell
solana program deploy ./target/deploy/your_program.so --program-id ./target/deploy/your_program-keypair.json --buffer ./target/deploy/buffer-keypair.json
```

### लोडर-v4

एक निर्दिष्ट बाइट ऑफसेट से अपलोड को फिर से शुरू करना संभव है:

```shell
solana program deploy ./target/deploy/your_program.so --program-id ./target/deploy/your_program-keypair.json --start-offset <BYTES_UPLOADED_SO_FAR>
```

## फाइनलाइजेशन

यह एक **अपरिवर्तनीय** क्रिया है।

एक प्रोग्राम को अपरिवर्तनीय बनाया जा सकता है उसके अपग्रेड अथॉरिटी को हटाकर।

### लोडर-v3

```shell
solana program set-upgrade-authority ./target/deploy/your_program-keypair.json --final
```

### लोडर-v4

```shell
solana program finalize --program-id ./target/deploy/your_program-keypair.json
```

प्रोग्राम को ओवरराइट करने के बजाय, उपयोगकर्ताओं को यह विकल्प भी दिया जा सकता है
कि वे प्रोग्राम के किस वर्जन का उपयोग करना चाहते हैं, फाइनलाइज्ड प्रोग्राम्स की
एक लिंक्ड लिस्ट बनाकर:

```shell
solana program finalize --program-id ./target/deploy/your_program-keypair.json --next-version ../your_newer_program/target/deploy/your_newer_program-keypair.json
```

## क्लोजिंग

लोडर-v3 के तहत डिप्लॉय किए गए प्रोग्राम के लिए केवल उनके programdata अकाउंट, बफर
अकाउंट्स और उनमें लॉक किए गए फंड्स को पुनः प्राप्त किया जा सकता है। प्रोग्राम
अकाउंट के साथ-साथ प्रोग्राम आईडी और विशेष रूप से प्रोग्राम अकाउंट में लॉक किए गए
फंड्स फंसे रहते हैं।

लोडर-v4 के अंतर्गत डिप्लॉय किए गए प्रोग्राम्स को उनके प्रोग्राम अकाउंट के साथ
बंद किया जा सकता है, जिससे उनका प्रोग्राम ID और उनके लॉक किए गए फंड्स अन्य
उपयोगों के लिए फिर से उपलब्ध हो जाते हैं।

### लोडर-v3

लोडर-v3 का उपयोग करके डिप्लॉय किए गए प्रोग्राम्स के लिए यह एक **अपरिवर्तनीय**
कार्रवाई है।

ध्यान दें कि एक बार प्रोग्राम बंद होने के बाद, उसके प्रोग्राम ID का पुन: उपयोग
नहीं किया जा सकता। पहले से बंद किए गए प्रोग्राम ID के साथ प्रोग्राम डिप्लॉय करने
का प्रयास करने पर एरर आएगा। यदि आपको प्रोग्राम बंद करने के बाद उसे फिर से
डिप्लॉय करने की आवश्यकता है, तो आपको एक नई प्रोग्राम keypair फाइल जनरेट करनी
होगी।

एक सिंगल programdata अकाउंट को बंद करने के लिए:

```shell
solana program close ./target/deploy/your_program-keypair.json
```

वर्तमान अथॉरिटी से जुड़े सभी बफर अकाउंट्स को बंद करने के लिए:

```shell
solana program close --buffers
```

### लोडर-v4

```shell
solana program-v4 close --program-id ./target/deploy/your_program-keypair.json
```

## मेटाडेटा का निरीक्षण

`show` सबकमांड प्रोग्राम के मेटाडेटा को सूचीबद्ध करता है।

एक उदाहरण आउटपुट इस प्रकार दिखता है:

```shell
Program Id: 3KS2k14CmtnuVv2fvYcvdrNgC94Y11WETBpMUGgXyWZL
Owner: BPFLoaderUpgradeab1e11111111111111111111111
ProgramData Address: EHsACWBhgmw8iq5dmUZzTA1esRqcTognhKNHUkPi4q4g
Authority: FwoGJNUaJN2zfVEex9BB11Dqb3NJKy3e9oY3KTh9XzCU
Last Deployed In Slot: 63890568
Data Length: 5216 (0x1460) bytes
```

- `Program Id` वह एड्रेस है जिसे प्रोग्राम को इनवोक करते समय इंस्ट्रक्शन के
  `program_id` फील्ड में संदर्भित किया जा सकता है।
- `Owner`: वह लोडर जिसके साथ यह प्रोग्राम डिप्लॉय किया गया था।
- `ProgramData Address` प्रोग्राम अकाउंट से जुड़ा programdata अकाउंट है जो
  प्रोग्राम के एक्जीक्यूटेबल को होल्ड करता है (केवल लोडर-v3)।
- `Status`: `retracted`, `deployed` या `finalized` (केवल लोडर-v4)।
- `Authority` प्रोग्राम का अपग्रेड अथॉरिटी है।
- `Last Deployed In Slot` वह slot है जिसमें प्रोग्राम अंतिम बार डिप्लॉय किया गया
  था।
- `Data Length` डिप्लॉयमेंट के लिए आरक्षित स्पेस का साइज है। वर्तमान में डिप्लॉय
  किए गए प्रोग्राम द्वारा वास्तव में उपयोग किया गया स्पेस कम हो सकता है।

### लोडर-v3

किसी विशिष्ट प्रोग्राम को देखने के लिए:

```shell
solana program show ./target/deploy/your_program-keypair.json
```

डिफॉल्ट अथॉरिटी के साथ डिप्लॉय किए गए प्रोग्राम्स की सूची देखने के लिए:

```shell
solana program show --programs
```

अथॉरिटी की परवाह किए बिना सभी बफर अकाउंट्स दिखाने के लिए:

```shell
solana program show --buffers --all
```

एक अलग अथॉरिटी निर्दिष्ट करने के लिए:

```shell
solana program show --programs --buffer-authority ~/.config/solana/authority-keypair.json
solana program show --buffers --buffer-authority ~/.config/solana/authority-keypair.json
```

### लोडर-v4

किसी विशिष्ट प्रोग्राम को देखने के लिए:

```shell
solana program-v4 show --program-id ./target/deploy/your_program-keypair.json
```

डिफ़ॉल्ट अथॉरिटी के साथ डिप्लॉय किए गए प्रोग्रामों की सूची देखने के लिए:

```shell
solana program-v4 show --all
```

किसी विशिष्ट अथॉरिटी के साथ डिप्लॉय किए गए प्रोग्रामों की सूची देखने के लिए:

```shell
solana program-v4 show --authority ~/.config/solana/authority-keypair.json
```

## एक्जीक्यूटेबल डाउनलोड करना

कभी-कभी किसी प्रोग्राम को डाउनलोड करके तुलना करना उपयोगी होता है ताकि यह
सुनिश्चित किया जा सके कि उसमें ज्ञात एक्जीक्यूटेबल है। डाउनलोड की गई फ़ाइल को
काटा जा सकता है, हैश किया जा सकता है, और मूल प्रोग्राम फ़ाइल के हैश से तुलना की
जा सकती है।

### लोडर-v3

```shell
solana program dump ./target/deploy/your_program-keypair.json ./target/deploy/your_program.so
```

### लोडर-v4

```shell
solana program download ./target/deploy/your_program.so --program-id ./target/deploy/your_program-keypair.json
```

## उन्नत: अथॉरिटी ट्रांसफर

किसी दिए गए प्रोग्राम को बदलने का अधिकार उसकी अथॉरिटी के पास होता है। इस अथॉरिटी
को प्रोग्राम keypair को बदले बिना किसी अन्य keypair में स्थानांतरित किया जा सकता
है, ताकि प्रोग्राम ID वही रहे। इसके अलावा, एक ही अथॉरिटी कई प्रोग्राम अकाउंट्स
को नियंत्रित कर सकती है।

अगर प्रारंभिक डिप्लॉयमेंट के दौरान स्पष्ट रूप से निर्दिष्ट नहीं किया गया है, तो
डिफ़ॉल्ट keypair को अथॉरिटी के रूप में उपयोग किया जाता है। यही कारण है कि ऊपर
दिए गए चरणों में प्रोग्राम को फिर से डिप्लॉय करने के लिए अथॉरिटी को स्पष्ट रूप
से निर्दिष्ट करने की आवश्यकता नहीं थी।

स्पष्ट अथॉरिटी ऑफलाइन हस्ताक्षर और बहु-इकाई शासित प्रोग्रामों के लिए उपयोगी है।

सबसे पहले, अथॉरिटी के लिए एक keypair जनरेट करना होगा:

```shell
solana-keygen new -o ~/.config/solana/authority-keypair.json
```

### लोडर-v3

डिप्लॉयमेंट के दौरान अथॉरिटी को निर्दिष्ट किया जा सकता है:

```shell
solana program deploy ./target/deploy/your_program.so --upgrade-authority ~/.config/solana/authority-keypair.json
```

या डिप्लॉयमेंट के बाद और वर्तमान अथॉरिटी के रूप में डिफ़ॉल्ट keypair का उपयोग
करके:

```shell
solana program set-upgrade-authority ./target/deploy/your_program-keypair.json --new-upgrade-authority ~/.config/solana/authority-keypair.json
```

या डिप्लॉयमेंट के बाद और वर्तमान अथॉरिटी को निर्दिष्ट करके:

```shell
solana program set-upgrade-authority ./target/deploy/your_program-keypair.json --upgrade-authority ~/.config/solana/authority-keypair.json --new-upgrade-authority ~/.config/solana/new_authority-keypair.json
```

### लोडर-v4

डिप्लॉयमेंट के दौरान अथॉरिटी को निर्दिष्ट किया जा सकता है:

```shell
solana program-v4 deploy ./target/deploy/your_program.so --program-keypair ./target/deploy/your_program-keypair.json --authority ~/.config/solana/authority-keypair.json
```

या डिप्लॉयमेंट के बाद और डिफ़ॉल्ट keypair को वर्तमान अथॉरिटी के रूप में उपयोग
करके:

```shell
solana program-v4 transfer-authority --program-id ./target/deploy/your_program-keypair.json --new-authority ~/.config/solana/authority-keypair.json
```

या डिप्लॉयमेंट के बाद और वर्तमान अथॉरिटी को निर्दिष्ट करके:

```shell
solana program-v4 transfer-authority --program-id ./target/deploy/your_program-keypair.json --authority ~/.config/solana/authority-keypair.json --new-authority ~/.config/solana/new_authority-keypair.json
```

## एडवांस्ड: बफर का उपयोग करके दो-चरण पुनर्डिप्लॉयमेंट

एग्जीक्यूटेबल को सीधे प्रोग्राम अकाउंट में अपलोड करने के बजाय, पहले इसे एक
स्टेजिंग बफर अकाउंट में अपलोड किया जा सकता है और फिर दूसरे चरण में (वास्तविक
री-/डिप्लॉयमेंट) प्रोग्राम अकाउंट में ट्रांसफर किया जा सकता है। यह ऑफलाइन
साइनिंग और मल्टी-एंटिटी गवर्न्ड प्रोग्राम्स जैसे कि DAO वोटिंग के लिए उपयोगी है
जो वास्तविक रीडिप्लॉयमेंट से पहले अपलोड किए गए एग्जीक्यूटेबल को चुनने या
अस्वीकार करने के लिए वोट करते हैं।

ध्यान रखें कि बफर अकाउंट का उपयोग करने से अपलोड प्रक्रिया के दौरान आवश्यक फंड
लगभग दोगुना हो जाता है क्योंकि दो अकाउंट एक साथ एक-एक एग्जीक्यूटेबल रखते हैं।

सबसे पहले, बफर अकाउंट के लिए एक keypair बनाया जाना चाहिए:

```shell
solana-keygen new -o ~/.config/solana/buffer-keypair.json
```

बफर अकाउंट का पुन: उपयोग विभिन्न अपलोड के लिए किया जा सकता है और यह किसी विशिष्ट
प्रोग्राम अकाउंट से बंधा नहीं है।

### लोडर-v3

```shell
solana program write-buffer ./target/deploy/your_program.so --buffer ~/.config/solana/buffer-keypair.json
solana program deploy --program-id ./target/deploy/your_program-keypair.json --buffer ~/.config/solana/buffer-keypair.json
```

### लोडर-v4

```shell
solana program-v4 deploy ./target/deploy/your_program.so --buffer ~/.config/solana/buffer-keypair.json
solana program-v4 deploy --program-id ./target/deploy/your_program-keypair.json --buffer ~/.config/solana/buffer-keypair.json
```

## एडवांस्ड: ऑफलाइन साइनिंग

कुछ सुरक्षा मॉडल साइनिंग प्रक्रिया को ट्रांजैक्शन ब्रॉडकास्ट से अलग करने की
आवश्यकता रखते हैं, ताकि साइनिंग कीज़ को किसी भी नेटवर्क से पूरी तरह से
डिस्कनेक्ट किया जा सके, जिसे ऑफलाइन साइनिंग भी कहा जाता है।

ध्यान दें कि केवल रीडिप्लॉयमेंट ऑफलाइन मोड में किए जा सकते हैं। प्रारंभिक
प्रोग्राम डिप्लॉयमेंट **अवश्य** एक ऑनलाइन मशीन से किया जाना चाहिए, और केवल बाद
के प्रोग्राम रीडिप्लॉयमेंट ऑफलाइन साइनिंग का लाभ उठा सकते हैं।

एक विशिष्ट सेटअप में दो अलग-अलग साइनर्स होंगे:

- ऑनलाइन साइनर (फीस पेयर और बफर अकाउंट का अथॉरिटी)
- ऑफलाइन साइनर (प्रोग्राम अकाउंट का अथॉरिटी)

सामान्य प्रक्रिया कुछ अतिरिक्त चरणों के साथ दो-चरणीय पुनः तैनाती है:

1. (ऑनलाइन) एक नया प्रोग्राम बनाएँ
2. (ऑनलाइन) अधिकार को ऑफलाइन हस्ताक्षरकर्ता को स्थानांतरित करें
3. (ऑनलाइन) बफर बनाएँ और उसमें एक निष्पादन योग्य फ़ाइल अपलोड करें
4. (वैकल्पिक) बफर की ऑन-चेन सामग्री को सत्यापित करें
5. (ऑफलाइन) बफर का उपयोग करके प्रोग्राम को पुनः तैनात करने के लिए एक लेनदेन पर
   हस्ताक्षर करें `--blockhash <VALUE> --sign-only`
6. (ऑनलाइन) पुनः तैनाती लेनदेन को प्रसारित करने के लिए इस हस्ताक्षर का उपयोग
   करें
   `--blockhash <VALUE> --signer <OFFLINE_SIGNER_PUBKEY>:<OFFLINE_SIGNER_SIGNATURE>`

हाल के `blockhash` को देखें और ऑफलाइन लेनदेन हस्ताक्षर उत्पन्न करने के लिए इसे
पेस्ट करें। `blockhash` लगभग ~60 सेकंड के बाद समाप्त हो जाता है। यदि आप समय पर
नहीं कर पाए - बस एक और ताज़ा हैश प्राप्त करें और सफल होने तक दोहराएँ, या टिकाऊ
लेनदेन nonces का उपयोग करने पर विचार करें।
